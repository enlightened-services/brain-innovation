"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8123],{787:(e,t,s)=>{s.d(t,{l:()=>a});var a=function(e){return e.Standard="Standard",e.TimelineGroup="TimelineGroup",e}({})},1958:(e,t,s)=>{(0,s(4211).v)((e,t)=>({toolUseRequests:{},trailingToolUseMessages:{},resolvedTrailingToolUseRequestIds:{},setTrailingToolUseRequests:(t,s)=>{e(e=>({...e,trailingToolUseMessages:{[t]:s}}))},resolveTrailingToolUseRequest:(t,s)=>{e(e=>({...e,resolvedTrailingToolUseRequestIds:{[t]:{...e.resolvedTrailingToolUseRequestIds[t]||{},[s]:!0}}}))},requestToolApproval:(s,a,n,i,l)=>!t().toolUseRequests[n]&&(e(e=>({...e,toolUseRequests:{[s]:{...e.toolUseRequests[s]||{},[a]:{id:a,toolId:n,input:i,promiseWithResolvers:l}}}})),!0),decideToolUse:(s,a,n)=>{let i=t(),l=i.toolUseRequests[s][a];if(!l)return!1;l.promiseWithResolvers.resolve(n);let r={...i.toolUseRequests[s]};return delete r[a],e(e=>({...e,toolUseRequests:{[s]:r}})),!0}}))},4887:(e,t,s)=>{async function a(e){let t=n(e),s=await fetch(t);if(!s.ok)throw Error("Failed to fetch file: ".concat(s.status," ").concat(s.statusText));return s}function n(e){let{organizationUuid:t,filePath:s}=e;return e.isShared?"/api/organizations/".concat(t,"/snapshots/").concat(e.snapshotUuid,"/wiggle/download-file?path=").concat(encodeURIComponent(s)):"/api/organizations/".concat(t,"/conversations/").concat(e.conversationUuid,"/wiggle/download-file?path=").concat(encodeURIComponent(s))}s.d(t,{T:()=>n,e:()=>a})},7881:(e,t,s)=>{s.d(t,{$:()=>r,Q:()=>l});var a=s(54568),n=s(7620);let i=n.createContext({renderToolUseCell:void 0}),l=()=>n.useContext(i),r=e=>{let{renderToolUseCell:t,children:s}=e,l=(0,n.useMemo)(()=>({renderToolUseCell:t}),[t]);return(0,a.jsx)(i.Provider,{value:l,children:s})}},8564:(e,t,s)=>{s.d(t,{CV:()=>en,ke:()=>eo});var a=s(2348),n=s(54568),i=s(94295),l=s(6542),r=s(56054),o=s(37380),d=s(74813),c=s(64328),u=s(35984),m=s(13750),p=s(59922),f=s(21266),h=s(89626),g=s(23812),x=s(87483),C=s(1720),v=s(3075),j=s(67453),b=s(64371),y=s(57291),w=s(37541),_=s(73356),k=s(28044),N=s(92291),M=s(72902),S=s(39109),A=s(61295),E=s(43906),z=s.n(E),T=s(19664),L=s.n(T),R=s(7620),I=s(59666),U=s(10369),O=s(85028),F=s(34385),D=s(45538),P=s(58841),B=s(87017),G=s(84617),W=s(70352),V=s(81535),q=s(34037);function H(){let e=(0,a._)(["\n  border\n  border-border-400\n  bg-bg-100\n  w-96\n  rounded-xl\n  font-medium\n  text-text-300\n  text-sm\n"]);return H=function(){return e},e}function Y(e){let t,{onClose:s,onSubmitRating:a,onSubmitNotes:i}=e,l=(0,U.A)(),[r,o]=(0,R.useState)(!1),[d,c]=(0,R.useState)(""),u=e=>{a(e),o(!0)},p=()=>{s()};return t=r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,n.jsx)("div",{className:"ml-1",children:(0,n.jsx)(I.A,{defaultMessage:"What were you trying to accomplish when this artifact was created?",id:"CrrumB/FnI"})}),(0,n.jsx)("div",{className:"pt-1",children:(0,n.jsx)("button",{onClick:p,children:(0,n.jsx)(W.X,{size:20})})})]}),(0,n.jsx)("form",{onSubmit:e=>{e.preventDefault(),i(d),p()},children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("div",{className:"grow",children:(0,n.jsx)(m.ks,{className:"w-full",placeholder:l.formatMessage({defaultMessage:"e.g. make a graph",id:"g1RrFC72N+"}),value:d,onChange:e=>c(e.target.value)})}),(0,n.jsx)("div",{children:(0,n.jsx)(g.$,{variant:"primary",type:"submit",children:(0,n.jsx)(I.A,{defaultMessage:"Send",id:"9WRlF4R2gm"})})})]})})]}):(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)(I.A,{defaultMessage:"Is this artifact useful?",id:"RxVIwIW9vn"})}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(g.$,{variant:"ghost",size:"icon_sm",onClick:()=>u(!0),"aria-label":l.formatMessage({defaultMessage:"Thumbs up",id:"0HnZ1ci6be"}),children:(0,n.jsx)(V.t,{size:20})}),(0,n.jsx)(g.$,{variant:"ghost",size:"icon_sm",onClick:()=>u(!1),"aria-label":l.formatMessage({defaultMessage:"Thumbs down",id:"go4L4rFJNq"}),children:(0,n.jsx)(q.S,{size:20})}),(0,n.jsx)(g.$,{variant:"ghost",size:"icon_sm",onClick:p,"aria-label":l.formatMessage({defaultMessage:"Close",id:"rbrahOGMC3"}),children:(0,n.jsx)(W.X,{size:20})})]})]}),(0,n.jsxs)(J,{children:[(0,n.jsx)("div",{className:"p-3",children:t}),(0,n.jsx)("div",{className:"p-3 border-t border-border-400 w-full font-normal text-xs text-text-500",children:(0,n.jsx)(G.Y,{href:"https://support.anthropic.com/en/articles/9957937-how-does-anthropic-use-submitted-feedback",target:"_blank",children:(0,n.jsx)(I.A,{defaultMessage:"Learn more about how Anthropic uses feedback",id:"NBSES31K7c"})})})]})}let J=p.J.div(H());var K=s(91558),X=s(94882),Z=s(24423);let Q=e=>{let{currentArtifact:t,hasMenuOpen:s,setHasMenuOpen:a}=e,i=(0,R.useCallback)(()=>{a(!1)},[a]),l=(0,Z.dd)(),{dispatchChatResource:r}=(0,P.i)(),o=Object.values(l).reverse().sort((e,t)=>{let s=e.versions[e.versions.length-1];return new Date(t.versions[t.versions.length-1].created_at).getTime()-new Date(s.created_at).getTime()}),d=(0,R.useRef)(t),c=(0,R.useRef)(!1),u=(0,R.useCallback)(e=>{queueMicrotask(()=>{r({type:"SELECT_ARTIFACT",id:e.id,versionUuid:e.versions[e.versions.length-1].uuid})})},[r]);(0,R.useEffect)(()=>{let e=d.current;return()=>{e&&!c.current&&(null==t?void 0:t.id)!==e.id&&u(e),c.current=!1}},[]);let m=(0,K.w)(),p=(0,U.A)();return o.length<2?null:(0,n.jsxs)(X.bL,{open:s,onOpenChange:e=>a(e),children:[(0,n.jsx)(X.l9,{asChild:!0,children:(0,n.jsx)(g.$,{variant:"ghost",size:"icon_sm",className:"-mx-1",children:(0,n.jsx)(j.Tooltip,{side:"right",className:"ml-2",tooltipContent:s?"":p.formatMessage({defaultMessage:"Switch between artifacts",id:"mYiLqlDMdl"}),delayDuration:800,children:(0,n.jsx)(h.zDc,{size:20})})})}),(0,n.jsx)(X.UC,{align:"start",asChild:!0,children:(0,n.jsx)("ul",{className:"\n            relative\n            z-dropdown\n            overflow-y-auto\n            max-h-[min(var(--radix-dropdown-menu-content-available-height),var(--dropdown-max-height))]\n            flex flex-col gap-1\n            py-2 pr-3\n          ",onMouseLeave:()=>d.current&&u(d.current),children:o.map((e,t)=>{var s;let a=e.type?m[e.type]:null,l=(null==(s=d.current)?void 0:s.id)===e.id,r=p.formatMessage({defaultMessage:"versions",id:"bhuRmwJBaN"}),f=e.versions.length>1?"".concat(e.versions.length):"",h=e.versions.length>1&&a?" \xb7 ":"";return(0,n.jsx)(A.P.li,{initial:{y:-12,opacity:0},animate:{y:0,opacity:1},exit:{opacity:0,transition:{ease:"easeOut",duration:.1,delay:0}},transition:{delay:.035*t,type:"spring",stiffness:285,damping:25,mass:1},role:"none",children:(0,n.jsxs)(X.q7,{className:(0,M.A)("bg-bg-000 border-0.5 cursor-pointer can-focus","flex flex-col py-2 pl-3 pr-4 w-full max-w-72 mb-px rounded-lg overflow-hidden","text-sm text-left transition duration-300 drop-shadow-[0_2px_8px_hsl(var(--always-black)/5%)]",l?"border-accent-secondary-100 shadow-[0_0_0_1px_hsl(var(--accent-secondary-100))]":"text-text-300 hover:text-text-100 border-border-200 hover:border-accent-secondary-100 focus-within:border-accent-secondary-100 focus-within:text-text-100"),onClick:()=>(e=>{c.current=!0,i();let t=o[e];d.current=t,u(t)})(t),onMouseEnter:()=>{u(e)},"aria-label":"".concat(e.title).concat(a?", ".concat(a):"").concat(f?", ".concat(f," ").concat(r):""),children:[(0,n.jsx)("div",{className:"line-clamp-2",children:e.title}),(0,n.jsxs)("span",{className:"text-text-300",children:[e.versions.length>1?(0,n.jsxs)(n.Fragment,{children:[f," ",r]}):null,h?(0,n.jsx)(n.Fragment,{children:h}):null,a]})]},e.id)},e.id)})})})]})};var $=s(19757),ee=s(68616),et=s(78671);function es(){let e=(0,a._)(["\n  flex\n  flex-none\n  items-center\n  justify-between\n  text-sm\n  text-text-500\n  py-2\n  px-2\n  border-t\n  border-border-400\n"]);return es=function(){return e},e}function ea(){let e=(0,a._)(["\n  border-border-400\n  sticky\n  flex\n  items-center\n  gap-1\n  border-b\n  px-2\n  py-2\n"]);return ea=function(){return e},e}let en=e=>{var t,s,a,u,m,p,f,h,g,x;let{onClose:C,artifact:v,isStreaming:j,selectedArtifactMessageUuid:b,selectedArtifactVersionUuid:w,setSelectedArtifactVersionUuid:k,projectUuid:E,selectDoc:z,disablePublishing:T,sendMessage:L,richSandboxCapabilities:I,isOpen:U,isTemporary:F=!1}=e,{account:B}=(0,c.YL)(),G=(0,d.st)(),[W,V]=(0,R.useState)("normal"),q=(0,R.useRef)(null),[H,J]=(0,R.useState)(!1),K=(0,c.mV)(),[X,Z]=(0,R.useState)(!0),{data:Q}=(0,D.fo)(E),{data:et}=(0,O.mt)({entityId:w,artifactEntityType:"artifact_version"}),es=(0,R.useMemo)(()=>(null==et?void 0:et.mcp_servers)||[],[et]),ea=!T&&!K,[en,{open:el,close:eo}]=(0,N.j)(!1),ec=(0,R.useCallback)(()=>{Z(!1)},[]),{data:eu}=(0,l.rC)({includeDeletedArtifacts:!0}),em=null==v?void 0:v.versions[v.versions.length-1],ep=j&&!(null==em?void 0:em.isClosed),ef=(0,R.useMemo)(()=>{if(!v)return 0;if(!ep&&w&&!(null==b?void 0:b.startsWith(o.B6))){let e=v.versions.findIndex(e=>e.uuid===w);if(-1!==e)return e}return ep||!b||b.startsWith(o.B6)?v.versions.length-1:v.versions.findIndex(e=>e.message===b)},[b,w,ep,v]),eh=null==v||null==(t=v.versions[ef])?void 0:t.uuid;(0,R.useEffect)(()=>{eh&&eh!==w&&k(eh),V("normal")},[null==v?void 0:v.id,eh,k,w]);let eg=K&&!F,[ex,{open:eC,close:ev}]=(0,N.j)(!1),ej=v&&(null==eu||null==(s=eu.find(e=>{let{artifact_identifier:t,message_uuid:s}=e;return t===v.id&&s===v.versions[ef].message}))?void 0:s.published_artifact_uuid),eb=null!=(f=null==eu?void 0:eu.some(e=>{let{published_artifact_uuid:t,deleted:s}=e;return t===ej&&s}))&&f,ey=null==v||null==(a=v.versions[ef])?void 0:a.message,[ew,e_]=(0,R.useState)(!1);(0,R.useEffect)(()=>e_(ew||j),[ew,j]);let[ek,eN]=(0,R.useState)(!1);(0,R.useEffect)(()=>eN(!1),[b,ey]);let[eM,eS]=(0,R.useState)(!1),{data:eA}=(0,l.SN)(),{mutate:eE}=(0,i.yJ)(),{track:ez}=(0,d.st)(),eT=null!=(h=(0,P.i)().chatResourceState.conversationUuid)?h:"",{data:eL}=(0,O.Ns)({entityId:w,artifactEntityType:"artifact_version",conversationUuid:eT},{enabled:!j}),[eR,{open:eI,close:eU}]=(0,N.j)(!1),{mutateAsync:eO}=(0,l.cH)(eT),eF=(0,R.useCallback)(async()=>{if(!w)try{var e;let{artifactVersionUUID:t}=await eO({version_index:ef,artifact_identifier:null!=(e=null==v?void 0:v.id)?e:""});k(t)}catch(e){_.v.error(_.u.ARTIFACTS,"Error getting artifact UUID",e);return}ez({event_key:"artifact.share_button_clicked",message_uuid:ey,artifact_type:null==v?void 0:v.type,artifact_language:null==v?void 0:v.language}),eC()},[w,eC,eO,ef,null==v?void 0:v.id,k,ez,ey,null==v?void 0:v.type,null==v?void 0:v.language]),eD=(0,R.useCallback)(()=>{ez({event_key:"artifact.publish_button_clicked",message_uuid:ey,artifact_type:null==v?void 0:v.type,artifact_language:null==v?void 0:v.language}),el()},[el,ez,ey,null==v?void 0:v.type,null==v?void 0:v.language]),eP=(null==v?void 0:v.type)===y.vU.Text,eB=(null==v?void 0:v.type)===y.vU.Markdown||(null==v?void 0:v.type)===y.vU.Code,eG=(null==v?void 0:v.type)===y.vU.Html||(null==v?void 0:v.type)===y.vU.React,eW=(null==v?void 0:v.type)!==y.vU.Text&&!(ep&&((null==v?void 0:v.type)===y.vU.Svg||(null==v?void 0:v.type)===y.vU.Mermaid||(null==v?void 0:v.type)===y.vU.React||(null==v?void 0:v.type)===y.vU.Html)),eV=!eW||"raw"===W,eq=ek||ew&&!j&&!eM&&!(null==B?void 0:B.settings.dismissed_artifact_feedback_form)&&eA,eH=null!=(g=null==v?void 0:v.versions.length)?g:0,[eY,eJ]=(0,R.useState)(!1),eK=E&&v?{show:!ep&&!(null==Q?void 0:Q.is_starter_project),artifact:v,projectUuid:E,selectedVersion:ef,selectDoc:z}:void 0;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:(0,M.A)(v?"bg-bg-000 flex h-full flex-col relative":"absolute opacity-0 w-0 h-0 overflow-hidden pointer-events-none"),onClick:()=>eY&&eJ(!1),children:[(0,n.jsx)(ei,{versionCount:eH,selectedVersion:ef,artifact:v,canRenderNormal:eW,canOnlyRenderRaw:eP,canOnlyRenderNormal:eB,viewing:W,setViewing:V,showRaw:eV,canRefresh:eG,isSandboxLoading:X,handleRefresh:()=>{Z(!0),q.current&&q.current.refresh()},canShare:eg,handleOpenShareModal:eF,isStreaming:j,onClose:C,hasMenuOpen:eY,setHasMenuOpen:eJ,canPublish:ea,wasUnpublished:eb,publishedArtifactUuid:ej,openPublishModal:eD,projectParams:eK,richSandboxRef:q,hasArtifactToolConfig:!!(null==et||null==(u=et.mcp_servers)?void 0:u.length),setShowArtifactMcpModal:J,storageInfo:eL,openResetStorageModal:eI,handleVersionSelect:e=>{let t=null==v?void 0:v.versions[e].uuid;t&&k(t)}}),(0,n.jsx)(r.k,{isOpen:U,content:null!=(x=null==v||null==(m=v.versions[ef])?void 0:m.resultState)?x:"",type:null==v?void 0:v.type,citations:null==v||null==(p=v.versions[ef])?void 0:p.citations,language:void 0===v?void 0:v.language||y.K5[v.type].syntaxName,showRaw:eV,richSandboxRef:q,isCurrentStreaming:ep,isChatStreaming:j,onSandboxConfirmation:ec,sendMessage:L,richSandboxCapabilities:I,isLatestVersion:!!v&&ef===v.versions.length-1,artifactId:null==v?void 0:v.id,artifactContext:w?{uuid:w,type:"artifact_version",id:null==v?void 0:v.id}:void 0,artifactVersion:ef,onArtifactRuntimeError:e=>{G.track({event_key:"claudeai.artifacts.execution.error",artifact_version_uuid:null==w?void 0:w.toString(),error_type:e.type,source:null==v?void 0:v.versions[ef].source})},artifact:v,hasMenuOpen:eY,ArtifactMcpModal:$.I}),(0,n.jsx)(S.N,{children:eq&&(0,n.jsx)(A.P.div,{initial:{opacity:0,y:20,x:"-50%"},animate:{opacity:1,y:0,x:"-50%"},transition:{duration:.3,delay:.8,ease:"easeOut"},exit:{opacity:0,y:20,x:"-50%",transition:{duration:.3,ease:"easeOut"}},className:"absolute bottom-20 left-1/2",children:(0,n.jsx)("div",{children:(0,n.jsx)(Y,{onSubmitNotes:e=>{ez({event_key:"artifact.feedback.note",note:e,message_uuid:ey,artifact_type:null==v?void 0:v.type,artifact_language:null==v?void 0:v.language}),eN(!1)},onSubmitRating:e=>{ez({event_key:"artifact.feedback.sentiment",type:e?"thumbs_up":"thumbs_down",message_uuid:ey,artifact_type:null==v?void 0:v.type,artifact_language:null==v?void 0:v.language}),eE({dismissed_artifact_feedback_form:!0}),eN(!0)},onClose:()=>{eS(!0),eE({dismissed_artifact_feedback_form:!0}),eN(!1)}})})})})]}),(null==v?void 0:v.versions[ef])&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ee.Dr,{messageUuid:v.versions[ef].message,isOpen:en&&!eb,onClose:eo,artifact:v,selectedVersion:ef,publishedArtifactUuid:ej,richSandboxRef:q}),eg&&w&&(0,n.jsx)(er,{isOpen:ex,onClose:ev,artifactVersionUuid:w,artifact:v,messageUuid:v.versions[ef].message,isProjectArtifact:!!(null==Q?void 0:Q.is_private)})]}),H&&w&&(0,n.jsx)($.I,{isOpen:H,requestedServers:es,onClose:()=>J(!1),artifactContext:{uuid:w,type:"artifact_version",id:null==v?void 0:v.id}}),w&&(0,n.jsx)(ed,{isOpen:eR,onClose:eU,artifactVersionUuid:w,conversationUuid:eT})]})};function ei(e){var t;let{versionCount:s,selectedVersion:a,artifact:i,canRenderNormal:l,canOnlyRenderRaw:r,canOnlyRenderNormal:o,viewing:d,setViewing:c,showRaw:p,canRefresh:v,isSandboxLoading:_,handleRefresh:N,canShare:S,handleOpenShareModal:A,isStreaming:E,canPublish:T,wasUnpublished:L,publishedArtifactUuid:O,projectParams:D,onClose:P,openPublishModal:G,handleVersionSelect:W,hasMenuOpen:V,setHasMenuOpen:q,richSandboxRef:H,hasArtifactToolConfig:Y,setShowArtifactMcpModal:J,storageInfo:K,openResetStorageModal:X}=e,Z=(0,U.A)(),$=(0,k.V)(w.E_),{copyToClipboard:ee,didCopy:es}=(0,b.C)(),{copyToProject:ea,isCopiedToProject:en}=function(e){let{projectUuid:t,artifact:s,selectedVersion:a}=e,[i,l]=(0,R.useState)(!1),{mutateAsync:r,data:o}=(0,F.fh)(null!=t?t:""),{addError:d}=(0,u.Y)();return(0,R.useEffect)(()=>{if(null==o?void 0:o.uuid){l(!0);let e=setTimeout(()=>{l(!1)},12e3);return()=>clearTimeout(e)}},[o]),{copyToProject:async()=>{if(s)try{var e;await r({file_name:"".concat(s.title,".").concat(y.K5[s.type].extension()),content:null!=(e=s.versions[a].resultState)?e:""})}catch(e){d((0,n.jsx)(I.A,{defaultMessage:"Error adding artifact to project: {error}",id:"sSg3OiDDja",values:{error:e}}),{error:e})}},isCopiedToProject:i}}({artifact:i,projectUuid:null!=(t=null==D?void 0:D.projectUuid)?t:"",selectedVersion:a});async function ei(){var e,t;if(!i)return;let s=i.type===y.vU.Markdown,n=i.type===y.vU.React,l=null!=(e=i.versions[a].resultState)?e:"";if(n&&H.current){let e=await (null==(t=H.current)?void 0:t.copyHtmlContent());e?await ee({text:e,html:e}):await ee(l)}else if(s)try{let e=(0,B.u)(l);await ee({text:l,html:e})}catch(e){await ee(l)}else await ee(l)}let{ref:er,width:eo}=function(){let e=(0,R.useRef)(null),[t,s]=(0,R.useState)(()=>{var t,s;return null!=(s=null==(t=e.current)?void 0:t.offsetWidth)?s:null});return(0,R.useEffect)(()=>{let t=z()(()=>{e.current&&s(e.current.offsetWidth)},20,{leading:!0,trailing:!0}),a=new ResizeObserver(t);if(e.current){let s=e.current;return t(),a.observe(s),()=>a.disconnect()}},[]),{ref:e,width:t}}(),ed=eo&&eo<480,ec=!p&&v,{addError:eu}=(0,u.Y)(),em=(null==i?void 0:i.type)===y.vU.Markdown&&"raw"!==d?(0,n.jsx)(x.tJ,{onSelect:async()=>{try{await (0,et.M9)(i)}catch(e){eu((0,n.jsx)(I.A,{defaultMessage:"Error downloading PDF",id:"fes7nfwp3b"}),{error:e})}},children:(0,n.jsx)(I.A,{defaultMessage:"Download as PDF",id:"camH0DLf91"})},"saveAsPdf"):null,ep=i?(0,n.jsx)(x.tJ,{asChild:!0,"data-testid":"export-download",children:(0,n.jsx)(el,{artifact:i,selectedVersion:a})},"download"):null;return(0,n.jsxs)("div",{ref:er,className:(0,M.A)("pr-2 pl-3 flex items-center justify-between gap-2 select-none",$?[w.X_,w.zo,"draggable"]:"py-2"),children:[i&&(0,n.jsx)(Q,{currentArtifact:i,hasMenuOpen:V,setHasMenuOpen:q}),V?(0,n.jsxs)("div",{className:"flex justify-between items-center flex-1 text-sm text-text-300 pl-1",children:[(0,n.jsx)(I.A,{defaultMessage:"Switch between artifacts",id:"mYiLqlDMdl"}),!p&&ec&&_?(0,n.jsx)("div",{className:"flex h-8 w-8 items-center justify-center",children:(0,n.jsx)(C.Loading,{size:"sm"})}):null]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:(0,M.A)("flex items-center flex-1 gap-2"),children:[!(!l||r||o)&&(0,n.jsx)(m.Iz,{options:[{key:"normal",label:(0,n.jsx)(h.kU3,{size:16}),ariaLabel:Z.formatMessage({defaultMessage:"Preview",id:"TJo5E6JuIN"})},{key:"code",label:(0,n.jsx)(h.CyN,{size:16}),ariaLabel:Z.formatMessage({defaultMessage:"Code",id:"h2vipunVVd"})}],initialKey:"normal"===d?"normal":"code",onSelect:e=>{c("normal"===e?"normal":"raw")},itemClassName:"!px-1"},"normal"===d?"normal":"code"),s>1?(0,n.jsx)(x.ms,{align:"start",trigger:(0,n.jsxs)(g.$,{variant:"ghost",size:"sm",className:"group !text-text-000 gap-1 justify-between !pl-1.5 !pr-1 !text-sm","data-testid":"artifact-version-trigger",children:["v",a+1,ed||a!==s-1?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:"âˆ™"}),(0,n.jsx)(I.A,{defaultMessage:"Latest",id:"adThp5MDl0"})]}),(0,n.jsx)(h.biH,{size:16,className:"opacity-0 group-hover:opacity-100 group-[&[data-state=open]]:opacity-100"})]}),children:Array.from({length:s}).map((e,t)=>s-t).map(e=>(0,n.jsxs)(x.tJ,{"data-testid":"version-dropdown",className:"flex justify-between",onSelect:()=>W(e-1),children:[(0,n.jsx)(I.A,{defaultMessage:"Version {versionNum}",id:"iMMX+ZCJ/I",values:{versionNum:e}}),e===s?(0,n.jsxs)(n.Fragment,{children:[" - ",(0,n.jsx)(I.A,{defaultMessage:"Latest",id:"adThp5MDl0"})]}):null,e-1===a?(0,n.jsx)(h.Jlk,{className:"text-accent-secondary-100",size:16}):null]},e))}):null]}),(0,n.jsxs)("div",{className:(0,M.A)("flex gap-2 items-center text-sm"),children:[ed?(0,n.jsxs)(x.ms,{align:"end",trigger:(0,n.jsx)(g.$,{variant:"ghost",size:"unset",className:"!text-text-000 !shrink gap-1 !px-1 !py-0.5 text-sm","data-testid":"artifact-menu-trigger","aria-label":Z.formatMessage({defaultMessage:"More options for artifact",id:"O91Ji7GVP2"}),children:(0,n.jsx)(h.txq,{size:16})}),children:[ec&&(0,n.jsx)(x.tJ,{disabled:_,onSelect:N,children:(0,n.jsx)(I.A,{defaultMessage:"Refresh",id:"rELDbByu8U"})},"refresh"),K&&K.total_size_bytes>0&&!p&&(0,n.jsx)(x.tJ,{onSelect:X,children:(0,n.jsx)(f.YX,{id:"silver_apple_jungle"})},"reset-storage"),Y&&!p&&(0,n.jsx)(x.tJ,{onSelect:()=>J(!0),children:(0,n.jsx)(I.A,{defaultMessage:"Manage connectors",id:"cqx+RdJnHp"})},"manage-connectors"),(0,n.jsx)(x.tJ,{onSelect:ei,children:(0,n.jsx)(I.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"})},"copy"),S?(0,n.jsx)(x.tJ,{onSelect:A,children:(0,n.jsx)(I.A,{defaultMessage:"Share",id:"OKhRC6eWRw"})},"share"):null,L?(0,n.jsx)(x.tJ,{disabled:!0,onSelect:G,children:(0,n.jsx)(I.A,{defaultMessage:"Unpublished",id:"wbU4tD+0G+"})},"unpublished"):T?(0,n.jsx)(x.tJ,{onSelect:G,children:(0,n.jsx)(I.A,{defaultMessage:"Publish",id:"syEQFEKfku"})},"publish"):null,ep,em]}):(()=>{let e=!p&&ec&&(_?(0,n.jsx)("div",{className:"flex h-8 w-8 items-center justify-center",children:(0,n.jsx)(C.Loading,{size:"sm"})}):(0,n.jsx)(g.$,{variant:"ghost",size:"icon_sm",onClick:N,children:(0,n.jsx)(h.MvQ,{size:16})})),t=S&&(0,n.jsx)(g.$,{onClick:A,variant:"primary",size:"sm",disabled:E,prepend:(0,n.jsx)(h.SYj,{size:16,className:"mr-0.5"}),children:(0,n.jsx)("span",{className:"text-sm",children:(0,n.jsx)(I.A,{defaultMessage:"Share",id:"OKhRC6eWRw"})})}),s=T&&(0,n.jsx)(j.Tooltip,{open:!!L&&void 0,tooltipContent:(0,n.jsx)(I.A,{defaultMessage:"This artifact was previously unpublished. Create a new artifact to publish again.",id:"173M62fqu+"}),children:(0,n.jsx)(g.$,{onClick:G,variant:"primary",size:"sm",disabled:L||E,className:(0,M.A)(L&&"!pointer-events-auto"),children:(0,n.jsx)("span",{className:"text-sm",children:void 0===O||L?(0,n.jsx)(I.A,{defaultMessage:"Publish",id:"syEQFEKfku"}):(0,n.jsx)(I.A,{defaultMessage:"Published",id:"w7tf2zwi6+"})})})}),a=(0,n.jsxs)(x.AM,{mainButtonText:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:(0,M.A)(es?"invisible":""),children:(0,n.jsx)(I.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"})}),es?(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)(h.Jlk,{size:16})}):null]}),onClickMainButton:ei,children:[(null==D?void 0:D.show)?en?(0,n.jsx)(x.tJ,{disabled:!0,children:(0,n.jsx)(I.A,{defaultMessage:"Copied to project",id:"KYVs6Ta+VU"})},"added-to-project"):(0,n.jsx)(x.tJ,{onSelect:ea,children:(0,n.jsx)(I.A,{defaultMessage:"Copy to project",id:"Xmf/Sp7n9T"})},"add-to-project"):null,ep,em]}),i=K&&K.total_size_bytes>0&&!p&&(0,n.jsx)(j.Tooltip,{tooltipContent:(0,n.jsx)(f.YX,{id:"silver_apple_jungle"}),children:(0,n.jsx)(g.$,{variant:"ghost",size:"icon_sm",onClick:X,children:(0,n.jsx)(h.lMJ,{size:16})})}),l=Y&&!p&&(0,n.jsx)(j.Tooltip,{tooltipContent:(0,n.jsx)(I.A,{defaultMessage:"Manage connectors",id:"cqx+RdJnHp"}),children:(0,n.jsx)(g.$,{variant:"ghost",size:"icon_sm",onClick:()=>J(!0),children:(0,n.jsx)(h.wB_,{size:16})})});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex gap-1 items-center",children:[e,i,l]}),a,t,s]})})(),(0,n.jsx)(g.$,{variant:"ghost",size:"icon_sm",onClick:P,children:(0,n.jsx)(h.X,{size:16})})]})]})]})}function el(e){let{artifact:t,selectedVersion:s}=e,{downloadUrl:a,filename:i}=((e,t)=>{let[s,a]=(0,R.useState)(""),[n,i]=(0,R.useState)("");return(0,R.useEffect)(()=>{var s;let n=null!=(s=e.versions[t].resultState)?s:"",l=(0,y.eg)(e),r=new Blob([n],{type:"text/plain"}),o=URL.createObjectURL(r);return a(o),i("".concat(e.id,".").concat(l)),()=>{URL.revokeObjectURL(o)}},[e,t]),{downloadUrl:s,filename:n}})(t,s),l=function(e){switch(e.type){case y.vU.Markdown:return"Markdown";case y.vU.Html:return"HTML";case y.vU.React:return"TSX";case y.vU.Svg:return"SVG";case y.vU.Text:return"TXT";case y.vU.Mermaid:return"Mermaid";case y.vU.Code:var t;return null!=(t=y.K5[e.type].extension(e))?t:null;default:return null}}(t);return(0,n.jsx)("a",{href:a,download:i,className:"py-1 px-2 rounded-md cursor-pointer whitespace-nowrap overflow-hidden grid grid-cols-[minmax(0,_1fr)_auto] gap-2 hover:bg-bg-200 hover:text-text-000 text-sm",children:l?(0,n.jsx)(I.A,{defaultMessage:"Download as {fileType}",values:{fileType:l},id:"PJh4v0uaV6"}):(0,n.jsx)(I.A,{defaultMessage:"Download file",id:"k9qHCCLPA5"})})}p.J.div(es()),p.J.div(ea());let er=e=>{let{onClose:t,isOpen:s,artifactVersionUuid:a,artifact:i,messageUuid:r,isProjectArtifact:o}=e,c=(0,U.A)(),{track:u}=(0,d.st)(),{mutateAsync:m,isPending:p}=(0,l.yE)(a),{data:f,isLoading:h}=(0,l.EC)(a),g=(null==f?void 0:f.visibility)==="shared",x=p||h,[C,v]=(0,R.useState)("");(0,R.useEffect)(()=>{if(""===C)return;let e=setTimeout(()=>v(""),5e3);return()=>clearTimeout(e)},[C]);let j="".concat(window.location.origin,"/artifacts/").concat(a),{copyToClipboard:y}=(0,b.C)(),w=x?"loading":g?"shared":"private",_=(0,R.useRef)(w);_.current!==w&&("loading"!==_.current&&"private"===w&&v(c.formatMessage({defaultMessage:"Artifact no longer shared",id:"5AFOwOoFPe"})),_.current=w);let k=e=>{"private"===e&&g&&m({visibility:"private"}).then(()=>t()),"shared"!==e||g||m({visibility:"shared"}).then(()=>y(j))};return(0,n.jsx)(eo,{isOpen:s,onClose:t,isLoading:x,isShared:g,isProjectArtifact:o,sharedLink:j,updateSharedState:k,handleClickShareButton:()=>{k("shared"),u({event_key:"artifact.share.modal.share_button_clicked",message_uuid:r,artifact_type:i.type,artifact_language:i.language})}})};function eo(e){let{isOpen:t,onClose:s,isShared:a,isProjectArtifact:i,sharedLink:l,isLoading:r,updateSharedState:o,handleClickShareButton:d}=e,{copyToClipboard:c,didCopy:u}=(0,b.C)();return(0,n.jsx)(v.aF,{title:(0,n.jsx)("span",{className:"text-text-200 font-claude-response text-xl font-medium",children:a?(0,n.jsx)(I.A,{defaultMessage:"Artifact shared",id:"0TqmonlxQo"}):(0,n.jsx)(I.A,{defaultMessage:"Share artifact",id:"FeSSOL+/49"})}),isOpen:t,onClose:s,modalSize:"lg",hasCloseButton:!0,children:(0,n.jsx)("div",{className:"mt-1 flex flex-col gap-2.5",children:a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"border-0.5 border-border-300 text-text-100 flex flex-col rounded-xl",children:[(0,n.jsxs)("div",{className:"border-b-0.5 border-border-300 flex gap-3 py-3 pl-3 pr-5",children:[(0,n.jsx)("div",{children:(0,n.jsx)(h.qzq,{className:"mt-1",size:16})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h6",{className:"font-medium",children:(0,n.jsx)(I.A,{defaultMessage:"Shared",id:"kWI6zXRaHY"})}),(0,n.jsx)("p",{className:"text-text-300",children:i?(0,n.jsx)(I.A,{defaultMessage:"Anyone who has access to this project can view this artifact and its associated attachments and files.",id:"fxjJJNetIb"}):(0,n.jsx)(I.A,{defaultMessage:"Anyone in your organization can view this artifact and its associated attachments and files.",id:"P+skcC6AMa"})})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3 py-3 pl-3 pr-5",children:[(0,n.jsx)(L(),{className:"text-text-300 truncate text-sm",href:l,children:l}),(0,n.jsx)(g.$,{variant:"ghost",className:"!text-accent-secondary-000 hover:bg-accent-secondary-900 font-medium",onClick:()=>{c(l)},prepend:u?(0,n.jsx)(h.rAV,{size:16}):(0,n.jsx)(h.Xq1,{size:16}),children:u?(0,n.jsx)(I.A,{defaultMessage:"Link copied",id:"zU/q1NoIdN"}):(0,n.jsx)(I.A,{defaultMessage:"Copy link",id:"lbr3Lq2Lnm"})})]})]}),(0,n.jsx)("div",{className:"flex items-center gap-4",children:(0,n.jsx)(g.$,{size:"lg",variant:"secondary",loading:r,onClick:()=>o("private"),children:(0,n.jsx)(I.A,{defaultMessage:"Unshare",id:"bEq+NWNIXF"})})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"text-text-400 flex flex-col gap-3 py-3",children:i?(0,n.jsxs)("p",{className:"bg-bg-300 text-text-300 flex gap-2 rounded-xl p-3 text-sm",children:[(0,n.jsx)(h.R2D,{size:16,className:"mt-0.5 shrink-0"}),(0,n.jsx)(I.A,{defaultMessage:"This artifact was created in a private project. Anyone in your organization who has access to this project will be able to view this artifact.",id:"g6r4HATHuW"})]}):(0,n.jsx)("p",{children:(0,n.jsx)(I.A,{defaultMessage:"Anyone in your organization can view this artifact. It also has access to attachments and files in the conversation.",id:"AnqiBApCMX"})})}),(0,n.jsxs)("div",{className:"border-0.5 border-border-300 text-text-100 flex gap-3 rounded-xl py-3 pl-3 pr-5",children:[(0,n.jsx)(h.c_I,{className:"mt-0.5",size:16}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h6",{className:"font-medium",children:(0,n.jsx)(I.A,{defaultMessage:"Unshared",id:"0r/9ANkloS"})}),(0,n.jsx)("p",{className:"text-text-300",children:(0,n.jsx)(I.A,{defaultMessage:"Only you have access",id:"U+7IIlpC6m"})})]})]}),(0,n.jsx)("div",{className:"mt-3 flex w-full items-center justify-end gap-2",children:(0,n.jsx)(g.$,{size:"lg",loading:r,onClick:d,children:(0,n.jsx)(I.A,{defaultMessage:"Share & copy link",id:"E7GQdF/HSA"})})})]})})})}let ed=e=>{let{isOpen:t,onClose:s,artifactVersionUuid:a,conversationUuid:i}=e,{addError:l}=(0,u.Y)(),{mutateAsync:r,isPending:o}=(0,O.rz)({entityId:a,artifactEntityType:"artifact_version",conversationUuid:i}),d=async()=>{try{await r(void 0),s()}catch(e){l((0,n.jsx)(f.YX,{id:"cotton_camel_pyramid"}),{error:e})}};return(0,n.jsx)(v.aF,{title:(0,n.jsx)(f.YX,{id:"silver_apple_jungle"}),isOpen:t,onClose:s,modalSize:"md",hasCloseButton:!0,children:(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsx)("p",{className:"text-text-400",children:(0,n.jsx)(f.YX,{id:"golden_pear_forest"})}),(0,n.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,n.jsx)(g.$,{variant:"secondary",onClick:s,disabled:o,children:(0,n.jsx)(I.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,n.jsx)(g.$,{variant:"primary",onClick:d,loading:o,children:(0,n.jsx)(f.YX,{id:"silver_apple_jungle"})})]})]})})}},9317:(e,t,s)=>{s.d(t,{K:()=>_,r:()=>N});var a=s(54568),n=s(19298),i=s(89626),l=s(2e3),r=s(72902),o=s(61295),d=s(10369),c=s(45271),u=s(17300),m=s(90215),p=s(39109),f=s(7620),h=s(56995),g=s(14333),x=s(65891),C=s(81478);let v=e=>{let{title:t,subtitles:s,url:l,disabled:o,isError:d,icon:c,isInSelectionMode:m=!1,isSelected:p=!1,onSelect:h,onSelectForBulk:g}=e,x=(0,f.useCallback)(()=>{h&&m&&h(!p,!1)},[m,h,p]),C=(0,f.useCallback)(()=>{h&&(!m&&g?g():h(!p,!1))},[m,h,p,g]);return(0,a.jsxs)("div",{className:"group/row relative flex items-center pl-1",onClick:x,style:{cursor:m?"pointer":void 0},children:[h&&(0,a.jsxs)("div",{className:"shrink-0 w-5 h-5 flex items-center justify-center",onClick:e=>{e.stopPropagation(),C()},children:[(0,a.jsx)("div",{className:(0,r.A)("absolute transition-all duration-200",m||p?"opacity-100 scale-100":"opacity-0 scale-75 group-hover/row:opacity-100 group-hover/row:scale-100"),children:(0,a.jsx)(u.S,{disabled:o,checked:p,onChange:e=>{h(e,!1)},label:"Select ".concat(t),hideLabel:!0,onClick:e=>e.stopPropagation()})}),(0,a.jsx)(i.ryu,{vectorSizeOverride:18,className:(0,r.A)("transition-all duration-200 text-text-400 pointer-events-none",m||p?"opacity-0 scale-75":"opacity-100 scale-100 group-hover/row:opacity-0 group-hover/row:scale-75")})]}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)(n.$,{icon:c,title:t,subtitles:s,url:l,disabled:o,isError:d})})]})},j=e=>{let{results:t,disabled:s}=e,[n,i]=(0,f.useState)(!1),[l,r]=(0,f.useState)(!1),d=(0,f.useMemo)(()=>t.map(e=>({uuid:e.conversationUuid,type:"conversation"})),[t]),{selectedItems:c,handleSelect:u,selectAllItems:j,isInSelectionMode:b,toggleSelectMode:y}=(0,x.m)(d,s),w=(0,f.useCallback)(e=>{y(!0),u({uuid:e,type:"conversation"},!0,!1)},[y,u]),_=(0,f.useCallback)(()=>{r(!1),y(!1)},[y]),k=(0,f.useCallback)(()=>{i(!1),y(!1)},[y]),N=(0,f.useMemo)(()=>c.map(e=>{let{uuid:t}=e;return t}),[c]),M=t.length>0;return(0,a.jsxs)(m.o,{children:[(0,a.jsxs)("div",{className:"relative flex flex-col h-full",children:[(0,a.jsx)(o.P.div,{variants:{initial:{opacity:0},animate:{opacity:1}},initial:"initial",animate:"animate",className:"flex flex-col flex-nowrap p-2 pt-0 overflow-y-auto flex-1",children:t.map(e=>{let t=c.some(t=>t.uuid===e.conversationUuid);return(0,a.jsx)(v,{title:e.title,subtitles:e.subtitles,url:e.url,disabled:s,icon:e.icon,isInSelectionMode:b,isSelected:t,onSelect:(t,s)=>{u({uuid:e.conversationUuid,type:"conversation"},t,s)},onSelectForBulk:()=>w(e.conversationUuid)},e.conversationUuid)})}),(0,a.jsx)(p.N,{children:b&&M&&(0,a.jsx)(o.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"sticky bottom-0 bg-bg-000/[98%] border-t-0.5 border-border-300 rounded-b-lg",children:(0,a.jsx)("div",{className:"ml-[0.875rem] mr-2 pt-1 pb-1.5",children:(0,a.jsx)(C.g,{numSelected:c.length,totalNumItems:t.length,handleSelectAll:j,handleCancel:()=>y(!1),handleDeleteSelected:()=>i(!0),handleMoveToProject:()=>r(!0)})})})})]}),c.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{isOpen:n,onClose:k,conversationUuids:N}),(0,a.jsx)(g.h,{conversationUuids:N,isOpen:l,onClose:_})]})]})};var b=s(40304),y=s(99411),w=s(72253);function _(e){var t,s,n;let i,{integrationName:l,icon:r,integrationIcon:o,message:c,result:u,isStreaming:m,isError:p,isExpandingDisabled:f,isFirstBlockOfMessage:h,isLastBlockOfMessage:g,wrapperClassName:x,contentClassName:C,defaultExpanded:v=!1,toolName:j,renderMode:b,groupItemKey:_,isFirstItemInGroup:k,isLastItemInGroup:E}=e,z=(0,d.A)(),{isExpanded:T,setIsExpanded:L}=(0,w.a)(v,_),R=!!u&&!f&&!m&&("rich_content"!==u.type||(null==(t=u.content)?void 0:t.length)>0);return i=u?"rich_content"===u.type?z.formatMessage({defaultMessage:"{count, plural, one {# result} other {# results}}",id:"s88ium+h8p"},{count:null!=(n=null==(s=u.content)?void 0:s.length)?n:0}):"JSON":void 0,(0,a.jsx)(y.sH,{isError:p,isExpandingDisabled:!R,isExpanded:T,setIsExpanded:L,isStreaming:!!m,text:null!=c?c:m?z.formatMessage({defaultMessage:"Searching",id:"IfE0if3ytt"}):z.formatMessage({defaultMessage:"Searched",id:"0ZuuhwjU4n"}),secondaryText:m?void 0:i,icon:r||(0,a.jsx)(N,{integrationName:l,iconUrl:o,canShowLetterIcon:!0}),isFirstBlockOfMessage:h,isLastBlockOfMessage:g,wrapperClassName:x,renderMode:b,isFirstItemInGroup:k,isLastItemInGroup:E,children:(0,a.jsxs)(y.NG,{isExpanded:T,snappyTransition:!0,isScrollable:!0,className:C,children:[R&&(null==u?void 0:u.type)==="rich_content"&&(0,a.jsx)(M,{disabled:!T||m,result:u,integrationName:l,toolName:j}),R&&(null==u?void 0:u.type)==="table"&&(0,a.jsx)(S,{result:u}),R&&(null==u?void 0:u.type)==="json_block"&&(0,a.jsx)(A,{result:u})]})})}let k=["Google Calendar","Gmail","Google Drive","Search Project Knowledge","Search Past Conversations"],N=e=>{let t,{canShowLetterIcon:s,integrationName:n,toolName:r,iconUrl:o,size:d=16}=e;switch(n){case"Search Project Knowledge":return(0,a.jsx)(i.JtL,{vectorSizeOverride:d});case"Memory":case"Search Past Conversations":return(0,a.jsx)(i.ce8,{vectorSizeOverride:d});case"Google Drive":t=l.v8.GDRIVE;break;case"Google Calendar":t=l.v8.GCAL;break;case"Gmail":t=l.v8.GMAIL}let u=n||r;return(0,a.jsx)(c.z,{size:d,name:u,...t?{type:"syncSource",src:t}:{type:"favicon",src:o,fallbackToGlobe:!(u&&s)}})},M=e=>{let{disabled:t,integrationName:s,result:i,toolName:l}=e,r=l?l.split("").reduce((e,t)=>e+t.charCodeAt(0),0):0,d=!!s&&k.includes(s)&&2039!==r&&2010!==r;if("Search Past Conversations"===s){let e=i.content.map(e=>{let{title:t,subtitles:n,url:i,icon_url:l}=e;if(i){let e=i.match(/\/chat\/([a-f0-9-]+)/);if(e)return{conversationUuid:e[1],title:t,subtitles:n,url:i,icon:d?void 0:(0,a.jsx)(N,{integrationName:s,iconUrl:l})}}return null}).filter(e=>null!==e);return(0,a.jsx)(j,{results:e,disabled:t,integrationName:s,hideIcons:d})}return(0,a.jsx)(o.P.div,{variants:{initial:{opacity:0},animate:{opacity:1,transition:{staggerChildren:.05}}},initial:"initial",animate:"animate",className:"flex flex-col flex-nowrap p-2 pt-0",children:i.content.map((e,i)=>{let{title:l,subtitles:r,url:o,resource_type:c,icon_url:u}=e;return(0,a.jsx)(n.$,{disabled:t,icon:d?void 0:(0,a.jsx)(N,{integrationName:s,iconUrl:u}),title:l,subtitles:r,url:o,tag:c},i)})})},S=e=>{let{result:t}=e;return(0,a.jsx)(E,{table:t.table})},A=e=>{let{result:t}=e,s=(0,d.A)();return(0,a.jsx)("div",{className:"flex flex-col gap-3 p-3 pt-1",children:(0,a.jsx)(b.z,{title:s.formatMessage({defaultMessage:"Response",id:"MgdnPiJHcj"}),code:t.json_block})})},E=e=>{let{table:t}=e;return(0,a.jsx)("div",{className:"grid p-2 pt-0",style:{gridTemplateColumns:"1fr 2fr"},children:t.map((e,s)=>{let[n,i]=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:(0,r.A)("flex items-center p-2",s<t.length-1&&"border-b-0.5 border-border-300"),children:(0,a.jsx)("p",{className:"font-medium text-text-300 text-xs",children:n})}),(0,a.jsx)("div",{className:(0,r.A)("flex items-center p-2",s<t.length-1&&"border-b-0.5 border-border-300"),children:(0,a.jsx)("p",{className:"text-text-500 text-xs",children:i})})]})})})}},10304:(e,t,s)=>{s.d(t,{x:()=>a});function a(e,t,s){return"share"===e?"".concat(window.location.origin,"/artifacts/").concat(t.artifact_version_uuid):"publish"===e&&t.published_artifact_uuid?"".concat(s,"/public/artifacts/").concat(t.published_artifact_uuid):void 0}},19150:(e,t,s)=>{s.d(t,{O:()=>g,_:()=>x});var a=s(54568),n=s(19736),i=s(74813),l=s(89626),r=s(23812),o=s(37541),d=s(28044),c=s(72902),u=s(96442),m=s(7620),p=s(59666),f=s(61605);let h=(0,u.default)(()=>Promise.all([s.e(9883),s.e(3510),s.e(8059),s.e(2103)]).then(s.bind(s,44484)).then(e=>e.ShareModal),{loadableGenerated:{webpack:()=>[44484]},ssr:!1});function g(e){var t;let{controlsSidebarIsOpen:s,closeControlsSidebar:n,openControlsSidebar:i,conversationUuid:u,isStreaming:m,isTemporary:f}=e,g=(0,d.V)(o.E_),C=x({conversationUuid:u,isStreaming:m}),v=!!i&&!!n&&!s;return(0,a.jsxs)("div",{className:(0,c.A)("flex items-center gap-1","transition-opacity duration-300",s?"md:opacity-0 pointer-events-none user-select-none":"md:opacity-100",!v&&"hidden"),"data-testid":"chat-actions",children:[C.showShareFlow&&!f&&(0,a.jsx)(r.$,{tooltip:null!=(t=C.disabled_reason)?t:g&&(0,a.jsx)(p.A,{defaultMessage:"Share chat",id:"bXa+lJhlYV"}),variant:g?"ghost":"secondary",size:g?"icon_sm":"sm",onClick:C.openShareModal,disabled:C.disabled||!v,prepend:g&&(0,a.jsx)(l.SYj,{}),children:!g&&(0,a.jsx)(p.A,{defaultMessage:"Share",id:"OKhRC6eWRw"})}),g&&(0,a.jsx)(r.$,{tooltip:(0,a.jsx)(p.A,{defaultMessage:"New chat",id:"ATDyLPIoxz"}),href:"/new",size:"icon_sm",variant:"claude",disabled:!v,className:"ml-1",children:(0,a.jsx)(l.OMN,{size:16})}),C.showShareFlow&&(0,a.jsx)(h,{...C})]})}function x(e){let{track:t}=(0,i.st)(),{data:s}=(0,n.O2)(e.conversationUuid),[a,l]=(0,m.useState)(!1),r=(0,m.useCallback)(()=>{l(!0)},[l]);(0,f.Kh)("share_chat",r);let o=(0,m.useCallback)(()=>{t({event_key:"chat.share.button.clicked",conversation_uuid:e.conversationUuid}),r()},[t,e.conversationUuid,r]),d=!!(null==s?void 0:s.snapshot),c=d||!!(null==s?void 0:s.shareable)||!!(null==s?void 0:s.disabled_reason),u=e.isStreaming||!d&&!(null==s?void 0:s.shareable);return{conversationUuid:e.conversationUuid,showShareModal:a,openShareModal:o,closeShareModal:()=>l(!1),isShared:d,showShareFlow:c,disabled:u,...s}}},20804:(e,t,s)=>{s.d(t,{DT:()=>C,i1:()=>v,Ih:()=>p,h4:()=>f,D8:()=>g});var a=s(54568),n=s(16256),i=s(68067),l=s(72902),r=s(61295),o=s(39109),d=s(7620),c=s(89626),u=s(59666);let m=(0,d.memo)(e=>{let{collapsedCount:t,isExpanded:s,onToggle:n}=e;if(0===t)return null;let i=s?(0,a.jsx)(u.A,{defaultMessage:"Hide steps",id:"Iufn28MeR1"}):(0,a.jsx)(u.A,{defaultMessage:"{collapsedCount, plural, one {# step} other {# steps}}",id:"dS6ebV+vpY",values:{collapsedCount:t}});return(0,a.jsxs)("button",{onClick:n,type:"button",className:(0,l.A)("group/collapse-indicator flex flex-row min-h-[2.125rem] shrink-0 w-full","hover:bg-bg-200 cursor-pointer transition-colors duration-200"),children:[(0,a.jsxs)("div",{className:"flex flex-col items-center pl-3 box-border pointer-events-none",children:[(0,a.jsx)("div",{className:(0,l.A)("transition-all grow w-[1px] bg-border-300",s&&"opacity-0"),style:{minHeight:"calc((2.125rem - 16px) / 2)"}}),(0,a.jsx)("div",{className:"transition-all flex items-center justify-center my-0.5 shrink-0 w-[16px] h-[16px]",children:(0,a.jsx)("span",{className:(0,l.A)("inline-flex transition-transform duration-400 ease-snappy-out",s?"rotate-180":"rotate-0"),children:(0,a.jsx)(c.IJm,{className:"text-text-500 group-hover/collapse-indicator:text-text-300",size:16})})}),(0,a.jsx)("div",{className:"transition-all grow w-[1px] bg-border-300",style:{minHeight:"calc((2.125rem - 16px) / 2)"}})]}),(0,a.jsx)("div",{className:"flex items-center px-3 py-2 flex-1 text-sm pointer-events-none",children:(0,a.jsx)("span",{className:"text-text-500 group-hover/collapse-indicator:text-text-300",children:i})})]})});m.displayName="CollapsedToolsIndicator";let p=(e,t)=>!(!["thinking","tool_use","tool_result","token_budget"].includes(e.type)||"tool_use"===e.type&&["prism","end_conversation","launch_extended_search_task"].includes(e.name))&&(!!t.get("timeline_artifacts_enabled",!1)||("tool_use"!==e.type||"artifacts"!==e.name)&&("tool_result"!==e.type||"artifacts"!==e.name))&&(!!t.get("timeline_gsuite_enabled",!1)||"tool_use"!==e.type||!e.integration_name),f=e=>"tool_result"!==e.type&&"token_budget"!==e.type,h=d.createContext({}),g=()=>(0,d.useContext)(h),x=e=>{let[t,s]=(0,d.useState)(void 0),n=(0,d.useMemo)(()=>({expandedItemKey:t,setExpandedItemKey:s}),[t,s]);return(0,a.jsx)(h.Provider,{value:n,children:e.children})},C=e=>{let{children:t,isFirstBlockOfMessage:s,isLastBlockOfMessage:c,isStreaming:u}=e,p=(0,i.fS)("claudeai_collapse_timeline_groups"),[f,h]=(0,d.useState)(!1),g=(0,d.useCallback)(e=>{e.stopPropagation(),h(e=>!e)},[]),C=d.Children.toArray(t),v=Math.max(0,C.length-2),j=p&&!f?C.slice(-2):C;return(0,a.jsx)(r.P.div,{initial:{opacity:+!u},animate:{opacity:1},transition:{duration:.5,ease:"easeIn"},className:(0,l.A)("transition-all duration-400 ease-out rounded-lg border-0.5 flex flex-col font-ui leading-normal my-3 border-border-300 min-h-[2.625rem] overflow-hidden",s?"mt-2":"mt-3",c?"mb-2":"mb-3"),children:(0,a.jsxs)(x,{children:[p&&v>0&&(0,a.jsx)(m,{collapsedCount:v,isExpanded:f,onToggle:g}),(0,a.jsx)(o.N,{initial:!1,mode:"sync",children:j.map((e,t)=>(0,a.jsx)(r.P.div,{className:"overflow-hidden shrink-0",layout:"position",initial:{opacity:0,height:0},animate:"expanded",exit:"collapsed",variants:{expanded:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{layout:{duration:0},ease:n.A.snappyOut,duration:.2},children:e},d.isValidElement(e)&&null!==e.key?e.key:t))})]})})},v=e=>{let{icon:t,isExpanded:s,isFirstItem:n,isLastItem:i,isActive:r,children:o}=e,d={minHeight:"calc((2.125rem - ".concat(t?"16px":"6px",") / 2)")};return(0,a.jsxs)("div",{className:(0,l.A)("flex flex-row min-h-[2.125rem] shrink-0",{"bg-bg-000":s},{"hover:bg-bg-200":!s}),children:[(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center pl-3 box-border",children:[(0,a.jsx)("div",{className:(0,l.A)("transition-all w-[1px]",{"bg-border-300":!n}),style:d}),(0,a.jsx)("div",{className:(0,l.A)("transition-all flex items-center justify-center my-1 shrink-0 w-[16px]",{"h-[16px]":!!t}),children:null!=t?t:(0,a.jsx)("div",{className:(0,l.A)("size-[6px] rounded-full",r?"bg-accent-main-200":"bg-border-300")})}),(0,a.jsx)("div",{className:(0,l.A)("transition-all grow w-[1px]",{"bg-border-300":!i}),style:d})]}),(0,a.jsx)("div",{className:"w-full flex flex-col min-w-0",children:o})]})}},23910:(e,t,s)=>{s.d(t,{d:()=>C});var a=s(54568),n=s(64328),i=s(9679),l=s(7620),r=s(10369),o=s(59666),d=s(45271),c=s(35580),u=s(40304),m=s(99411),p=s(23812),f=s(52157);function h(e){let{disabled:t,submitToolApproval:s,showAlwaysAllowed:n,setIsExpanded:i}=e,l=e=>{s(e),i(!1)};return(0,f.W)("keydown",e=>{if("Escape"===e.key){e.preventDefault(),l("deny");return}if("Enter"===e.key){let t=e.metaKey||e.ctrlKey;t&&n?(e.preventDefault(),l("always")):t||(e.preventDefault(),l("once"))}}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 p-3 pt-0",children:[(0,a.jsx)("div",{className:"flex flex-col justify-center items-start p-3 bg-bg-200 border-0.5 border-border-400/15 rounded-md min-h-[41px]",children:(0,a.jsx)("p",{className:"text-xs",children:(0,a.jsx)(o.A,{defaultMessage:"Claude cannot guarantee the security or privacy practices of third-party integrations.",id:"3gyayAmXQv"})})}),(0,a.jsxs)("div",{className:"self-end flex gap-2",children:[(0,a.jsx)(p.$,{variant:"secondary",onClick:()=>l("deny"),shortcut:"escape",children:(0,a.jsx)(o.A,{defaultMessage:"Deny",id:"htvX+Z11l+"})}),n&&(0,a.jsx)(p.$,{variant:"secondary",disabled:t,onClick:()=>l("always"),shortcut:"cmd+enter",children:(0,a.jsx)(o.A,{defaultMessage:"Always allow",id:"lr3QX/nctD"})}),(0,a.jsx)(p.$,{variant:"primary",disabled:t,onClick:()=>l("once"),shortcut:"enter",children:(0,a.jsx)(o.A,{defaultMessage:"Allow once",id:"O2tb5KUxpc"})})]})]})}var g=s(72253);let x=e=>{let{input:t,toolResult:s}=e,i=(0,r.A)(),{activeOrganization:l}=(0,n.YL)(),o=null==l?void 0:l.uuid,d="";if(void 0!==t){try{d=JSON.stringify(t,null,2)}catch(e){d=String(t)}d=(d=d.replace(/\\n/g,"\n").replace(/\\t/g,"	")).replace(RegExp('(?<!\\\\)"',"g"),"`")}return(0,a.jsxs)("div",{className:"flex flex-col gap-3 p-3 pt-1",children:[(0,a.jsx)(u.z,{title:i.formatMessage({defaultMessage:"Request",id:"p1P+hQq6tY"}),language:"javascript",code:d}),null==s?void 0:s.content.map((e,t)=>"text"===e.type?(0,a.jsx)(u.z,{title:i.formatMessage({defaultMessage:"Response",id:"MgdnPiJHcj"}),language:"json",code:e.text},t):"image"===e.type?(0,a.jsx)("img",{src:"/api/".concat(o,"/files/").concat(e.file_uuid,"/preview"),alt:i.formatMessage({defaultMessage:"Tool result",id:"OJmR+3dTK6"}),className:"max-w-md max-h-md h-auto rounded-md"},t):void 0)]})},C=e=>{var t,s;let{toolName:n,integrationName:r,integrationIcon:u,approvalData:p,isSessionChat:f,...C}=e,{input:v,toolResult:j,groupItemKey:b,autoscrollRef:y,shareType:w}=C,_=(0,i.q)(),k=(0,l.useRef)(!1),N=!!(null==p?void 0:p.approvalRequired),{isExpanded:M,setIsExpanded:S,snappyTransition:A}=(0,g.a)(!1,b,N),E=N||!!w||f,z=(0,c.pK)(n),T=(null==z||null==(t=z.tool)?void 0:t.displayName)||n.split("__")[2]||n.split(":").pop()||n;(0,c.Q1)();let L=N?r?(0,a.jsx)(o.A,{defaultMessage:"Claude wants to use {toolName} from {integrationName}",id:"wPBSjwhfE4",values:{toolName:T,integrationName:r}}):(0,a.jsx)(o.A,{defaultMessage:"Claude wants to use {toolName}",id:"ZNLjFNb5bD",values:{toolName:T}}):T,R=null==j||null==(s=j.content)?void 0:s[0];return(0,a.jsx)(m.sH,{isExpanded:_&&M,setIsExpanded:S,isExpandingDisabled:E,text:L,isError:null==j?void 0:j.is_error,errorMessage:(null==R?void 0:R.type)==="text"?R.text:void 0,icon:(0,a.jsx)(d.z,{size:16,type:z?z.server.iconType:"favicon",src:z?z.server.iconSrc:u,name:r||T}),...C,children:(0,a.jsx)(m.NG,{isExpanded:_&&M,snappyTransition:A,onAnimationComplete:()=>{if(N&&!k.current){var e;null==y||null==(e=y.current)||e.scrollToBottom("smooth",{onlyIfPinned:!0}),k.current=!0}},isScrollable:!0,footer:N?(0,a.jsx)(h,{...p,setIsExpanded:S}):null,children:(0,a.jsx)(x,{input:v,toolResult:j})})})}},24423:(e,t,s)=>{s.d(t,{Ci:()=>B,Gu:()=>O,HF:()=>N,JX:()=>y,P8:()=>A,Po:()=>g,Q3:()=>G,QS:()=>S,RR:()=>P,ST:()=>M,SY:()=>x,U4:()=>R,dd:()=>k,gq:()=>D,n5:()=>z,ot:()=>v,oz:()=>h,so:()=>V,uO:()=>L,uQ:()=>F,w0:()=>E,xJ:()=>I,xw:()=>w,zg:()=>U});var a=s(19736),n=s(57291),i=s(20795),l=s.n(i),r=s(4211),o=s(50848),d=s(42469),c=s(97345),u=s(26761);let m={uuid:"",sender:"assistant",content:[],created_at:"",updated_at:"",attachments:[],files:[],files_v2:[],sync_sources:[],index:0,parent_message_uuid:void 0},p=e=>{let t={};return e.forEach(e=>{if("assistant"!==e.sender)return;let[s]=f(t,e);Object.keys(s).forEach(e=>{t[e]={...t[e],...s[e]}})}),t},f=(e,t)=>{let s=(0,n.Xz)(t),a=null,i={};return s.forEach(t=>{var s,l,r;let{id:o,currentVersion:d,type:c,title:u,language:m}=t,p=null==(r=((null==(s=i[o])?void 0:s.versions)||(null==(l=e[o])?void 0:l.versions)||[]).slice(-1)[0])?void 0:r.resultState,f=(0,n.zI)(d,p),h={...d,resultState:f};i[o]?i[o]={...i[o],versions:[...i[o].versions,h]}:e[o]?i[o]={...e[o],versions:[...e[o].versions,h]}:i[o]={id:o,type:c||"document",title:u||"Untitled",language:m||void 0,versions:[h]},a=o}),[i,a]},h=(0,r.v)()((0,o.eh)((e,t)=>({selectedMessageUuid:null,messageByUuid:{},pathUuidsByConversation:{},conversationSettings:null,artifacts:{},allFiles:[],allAttachments:[],allSyncSources:[],hasArtifacts:!1,fullText:"",lastStreamingArtifactId:null,streamingArtifacts:{},setSelectedMessage:t=>e({selectedMessageUuid:t}),setMessages:(t,s)=>{e(e=>{let n={},i=[];s.forEach(e=>{n[e.uuid]=e,i.push(e.uuid)});let l=p(s),r=s.flatMap(e=>e.files),o=s.flatMap(e=>e.attachments),d=s.flatMap(e=>e.sync_sources),c=Object.keys(l).length>0,u=s.map(e=>(0,a.Rs)(e)).join(" ");return{messageByUuid:n,pathUuidsByConversation:{...e.pathUuidsByConversation,[t]:i},artifacts:l,streamingArtifacts:{},allFiles:r,allAttachments:o,allSyncSources:d,hasArtifacts:c,fullText:u,lastStreamingArtifactId:null}})},appendMessages:(e,s)=>{let a=t(),n=[...(a.pathUuidsByConversation[e]||[]).map(e=>a.messageByUuid[e]).filter(Boolean),...s];a.setMessages(e,n)},updateMessage:(s,n)=>{let{messageByUuid:i}=t(),l={...i,[s]:n},r=Object.values(l),o=p(r),d=r.flatMap(e=>e.files),c=r.flatMap(e=>e.attachments),u=r.flatMap(e=>e.sync_sources),m=Object.keys(o).length>0;e({messageByUuid:l,artifacts:o,allFiles:d,allAttachments:c,allSyncSources:u,hasArtifacts:m,fullText:r.map(e=>(0,a.Rs)(e)).join(" "),lastStreamingArtifactId:null})},setArtifacts:t=>e({artifacts:t,hasArtifacts:Object.keys(t).length>0}),setConversationSettings:t=>e({conversationSettings:t}),setPathUuids:(t,s)=>e(e=>({pathUuidsByConversation:{...e.pathUuidsByConversation,[t]:s}})),updateStreamingMessage:(s,a,n)=>{let{messageByUuid:i,pathUuidsByConversation:l,artifacts:r}=t(),o=l[s]||[],d=o[o.length-1],c=i[d];if(!c)return;let u={...c,content:n},[m,p]=f(r,u);e({messageByUuid:{...i,[d]:u},lastStreamingArtifactId:p,streamingArtifacts:m})},getConversationMessages:e=>{let s=t();return(s.pathUuidsByConversation[e]||[]).map(e=>s.messageByUuid[e]).filter(Boolean)}}))),g=()=>h(e=>e.setArtifacts),x=()=>h(e=>e.lastStreamingArtifactId),C=[],v=e=>h((0,d.k)(t=>{let s=t.pathUuidsByConversation[e];return s&&0!==s.length?s.map(e=>t.messageByUuid[e]).filter(Boolean):C})),j=new Map,b=[],y=e=>h(t=>{let s=t.messageByUuid[e];return s||(j.has(e)||j.set(e,{...m,uuid:e}),j.get(e))}),w=e=>h(t=>t.pathUuidsByConversation[e]||b),_=e=>h((0,d.k)(e)),k=()=>_(e=>e.artifacts),N=()=>(0,c.n)(h,e=>({...e.artifacts,...e.streamingArtifacts}),l()),M=e=>(0,c.n)(h,t=>t.artifacts[e],l()),S=()=>_(e=>e.allFiles),A=()=>_(e=>e.allAttachments),E=()=>_(e=>e.allSyncSources),z=e=>h(t=>{let s=(t.pathUuidsByConversation[e]||[])[0];return s?t.messageByUuid[s]:void 0}),T=e=>h(t=>{let s=(t.pathUuidsByConversation[e]||[])[1];return s?t.messageByUuid[s]:void 0}),L=e=>{var t;let s=T(e);return(null==s||null==(t=s.content)?void 0:t.length)||0},R=e=>{let t=T(e);return null==t?void 0:t.sender},I=e=>h(t=>{let s=t.pathUuidsByConversation[e]||[],a=s[s.length-1];return a?t.messageByUuid[a]:m}),U=e=>h(t=>(t.pathUuidsByConversation[e]||[]).map(e=>t.messageByUuid[e]).filter(Boolean).some(e=>(0,u.OC)(e))),O=()=>h(e=>e.setMessages),F=()=>h(e=>e.appendMessages),D=()=>h(e=>e.updateStreamingMessage),P=()=>h(e=>e.getConversationMessages),B=(e,t)=>(0,c.n)(h,s=>{let a=s.pathUuidsByConversation[e]||[],n=a[a.length-1],i=n?s.messageByUuid[n]:void 0;if(i){if(t){var l;return{...i,content:(null==(l=i.content)?void 0:l.map(e=>{let t={type:e.type};return("tool_use"===e.type||"tool_result"===e.type)&&(t.name=e.name),t}))||[]}}return i}},(e,s)=>{var a,n,i,l;return e&&s&&t?e.uuid===s.uuid&&(null==(a=e.content)?void 0:a.length)===(null==(n=s.content)?void 0:n.length)&&e.attachments.length===s.attachments.length&&e.files.length===s.files.length&&(null==(i=e.files_v2)?void 0:i.length)===(null==(l=s.files_v2)?void 0:l.length):e===s}),G=e=>h(t=>{let s=t.pathUuidsByConversation[e]||[];for(let e=s.length-1;e>=0;e--){let a=t.messageByUuid[s[e]];if(a&&"human"===a.sender)return a}}),W=new Set(["bash","bash_tool","create_file","str_replace"]),V=e=>h(t=>{let s=t.pathUuidsByConversation[e]||[];for(let e=s.length-1;e>=0;e--){let a=t.messageByUuid[s[e]];if(!a)continue;let n=a.content;if(n)for(let e=n.length-1;e>=0;e--){let t=n[e];if("tool_result"===t.type&&W.has(t.name))return[t.name,a.uuid,e].join("-")}}})},26434:(e,t,s)=>{s.d(t,{W:()=>a,m:()=>n});let a=e=>(e.split("/").pop()||e).replace(/\.[^/.]+$/,"").split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),n=(e,t)=>{if(!t)return!0;let s=e.replace("computer://","");if("org_scoped"===t)return s.startsWith("/mnt/user-data/");if("public"===t)return!1;throw Error("Unknown share type: ".concat(t))}},26761:(e,t,s)=>{s.d(t,{OC:()=>n,eb:()=>i,nb:()=>l});var a=s(57958);function n(e){var t;return!!l(e)&&!!(null==(t=e.content)?void 0:t.some(e=>"tool_result"===e.type&&"artifacts"===e.name))}function i(e){let t=l(e);if(!t)return;let s=t.content.map(e=>e&&"text"in e?e.text:"").join("\n"),{data:n}=a.z7.safeParse(s);return null==n?void 0:n.task_id}function l(e){var t;return null==(t=e.content)?void 0:t.find(e=>"tool_result"===e.type&&"launch_extended_search_task"===e.name)}},26786:(e,t,s)=>{s.d(t,{f:()=>c});var a=s(54568),n=s(20453),i=s(60967),l=s(23812),r=s(39500),o=s(98304),d=s(7620);let c=e=>{let{attachment:t,goBack:s,onClose:c}=e,u=(0,d.useMemo)(()=>(0,i.E)(t),[t]);return(0,a.jsxs)("div",{className:"flex h-full flex-col pb-1 pl-5 pt-3",children:[(0,a.jsxs)("div",{className:"sticky flex items-center gap-1 pr-5",children:[s&&(0,a.jsx)(l.$,{onClick:s,variant:"ghost",size:"icon",className:"-ml-2 shrink-0",children:(0,a.jsx)(r.n,{size:20})}),(0,a.jsx)("h2",{className:"font-ui flex-1 truncate text-lg font-medium",children:u.title}),(0,a.jsx)(l.$,{variant:"ghost",size:"icon",className:"-mr-2",onClick:c,"data-testid":"close-file-preview",children:(0,a.jsx)(o.X,{size:20})})]}),(0,a.jsxs)("div",{className:"mb-1 flex flex-col pb-3 pr-5 min-h-0 flex-1",children:[(0,a.jsx)(n.G,{metaData:u.metaData}),(0,a.jsx)("div",{className:"-m-1 mt-0 min-h-0 flex-1 whitespace-pre-wrap break-all text-xs p-4 bg-bg-000 rounded-lg border-0.5 border-border-300  overflow-y-auto font-mono shadow-sm",children:t.extracted_content})]})]})}},27769:(e,t,s)=>{s.d(t,{FT:()=>l,Ud:()=>r,Xp:()=>o});var a=s(57291),n=s(14935),i=s.n(n);function l(e){var t;let s=e.name.split("."),a=s.slice(0,-1).join("."),n=s.length>1?null!=(t=s.at(-1))?t:"":null,l=a.replaceAll(/[_-]/g," ");return{displayName:i()(l),displayExt:n?n.toUpperCase():null}}function r(e){var t;let s=null==(t=e.split(".").pop())?void 0:t.toLowerCase();return s?["skill"].includes(s)?"skill":["csv","tsv"].includes(s)?"table":["xls","xlsx"].includes(s)?"spreadsheet":["pptx"].includes(s)?"preso":["pdf","md","docx"].includes(s)?"doc":["mermaid","mmd"].includes(s)?"diagram":["jsx","tsx"].includes(s)?"code":["svg"].includes(s)||a._o.includes(s)?"image":a.Uv.includes(s)?"code":null:null}function o(e){let{displayExt:t}=l(e),s=r(e.name),a={code:{label:"Code",isPreviewable:!0},table:{label:"Table",isPreviewable:!0},spreadsheet:{label:"Spreadsheet",isPreviewable:!0},doc:{label:"Document",isPreviewable:!0},image:{label:"Image",isPreviewable:!0},diagram:{label:"Diagram",isPreviewable:!0},preso:{label:"Presentation",isPreviewable:!1},skill:{label:"Skill",isPreviewable:!0}},{label:n}=s&&a[s]?a[s]:{label:null},i=n&&t?" \xb7 ":"";return"".concat(null!=n?n:"").concat(i).concat(null!=t?t:"")}},29257:(e,t,s)=>{s.d(t,{A:()=>ew});var a=s(54568),n=s(68067),i=s(2e3),l=s(7620),r=s(79052),o=s(35391),d=s(98372),c=s(59666);let u=()=>(0,a.jsxs)("div",{className:"items-top flex w-full bg-bg-200 mt-5 p-3 rounded-xl items-center text-text-300",children:[(0,a.jsx)(d.R,{size:24}),(0,a.jsx)("p",{className:"font-base ml-3",children:(0,a.jsx)(c.A,{defaultMessage:"Claude has ended this chat.",id:"xJ+abA4nue"})})]});var m=s(19094),p=s(47592),f=s(95617),h=s(23132),g=s(24407),x=s(45271),C=s(99411);let v=g.z.object({url:g.z.string()}),j=e=>{let t,{input:s,toolResult:n,isStreaming:i}=e,r=null==n?void 0:n.is_error,[o,d]=(0,l.useState)(!1),u=(0,l.useMemo)(()=>{if(r)return;let e=function(e){if(!e||!e.content)return null;if(e.content.some(e=>"knowledge"===e.type)){let t=[];for(let s of e.content)"knowledge"===s.type&&t.push(s);return t}try{let t=e.content[0];if((null==t?void 0:t.type)!=="text")return[];let s=JSON.parse(t.text);return Array.isArray(s)?s.map(e=>{let t=f.ey.safeParse(e);return t.success?t.data:null}).filter(e=>null!==e):[]}catch(e){return[]}}(n);return null==e?void 0:e[0]},[r,n]),g=(0,l.useMemo)(()=>{if(!r)return;let e=function(e){if(!e||!e.content)return null;if(e.content.some(e=>"text"===e.type)){let t=[];for(let s of e.content)if("text"===s.type){let e=function(e){try{return JSON.parse(e)}catch(e){return null}}(s.text);if(null===e)t.push({error_type:"UNKNOWN_ERROR",error_message:s.text});else{let s=f.kS.safeParse(e);s.success&&t.push(s.data)}}return t}try{let t=e.content[0];if((null==t?void 0:t.type)!=="text")return[];let s=JSON.parse(t.text);return Array.isArray(s)?s.map(e=>{let t=f.tD.safeParse(e);if(!t.success)return null;{let e=f.kS.safeParse(JSON.parse(t.data.text));return e.success?e.data:null}}).filter(e=>null!==e):[]}catch(e){return[]}}(n);return null==e?void 0:e[0]},[r,n]),j=function(e){switch(e){case"INVALID_URL":return(0,a.jsx)(c.A,{defaultMessage:"The URL provided is invalid",id:"EXjAXf5Pbi"});case"URL_NOT_FOUND":return(0,a.jsx)(c.A,{defaultMessage:"Could not find this URL",id:"stDgCXJO7F"});case"RATE_LIMIT_EXCEEDED":return(0,a.jsx)(c.A,{defaultMessage:"Access to this website has been restricted due to rate limits",id:"VhUxwIo+O2"});case"ROBOTS_DISALLOWED":return(0,a.jsx)(c.A,{defaultMessage:"This website has blocked Claude via robots.txt rules",id:"dHtmXRJ647"});case"URL_TOO_LONG":return(0,a.jsx)(c.A,{defaultMessage:"The URL provided is too long",id:"K2DBYJqbtF"});case"SITE_BLOCKED":return(0,a.jsx)(c.A,{defaultMessage:"Access to this website is blocked",id:"WI6DZStAoi"});case"PERMISSIONS_ERROR":return(0,a.jsx)(c.A,{defaultMessage:"The URL was not provided by the user nor was it contained in any web search/fetch results",id:"aXYLYDjU6L"});case"UNKNOWN_ERROR":case"SERVER_ERROR":case"CLIENT_ERROR":return(0,a.jsx)(c.A,{defaultMessage:"An unknown error occurred",id:"3VG8rbxa4v"});case void 0:return null}}(null==g?void 0:g.error_type),{data:b}=v.safeParse(s);if(!b)return;let y=b.url,w=(null==u?void 0:u.title)||y,_=(0,p.Nj)(y);return t=i?_?(0,a.jsx)(c.A,{defaultMessage:"Fetching from {hostname}",id:"5qKeNV67+8",values:{hostname:_}}):(0,a.jsx)(c.A,{defaultMessage:"Fetching from site",id:"TSZq9sKvY7"}):r?(0,a.jsx)(c.A,{defaultMessage:"Failed to fetch <b>{title}</b>",id:"8JHipUo6K+",values:{title:w,b:e=>(0,a.jsx)("span",{className:"text-text-400",children:e})}}):(0,a.jsx)(c.A,{defaultMessage:"Fetched <b>{title}</b>",id:"BWNvvK6PhH",values:{title:w,b:e=>(0,a.jsx)("span",{className:"text-text-400",children:e})}}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(C.aX,{isError:r,errorMessage:j,text:t,secondaryText:i?void 0:_,handleClick:()=>d(!0),icon:(0,a.jsx)(x.z,{size:16,type:"favicon",src:y,name:_||"Fetch",fallbackToGlobe:!0}),secondaryIcon:(0,a.jsx)(h.B,{size:16,className:"text-text-300"}),...e}),(0,a.jsx)(m.v,{isOpen:o,url:y,onClose:()=>d(!1),onConfirm:()=>{window.open(y,"_blank"),d(!1)}})]})};var b=s(71700),y=s(19298),w=s(9398),_=s(76579),k=s(61295),N=s(67149),M=s.n(N),S=s(10369),A=s(50571),E=s(22167),z=s(46868),T=s(72253);function L(e){return"webpage_metadata"===e.metadata.type?e.url||"":e.metadata.doc_uuid}let R=e=>{let{isExpanded:t,toolName:s,results:n}=e;return(null==n?void 0:n.length)?(0,a.jsx)("div",{className:"flex flex-nowrap p-2 pt-0 flex-col",tabIndex:-1,children:"web_search"===s?(0,a.jsx)(U,{results:n,isExpanded:t}):(0,a.jsx)(O,{results:n,isExpanded:t})}):null},I={initial:{opacity:0,scale:.7},animate:{opacity:1,scale:1,transition:{type:"spring",stiffness:400,damping:30,mass:1}}},U=e=>{let{isExpanded:t,results:s}=e;return(0,a.jsx)(a.Fragment,{children:s.map(e=>{var s;return e.knowledge&&"webpage_metadata"===e.knowledge.metadata.type?(0,a.jsx)(k.P.div,{variants:I,children:(0,a.jsx)(y.$,{disabled:!t,icon:(0,a.jsx)(b.d,{url:e.knowledge.metadata.favicon_url,size:16}),title:e.knowledge.title,subtitles:[e.knowledge.metadata.site_domain],url:null!=(s=e.knowledge.url)?s:void 0})},e.knowledge.url):null})})},O=e=>{let{isExpanded:t,results:s}=e;return(0,a.jsx)(a.Fragment,{children:s.map(e=>(0,a.jsx)(k.P.div,{variants:I,children:(0,a.jsx)(F,{disabled:!t,knowledge:e.knowledge})},e.uuid))})},F=e=>{let{disabled:t,knowledge:s}=e,l=(0,n.fS)("mcp_gdrive"),o=(e=>{let{isError:t}=e,s=(0,E.Cg)(i.v8.GDRIVE),a=s.isAuthenticated;return(0,A.v_)(s.server_uuid)?a?t?i.I5.ACCESS_DENIED:i.I5.READY:i.I5.UNAUTHENTICATED:i.I5.DISABLED})({isError:!s}),d=(e=>{let{isError:t}=e,{isDriveAuthenticated:s}=(0,r.cI)();return(0,r.yy)()?s?t?i.I5.ACCESS_DENIED:i.I5.READY:i.I5.UNAUTHENTICATED:i.I5.DISABLED})({isError:!s});return(0,a.jsx)(z.Tc,{syncSourceType:i.v8.GDRIVE,syncStatus:l?o:d,disabled:t,title:(null==s?void 0:s.title)||"Untitled document",subtitles:(null==s?void 0:s.metadata.type)==="google_doc_metadata"&&s.metadata.owner?[s.metadata.owner]:void 0,url:(null==s?void 0:s.url)||void 0})},D=g.z.object({query:g.z.string(),n:g.z.number().int().optional()}),P=e=>{var t;let{toolName:s,syncSourceType:n,...i}=e,{input:l,toolResult:r,isStreaming:o,groupItemKey:d}=i,{isExpanded:c,setIsExpanded:u,snappyTransition:m}=(0,T.a)(!1,d),p=(0,S.A)(),h=null==r?void 0:r.is_error,g=h?null:function(e){if(!e)return null;if(e.content.some(e=>"knowledge"===e.type||"rag_reference"===e.type)){let t=[];for(let s of e.content)if("knowledge"===s.type)t.push({uuid:L(s),knowledge:s});else if("rag_reference"===s.type){let e=s.doc_uuid;t.push({uuid:e})}return M()(t,e=>e.uuid)}try{let t=e.content[0];if((null==t?void 0:t.type)!=="text")return[];let s=JSON.parse(t.text),a=(Array.isArray(s)?s.map(e=>{let t=f.ey.safeParse(e);return t.success?t.data:null}).filter(e=>null!==e):[]).map(e=>({uuid:L(e),knowledge:e}));return M()(a,e=>e.uuid)}catch(e){return[]}}(r),{data:x}=D.safeParse(l),v="web_search"===s?p.formatMessage({defaultMessage:"Searching the web",id:"5KajyzHSXj"}):p.formatMessage({defaultMessage:"Searching Google Drive",id:"V/QOi0yNF0"});if(!x)return;let j=p.formatMessage({defaultMessage:"{count, plural, one {# result} other {# results}}",id:"s88ium+h8p"},{count:null!=(t=null==g?void 0:g.length)?t:0}),b=!g&&o?v:x.query;return(0,a.jsx)(C.sH,{isExpandingDisabled:!!o,isExpanded:c,setIsExpanded:u,isError:h,text:b,secondaryText:o?void 0:j,icon:"web_search"===s?(0,a.jsx)(_.q,{size:16}):!!n&&(0,a.jsx)(w.A9,{type:n,size:14}),...i,children:(0,a.jsx)(C.NG,{isExpanded:c,snappyTransition:m,isScrollable:!0,children:!h&&!!(null==g?void 0:g.length)&&(0,a.jsx)(R,{isExpanded:c,toolName:s,results:g})})})};var B=s(57958),G=s(64328);g.z.object({prompt:g.z.string()});var W=s(787),V=s(69104),q=s(57291),H=s(72902),Y=s(24423);function J(e){var t,s,n,i;let{input:r,toolResult:o,isStreaming:d,isLastMessage:c,onOpenArtifact:u,message:m,artifactCellType:p,selectedArtifactId:f,selectedArtifactVersion:h,isFirstBlockOfMessage:g,isLastBlockOfMessage:x}=e,C=(0,l.useMemo)(()=>q.oE.parse(r),[r]),{versions:v,...j}=null!=(n=(0,Y.ST)(null!=(s=C.id)?s:""))?n:{},b=(0,l.useMemo)(()=>{let e=null==v?void 0:v.findIndex(e=>e.uuid===C.version_uuid);if(-1!==e)return e},[v,C.version_uuid]),y=null==(t=null!=(i=C.content)?i:C.new_str)?void 0:t.slice(0,250),w=(0,l.useCallback)(e=>{u&&u(e,m.uuid,C.version_uuid)},[u,m.uuid,C.version_uuid]),_=(0,l.useMemo)(()=>({isClosed:void 0!==o,...j,...C}),[o,j,C]),k=f===_.id&&h===C.version_uuid,N="individual_cell_create"===p||"multi_edit_not_last"!==p;return(0,a.jsx)("div",{className:(0,H.A)(N&&(g?"pt-2":"pt-3"),N&&(x?"pb-2":"pb-3"),"multi_edit_not_last"===p&&"h-0"),children:(0,a.jsx)(V.d,{versionNum:b?b+1:void 0,preview:y,versionCount:null==v?void 0:v.length,properties:_,isStreaming:d,isEdit:"individual_cell_create"!==p,isNotLastEdit:"multi_edit_not_last"===p,isLastMessage:c,onOpenArtifact:w,isExpanded:k})})}var K=s(9317),X=s(23910),Z=s(68480),Q=s(56929),$=s(40304);let ee=g.z.object({code:g.z.string().nullish().transform(e=>(null==e?void 0:e.charAt(0))==="\n"?e.slice(1):null!=e?e:void 0)}),et=e=>{var t;let{input:s,toolResult:n,isStreaming:i,groupItemKey:r}=e,o=(0,S.A)(),{isExpanded:d,setIsExpanded:c,snappyTransition:u}=(0,T.a)(i,r),m=null!=(t=ee.parse(s).code)?t:"",{toolResultLogs:p,toolResultErrors:f}=(0,l.useMemo)(()=>n?(e=>{let t;if(!e.content||0===e.content.length||!e.content[0])return{toolResultLogs:"",toolResultErrors:"Error: Missing content data"};if("text"!==e.content[0].type)return{toolResultLogs:"",toolResultErrors:""};try{t=JSON.parse(e.content[0].text)}catch(e){return(0,Q.Cp)(e,{tags:{source:"repl-tool-result"}}),{toolResultLogs:"",toolResultErrors:"Error: failed to parse Analysis tool result"}}let s=t.logs?"Result\n\n"+t.logs.join("\n"):"";return"error"===t.status?{toolResultLogs:s,toolResultErrors:"Error\n\n"+t.error}:{toolResultLogs:s,toolResultErrors:""}})(n):{toolResultLogs:"",toolResultErrors:""},[n]);return(0,a.jsx)(C.sH,{isExpanded:d,setIsExpanded:c,icon:(0,a.jsx)(Z.N,{size:16}),text:i?o.formatMessage({defaultMessage:"Analyzing data",id:"UkajfL/9Yh"}):o.formatMessage({defaultMessage:"Analyzed data",id:"NbwDtG2acW"}),secondaryText:i?void 0:o.formatMessage({defaultMessage:"View analysis",id:"fL+Q/8QHAy"}),...e,children:(0,a.jsx)(C.NG,{isExpanded:d,snappyTransition:u,isScrollable:!0,children:(0,a.jsxs)("div",{className:"flex flex-col gap-3 p-3 pt-1","data-testid":"repl-output",children:[(0,a.jsx)($.z,{language:"javascript",code:m}),(0,a.jsx)($.z,{title:o.formatMessage({defaultMessage:"Output",id:"fio5opLcOZ"}),language:"javascript",code:p}),!!f&&(0,a.jsx)($.z,{title:o.formatMessage({defaultMessage:"Error",id:"KN7zKn8z4F"}),code:f,codeTagProps:{className:"text-danger-000"},className:"!bg-danger-900"})]})})})};var es=s(57969),ea=s(48252);let en=e=>{let{streamingAction:t,errorAction:s,successAction:n,target:i,isStreaming:l=!1,isError:r=!1,description:o}=e;return o&&!r?l?(0,a.jsx)(ea.N,{children:o}):(0,a.jsx)("span",{className:"text-text-200",children:o}):(0,a.jsxs)("span",{className:"flex items-center min-w-0 text-text-200",children:[(0,a.jsx)("span",{className:"whitespace-nowrap mr-1 text-text-200",children:l?t:r?s:n}),(0,a.jsx)("span",{className:"bg-gradient-to-b from-bg-300 via-bg-300/80 to-bg-300 shadow-xs rounded px-1 py-0.5 font-mono truncate overflow-hidden text-ellipsis min-w-0 text-text-200",title:i,children:i})]})},ei=g.z.object({returncode:g.z.number().int(),stdout:g.z.string(),stderr:g.z.string()});function el(e){if(!e.content||0===e.content.length)return null;let t=e.content[0];return(null==t?void 0:t.type)==="text"?t.text:null}let er=e=>{let{input:t,toolResult:s,isStreaming:n,isFirstBlockOfMessage:i,isLastBlockOfMessage:r,renderMode:o,groupItemKey:d,isFirstItemInGroup:c,isLastItemInGroup:u}=e,m=(0,S.A)(),{isExpanded:p,setIsExpanded:f,snappyTransition:h}=(0,T.a)(!1,d),g=(null==t?void 0:t.command)||"",x=(null==s?void 0:s.is_error)||!1,v=(0,l.useMemo)(()=>(function(e,t,s){if(!e)return;if(t)return{type:"error",rawContent:el(e)||JSON.stringify(e,null,2)};let a=el(e);if(!a)return{type:"empty"};try{let e=ei.parse(JSON.parse(a));return{type:"success",data:e}}catch(e){try{let e=JSON.parse(a);if(Array.isArray(e)&&e.length>0&&"text"===e[0].type&&e[0].text){let t=ei.parse(JSON.parse(e[0].text));return{type:"success",data:t}}}catch(e){}return s?void 0:{type:"parse-error",rawContent:a}}})(s,x,n),[s,x,n]),j=null==t?void 0:t.description;return(0,a.jsx)(C.sH,{isExpanded:p,setIsExpanded:f,isStreaming:!!n,icon:(0,a.jsx)(es.b,{size:16}),text:(0,a.jsx)(en,{streamingAction:m.formatMessage({defaultMessage:"Running",description:"Status header for a bash command",id:"ScRq37Oq7S"}),errorAction:m.formatMessage({defaultMessage:"Failed to run",description:"Status header for a bash command",id:"O15lx6IwMb"}),successAction:m.formatMessage({defaultMessage:"Ran",description:"Status header for a bash command",id:"JUMXBud/d6"}),target:g,isStreaming:n,isError:x,description:j}),isFirstBlockOfMessage:i,isLastBlockOfMessage:r,renderMode:o,isFirstItemInGroup:c,isLastItemInGroup:u,children:(0,a.jsx)(C.NG,{isExpanded:p,snappyTransition:h,isScrollable:!0,children:(0,a.jsxs)("div",{className:"flex flex-col gap-3 p-3 pt-1","data-testid":"repl-output",children:[(0,a.jsx)($.z,{language:"bash",code:g}),(()=>{if(!v)return null;switch(v.type){case"success":{let{data:e}=v;return(0,a.jsxs)(a.Fragment,{children:[e.stdout&&(0,a.jsx)($.z,{title:m.formatMessage({defaultMessage:"Output",description:"Title for the result of a bash command",id:"98/B4gW/HL"}),language:"bash",code:e.stdout}),e.stderr&&(0,a.jsx)($.z,{title:m.formatMessage({defaultMessage:"Error",description:"Title for the result of a bash command",id:"96iMiC11cz"}),code:e.stderr,codeTagProps:{className:"text-danger-000"},className:"!bg-danger-900"}),!e.stdout&&!e.stderr&&(0,a.jsx)($.z,{title:m.formatMessage({defaultMessage:"Output",description:"Title for the result of a bash command",id:"98/B4gW/HL"}),code:m.formatMessage({defaultMessage:"exit code {returncode}",description:"The result of a bash command",id:"Uoe/PEvNYN"},{returncode:e.returncode})})]})}case"error":return(0,a.jsx)($.z,{title:m.formatMessage({defaultMessage:"Command failed",description:"Title for the result of a bash command",id:"REMG+p+ZiU"}),code:v.rawContent,codeTagProps:{className:"text-danger-000"},className:"!bg-danger-900"});case"parse-error":return(0,a.jsx)($.z,{title:m.formatMessage({defaultMessage:"Output",description:"Title for the result of a bash command",id:"98/B4gW/HL"}),code:v.rawContent,codeTagProps:{className:"text-danger-000"},className:"!bg-danger-900"});case"empty":return(0,a.jsx)($.z,{title:m.formatMessage({defaultMessage:"No output",description:"Title for the result of a bash command",id:"DyoXiEr2fN"}),code:m.formatMessage({defaultMessage:"Command completed with no output",description:"The result of a bash command",id:"TRBc7KuuG+"})});default:return null}})()]})})})};var eo=s(39510),ed=s(78334),ec=s(49953),eu=s(18849),em=s(58841),ep=s(79901),ef=s(26434);let eh=e=>{var t,s;let{input:n,toolResult:i,isStreaming:l,isFirstBlockOfMessage:r,isLastBlockOfMessage:o,renderMode:d,groupItemKey:c,isFirstItemInGroup:u,isLastItemInGroup:m,message:p,shareType:f}=e,{chatResourceState:h,dispatchChatResource:g}=(0,em.i)(),{setIsDrawerExpanded:x}=(0,eu.x)(),v=null==i?void 0:i.is_error,j=null!=(t=null==n?void 0:n.path)?t:"",b=h.streamingFiles.get(j),y=(null==b?void 0:b.showingInRightPane)&&(null==b?void 0:b.renderAs)===q.vU.Markdown,{isExpanded:w,setIsExpanded:_,snappyTransition:k}=(0,T.a)(!y&&l,c),N=null!=(s=null==n?void 0:n.file_text)?s:"",M=(0,ep.S)(j),S="markdown"===M,A=(0,ef.W)(j),E=j.split("/").pop()||j,z=null==n?void 0:n.description,L=!v&&j&&(null==p?void 0:p.uuid)&&(0,ef.m)(j,f),R=L&&!f;return!(y&&l)&&(l||w||!k)?(0,a.jsx)(C.sH,{isExpanded:w,setIsExpanded:_,isExpandingDisabled:l,isStreaming:!!l,icon:(0,a.jsx)(ep.o,{path:(null==n?void 0:n.path)||"",size:16}),text:(0,a.jsx)(en,{streamingAction:"Creating",errorAction:"Failed to create",successAction:"Created",target:A,isStreaming:l,isError:v,description:z}),secondaryIcon:R?(0,a.jsx)("span",{className:"text-xs text-text-300 max-w-64 truncate shrink-0 min-w-0",children:E}):void 0,isFirstBlockOfMessage:r,isLastBlockOfMessage:o,renderMode:d,isFirstItemInGroup:u,isLastItemInGroup:m,children:(0,a.jsx)(C.NG,{isExpanded:w,snappyTransition:k,children:(0,a.jsx)(ec.Z,{noDefaultScroll:!l,className:"flex flex-col gap-3 p-3 pt-1 max-h-[238px] overflow-y-scroll",disabled:!1,children:(0,a.jsx)("div",{"data-testid":"repl-output",children:N&&(S&&!y?(0,a.jsx)("div",{className:"markdown-wrapper",children:l?(0,a.jsx)(eo.qO,{text:N,className:"font-claude-response prose prose-sm max-w-none",isStreaming:!0}):(0,a.jsx)(ed.fP,{text:N,className:"font-claude-response prose prose-sm max-w-none"})}):(0,a.jsx)($.z,{title:j,language:M,code:N}))})})})}):(0,a.jsx)(C.aX,{isStreaming:!!l,handleClick:L?()=>{j&&(null==p?void 0:p.uuid)&&(g({type:"SELECT_FILE",path:j,toolType:"create_file",messageId:p.uuid}),x(!0))}:void 0,icon:(0,a.jsx)(ep.o,{path:(null==n?void 0:n.path)||"",size:16}),text:(0,a.jsx)(en,{streamingAction:"Creating",errorAction:"Failed to create",successAction:"Created",target:A,isStreaming:l,isError:v,description:z}),secondaryIcon:R?(0,a.jsx)("span",{className:"text-xs text-text-300 max-w-64 truncate shrink-0 min-w-0",children:E}):void 0,isFirstBlockOfMessage:r,isLastBlockOfMessage:o,renderMode:d,isFirstItemInGroup:u,isLastItemInGroup:m})};var eg=s(58509),ex=s(67453);let eC=l.memo(e=>{let{oldStr:t="",newStr:s="",isStreaming:n=!1}=e,{linesAdded:i,linesRemoved:r}=(0,l.useMemo)(()=>{let e=t?t.split("\n").length:0;return{linesAdded:s?s.split("\n").length:0,linesRemoved:e}},[t,s]),o=(0,l.useMemo)(()=>{let e=[];return i>0&&e.push("".concat(i," ").concat(1===i?"line":"lines"," added")),r>0&&e.push("".concat(r," ").concat(1===r?"line":"lines"," removed")),e.join(", ")},[i,r]);if(0===i&&0===r)return null;let d=(0,a.jsxs)("span",{className:"flex items-center gap-1.5 text-xs font-mono mr-2 border-0.5 border-border-300 rounded px-1 py-0.5",children:[i>0&&(0,a.jsx)("span",{className:"text-forest-green",children:"+".concat(i)}),r>0&&(0,a.jsx)("span",{className:"text-danger-000",children:"-".concat(r)})]}),c=n?(0,a.jsx)(ea.N,{children:d}):d;return(0,a.jsx)(ex.Tooltip,{tooltipContent:o,align:"center",children:(0,a.jsx)("span",{className:"inline-flex",children:c})})});eC.displayName="LineDiffCounter";let ev=e=>{var t;let{input:s,toolResult:n,isStreaming:i,isFirstBlockOfMessage:l,isLastBlockOfMessage:r,renderMode:o,isFirstItemInGroup:d,isLastItemInGroup:c,message:u,shareType:m}=e,{dispatchChatResource:p}=(0,em.i)(),{setIsDrawerExpanded:f}=(0,eu.x)(),h=null==n?void 0:n.is_error,g=null!=(t=null==s?void 0:s.path)?t:"",x=(0,ef.W)(g),v=null==s?void 0:s.description,j=g.split("/").pop()||g,b=!h&&g&&(null==u?void 0:u.uuid)&&(0,ef.m)(g,m);return(0,a.jsx)(C.aX,{isStreaming:!!i,handleClick:b?()=>{g&&(null==u?void 0:u.uuid)&&(p({type:"SELECT_FILE",path:g,toolType:"str_replace",messageId:u.uuid}),f(!0))}:void 0,icon:(0,a.jsx)(eg.I,{size:16}),text:(0,a.jsx)(en,{streamingAction:"Editing",errorAction:"Failed to edit",successAction:"Edited",target:x,isStreaming:i,isError:h,description:v}),secondaryIcon:(0,a.jsxs)(a.Fragment,{children:[!h&&(0,a.jsx)(eC,{oldStr:null==s?void 0:s.old_str,newStr:null==s?void 0:s.new_str,isStreaming:i}),b&&!m&&(0,a.jsx)("span",{className:"text-xs text-text-300 max-w-64 truncate shrink-0 min-w-0",children:j})]}),isFirstBlockOfMessage:l,isLastBlockOfMessage:r,renderMode:o,isFirstItemInGroup:d,isLastItemInGroup:c})};function ej(e){let{toolResult:t,fileSyntax:s}=e,{activeOrganization:n}=(0,G.YL)(),i=null==n?void 0:n.uuid;try{var l;if(t.content&&t.content.length>0&&(null==(l=t.content[0])?void 0:l.type)==="text"){let e=t.content[0].text;try{let s=JSON.parse(e);Array.isArray(s)&&(t.content=s)}catch(e){}}if(!t.content||0===t.content.length||!t.content[0])return(0,a.jsx)(a.Fragment,{});return(0,a.jsx)(a.Fragment,{children:t.content.map((e,t)=>"text"===e.type?(0,a.jsx)($.z,{language:s,code:e.text},t):"image"===e.type?(0,a.jsx)("img",{alt:"",src:"/api/".concat(i,"/files/").concat(e.file_uuid,"/preview"),className:"max-w-md max-h-md h-auto rounded-md"},t):null)})}catch(e){return(0,a.jsx)($.z,{title:"Error displaying content - Raw result:",code:JSON.stringify(t,null,2),codeTagProps:{className:"text-danger-000"},className:"!bg-danger-900"})}}let eb=e=>{let{path:t}=e,s=t.split("/"),n=s.indexOf("skills"),i=s[n+1]||"";return(0,a.jsx)("span",{className:"flex items-center min-w-0 text-text-200 overflow-hidden",children:(0,a.jsx)("span",{className:"whitespace-nowrap text-text-200",children:(0,a.jsx)(c.A,{defaultMessage:"Loading {skill} skill",id:"b2eRiWSxS0",values:{skill:i}})})})},ey=e=>{var t;let{input:s,toolResult:n,isStreaming:i,isFirstBlockOfMessage:l,isLastBlockOfMessage:r,renderMode:o,groupItemKey:d,isFirstItemInGroup:u,isLastItemInGroup:m,message:p,shareType:f}=e,{isExpanded:h,setIsExpanded:g,snappyTransition:x}=(0,T.a)(!1,d),{dispatchChatResource:v}=(0,em.i)(),{setIsDrawerExpanded:j}=(0,eu.x)(),b=null==n?void 0:n.is_error,y=null!=(t=null==s?void 0:s.path)?t:"",w=(0,ep.S)(y),_=/\.[^/]+$/.test(y),k=y.includes("/mnt/skills/"),N=(0,ef.W)(y),M=null==s?void 0:s.description,S=y.split("/").pop()||y,A=!b&&y&&(null==p?void 0:p.uuid)&&(0,ef.m)(y,f),E=A&&!f&&!k;return _?(0,a.jsx)(C.aX,{isStreaming:!!i,handleClick:A&&!k?()=>{y&&(null==p?void 0:p.uuid)&&(v({type:"SELECT_FILE",path:y,toolType:"view",messageId:p.uuid}),j(!0))}:void 0,isDisabled:k,icon:(0,a.jsx)(ep.o,{path:(null==s?void 0:s.path)||"",size:16}),text:k&&!M?(0,a.jsx)(eb,{path:y}):(0,a.jsx)(en,{streamingAction:"Viewing",errorAction:"Failed to view",successAction:"Viewed",target:N,isStreaming:i,isError:b,description:M}),secondaryIcon:E?(0,a.jsx)("span",{className:"text-xs text-text-300 max-w-64 truncate shrink-0 min-w-0",children:i?S:(0,a.jsx)(c.A,{defaultMessage:"Show working file",id:"qucjoSGi3N"})}):void 0,isFirstBlockOfMessage:l,isLastBlockOfMessage:r,renderMode:o,isFirstItemInGroup:u,isLastItemInGroup:m}):(0,a.jsx)(C.sH,{isExpanded:h,setIsExpanded:g,isStreaming:!!i,icon:(0,a.jsx)(ep.o,{path:(null==s?void 0:s.path)||"",size:16}),text:k&&!M?(0,a.jsx)(eb,{path:y}):(0,a.jsx)(en,{streamingAction:"Viewing",errorAction:"Failed to view",successAction:"Viewed",target:N,isStreaming:i,isError:b,description:M}),isFirstBlockOfMessage:l,isLastBlockOfMessage:r,renderMode:o,isFirstItemInGroup:u,isLastItemInGroup:m,isExpandingDisabled:!n,children:(0,a.jsx)(C.NG,{isExpanded:h,snappyTransition:x,isScrollable:!0,children:(0,a.jsx)("div",{className:"flex flex-col gap-3 p-3 pt-1","data-testid":"repl-output",children:n&&(0,a.jsx)(ej,{toolResult:n,fileSyntax:w,isStreaming:i})})})})},ew=l.memo(e=>{let{toolUseId:t,isLastMessage:s,isStreaming:l,toolName:d,input:c,message:m,onOpenArtifact:p,publishedArtifacts:f,toolResult:h,artifactCellType:g,isFirstBlockOfMessage:x,isLastBlockOfMessage:C,conversationUuid:v,selectedDrawerItem:b,shareType:y,displayData:w,approvalData:_,context:k,renderMode:N=W.l.Standard,groupItemKey:M,isFirstItemInGroup:S,isLastItemInGroup:A,autoscrollRef:E,isSessionChat:z}=e,T=(0,r.fb)(),L=(0,o.be)();(0,n.fS)("prism_enabled");let R={input:c,toolResult:h,isStreaming:l,isFirstBlockOfMessage:x,isLastBlockOfMessage:C,renderMode:N,groupItemKey:M,isFirstItemInGroup:S,isLastItemInGroup:A,message:m,shareType:y,autoscrollRef:E,isSessionChat:z},I={bash_tool:er,create_file:eh,view:ey,str_replace:ev}[d];if(I)return(0,a.jsx)(I,{...R});if("end_conversation"===d)return(0,a.jsx)(u,{});let U=(null==b?void 0:b.type)==="artifact"?b:void 0,O=!!h&&!!b&&"compass"===b.type&&b.data.toolUseId===h.tool_use_id;switch(d){case"artifacts":return(0,a.jsx)(J,{input:c,toolResult:h,isLastMessage:s,isStreaming:l,onOpenArtifact:p,publishedArtifacts:f,message:m,artifactCellType:g,selectedArtifactId:null==U?void 0:U.id,selectedArtifactVersion:null==U?void 0:U.versionUuid,isFirstBlockOfMessage:x,isLastBlockOfMessage:C});case"repl":return(0,a.jsx)(et,{...R});case"drive_search":if(!T)break;return(0,a.jsx)(P,{syncSourceType:i.v8.GDRIVE,toolName:d,...R});case"web_search":if(!L)break;return(0,a.jsx)(P,{toolName:d,...R});case"web_fetch":return(0,a.jsx)(j,{...R});case"launch_extended_search_task":return(0,a.jsx)(B.wD,{toolUseId:t,isFirstBlockOfMessage:x,isLastBlockOfMessage:C,conversationUuid:v,toolResult:h,isShared:!!y,isExpanded:O,isStreaming:l,context:k})}return!d.includes(":")&&(null==w?void 0:w.integrationName)?(0,a.jsx)(K.K,{...w,toolName:d,isError:null==h?void 0:h.is_error,isStreaming:l,isFirstBlockOfMessage:x,isLastBlockOfMessage:C,renderMode:N,groupItemKey:M,isFirstItemInGroup:S,isLastItemInGroup:A}):(0,a.jsx)(X.d,{toolName:d,integrationName:null==w?void 0:w.integrationName,integrationIcon:null==w?void 0:w.integrationIcon,approvalData:_,...R})});ew.displayName="ToolUseCell"},32027:(e,t,s)=>{s.d(t,{O:()=>r,f:()=>l});var a=s(1613),n=s(64328),i=s(90458);let l=e=>{let{conversationUuid:t,source:s}=e,{activeOrganization:l}=(0,n.YL)(),r=null==l?void 0:l.uuid,o=(0,i.Z)(t),d=new URLSearchParams;s&&d.append("source",s);let c=d.toString()?"?".concat(d.toString()):"";return(0,a.Sk)("/api/organizations/".concat(r,"/artifacts/").concat(t,"/versions").concat(c),{queryKey:["conversation_artifacts_query_key",{organizationUuid:r,conversationUuid:t}],enabled:!!r&&!!t&&!o,meta:{noToast:!0}})},r=e=>{let{conversationUuid:t}=e,{activeOrganization:s}=(0,n.YL)(),i=null==s?void 0:s.uuid;return(0,a.L2)("/api/organizations/".concat(i,"/conversations/").concat(t,"/wiggle/convert-file-to-artifact"),"POST",{enabled:!!i&&!!t})}},34898:(e,t,s)=>{s.d(t,{Q:()=>p,k:()=>m});var a=s(1613),n=s(64328),i=s(42759),l=s(67632),r=s(27541),o=s(7620),d=s(99427),c=s(60956);let u=null,m=e=>{u={payload:e,received:new Date}};function p(e){let{chatId:t,chatName:s,onSend:m,hasFirstMessage:p}=e,{activeOrganization:f}=(0,n.YL)(),h=(0,a.mn)(),g=(0,o.useRef)(!1),x=(0,r.useSearchParams)(),C=(0,c.jE)(),v=(0,o.useCallback)(e=>e.chatId===t&&!g.current&&!!f&&(g.current=!0,(async()=>{try{let t=[];if("images"in e)for(let s of e.images)try{t.push(...await (0,d.bl)(s.base64,s.mimeType,f.uuid,h))}catch(e){}else if(e.imageBase64&&e.imageMimeType)try{t.push(...await (0,d.bl)(e.imageBase64,e.imageMimeType,f.uuid,h))}catch(e){}return await m({prompt:e.text,files:t}),!0}catch(e){return!1}finally{g.current=!1}})(),!0),[f,t,m,h]);return(0,o.useEffect)(()=>{if(!p)return;let e=u,s="1"===x.get("desktop_quick_entry");s&&C("desktop_quick_entry",null),e&&Date.now()-e.received.getTime()<=6e4&&e.payload.chatId&&e.payload.chatId===t&&s&&(u=null,setTimeout(()=>v(e.payload),1))},[p,t,v,x,C]),(0,i._v)(l.A.ChatInfo,{getCurrentChatInfo:()=>Promise.resolve({chatId:t,chatName:s}),sendToChatWithPayload:v},[t,s,f,h,m]),null}},37080:(e,t,s)=>{s.d(t,{CH:()=>j,GT:()=>M,IK:()=>v,Nw:()=>_,OQ:()=>y,Ui:()=>b,YE:()=>N,mk:()=>C,mq:()=>x});var a=s(54568),n=s(19736),i=s(71700),l=s(78334),r=s(1613),o=s(95617),d=s(66365),c=s(72902),u=s(61295),m=s(45312),p=s(7620),f=s(10369),h=s(24407),g=s(88775);function x(e){let{hrefs:t}=e,s=t.map((e,t)=>(0,a.jsx)(u.P.div,{className:(0,c.A)("shadow-xs h-5 w-5 rounded-full overflow-hidden border-0.5 border-border-300 bg-bg-100 flex items-stretch justify-stretch","z-".concat(t+1)),initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.1+.05*t,duration:.3},children:(0,a.jsx)(i.d,{url:e,shouldFillBackground:!0,size:14})},t));return(0,a.jsx)("div",{className:"flex items-center -space-x-2",children:s})}function C(e){let{agents:t,n:s=5}=e,a=new Set;for(let e of t)for(let t of e.annotated_snippets)for(let e of t.tool_calls){var n;if("web_search"===e.tool_name&&(null==(n=e.output)?void 0:n.type)==="rich_content"&&e.output.content.length){for(let t of e.output.content.map(e=>{let{url:t}=e;return t}).filter(Boolean))if("string"==typeof t)try{let e=new URL(t);if(a.add(e.origin),a.size>=s)return Array.from(a).slice(0,s)}catch(e){}}}return Array.from(a)}function v(e,t){let s=!t||t===o.zu.Completed,a=(0,p.useRef)(s),{mutate:i}=(0,n.HF)(e,{refetchOnSettled:!0});(0,p.useEffect)(()=>{s&&!a.current&&i({settings:{compass_mode:null}}),a.current=s},[i,s,e])}function j(e){var t,s;let{organizationUuid:a,conversationUuid:i,taskId:l,isShared:c,enabled:u}=e,[f,h]=(0,p.useState)(!0),[,x]=(0,p.useState)(0),C=(0,d.useDynamicConfig)("use_confused_carousel_sounds").get("polling",[{intervalSeconds:30}]),v=null!=(s=null==(t=C[0])?void 0:t.intervalSeconds)?s:30,[j,b]=(0,p.useState)(v),y=(0,n._W)(i),w=(0,g.Tc)(e=>e.setCurrentCompassTask,"useCompassStatus"),_=c?"/api/organizations/".concat(a,"/chat_snapshots/").concat(i,"/task/").concat(l,"/status"):"/api/organizations/".concat(a,"/chat_conversations/").concat(i,"/task/").concat(l,"/status"),{data:k,isLoading:N,error:M}=(0,r.Sk)(_,{refetchInterval:!!f&&1e3*j,enabled:!!(u&&i&&a&&l),meta:{noToast:!0}}),S=(null==k?void 0:k.status)!==void 0&&!(0,o.i3)(null==k?void 0:k.status);return(0,p.useEffect)(()=>{if(u&&i&&a&&l)if(S)h(!1),w(void 0),y(),x(0);else if(M){if(!(null==k?void 0:k.started_at))return void h(!1);x(e=>{let t=e+1,s=m.c9.fromISO(k.started_at).plus({hours:3}),a=m.c9.now();return h(t<3&&a<s),t})}else k&&!S&&(x(0),w(l))},[u,l,S,M,y,a,i,k,w]),(0,p.useEffect)(()=>{if(!(null==k?void 0:k.started_at)||!f)return;let e=setInterval(()=>{let e=function(e,t){let s=m.c9.fromISO(e),a=m.c9.now().diff(s,"seconds").seconds;for(let e of t)if(!e.durationSeconds||a<e.durationSeconds)return e.intervalSeconds;return 30}(k.started_at,C);e!==j&&b(e)},1e3*j);return()=>clearInterval(e)},[null==k?void 0:k.started_at,f,C,j]),{compassStatus:k,isLoading:N,error:M,completed:S}}let b=e=>{var t,s;return null==e||null==(s=e.agents)||null==(t=s[0])?void 0:t.name};function y(e){let t=(0,f.A)(),s=b(e);return s||(e.status!==o.zu.Completed?t.formatMessage({defaultMessage:"Researching...",id:"eD084+/kcH"}):t.formatMessage({defaultMessage:"Done researching",id:"/ONMTL4lXm"}))}let w=h.z.object({thought:h.z.string()});function _(e){let t=null==e?void 0:e.agents[0];return(0,p.useMemo)(()=>{var e,s,a;let n=null==t||null==(e=t.annotated_snippets[0])?void 0:e.thinking_blocks,i=n&&n.length>0?n[0]:void 0;if(i)return i.thinking;let l=null==t||null==(a=t.annotated_snippets[0])||null==(s=a.tool_calls)?void 0:s.find(e=>"think"===e.tool_name);if(null==l?void 0:l.tool_input)try{let e=JSON.parse(l.tool_input),{data:t}=w.safeParse(e);return null==t?void 0:t.thought}catch(e){return}},[null==t?void 0:t.annotated_snippets])}function k(e){let t=Math.floor(e/1e3),s=Math.floor(t/60),a=Math.floor(s/60);return a>0?"".concat(a,"h ").concat(s%60,"m"):s>0?"".concat(s,"m ").concat(t%60,"s"):t>0?"".concat(t,"s"):"0s"}function N(e){let{startedAt:t,completedAt:s}=e,[n,i]=(0,p.useState)(()=>m.c9.now());if((0,p.useEffect)(()=>{if(!t||s)return;let e=setInterval(()=>{i(m.c9.now())},1e3);return()=>clearInterval(e)},[t,s,i]),!t)return"Starting";let l=m.c9.fromISO(t);if(s){let e=m.c9.fromISO(s).diff(l,"milliseconds").milliseconds;return e<=0?"Starting":(0,a.jsx)(a.Fragment,{children:k(e)})}let r=n.diff(l,"milliseconds").milliseconds;return r<=1e3?"Starting":(0,a.jsx)(a.Fragment,{children:k(r)})}function M(e){let{thought:t,className:s}=e;return t?(0,a.jsx)("div",{className:(0,c.A)("text-text-100 font-claude-response-body",s),children:(0,a.jsx)(l.fP,{text:t})}):null}},39510:(e,t,s)=>{s.d(t,{qO:()=>d});var a=s(54568),n=s(72902),i=s(7620),l=s(78334);class r{isInsideStructure(){return this.inCodeBlock||this.inList||this.inTable||this.inBlockquote}processLine(e){let t=e.trim(),s=this.isInsideStructure();(t.startsWith("```")||t.startsWith("~~~"))&&(this.inCodeBlock?t.startsWith(this.codeBlockDelimiter)&&(this.inCodeBlock=!1,this.codeBlockDelimiter=""):(this.inCodeBlock=!0,this.codeBlockDelimiter=t.substring(0,3))),/^[-*+]|\d+\./.test(t)&&!this.inCodeBlock?this.inList=!0:this.inList&&""===t&&(this.inList=!1),t.includes("|")&&!this.inCodeBlock?this.inTable=!0:this.inTable&&""===t&&(this.inTable=!1);let a=t.startsWith(">");a&&!this.inCodeBlock?this.inBlockquote=!0:this.inBlockquote&&""===t&&!a&&(this.inBlockquote=!1);let n=this.lastLineWasEmpty;this.lastLineWasEmpty=""===t;let i=s&&!this.isInsideStructure();return{insideStructure:this.isInsideStructure(),structureJustClosed:i,previousLineWasEmpty:n}}reset(){this.inCodeBlock=!1,this.codeBlockDelimiter="",this.inList=!1,this.inTable=!1,this.inBlockquote=!1,this.lastLineWasEmpty=!0}constructor(){this.inCodeBlock=!1,this.codeBlockDelimiter="",this.inList=!1,this.inTable=!1,this.inBlockquote=!1,this.lastLineWasEmpty=!0}}let o=(0,i.memo)(e=>{let{text:t,blockCitations:s=[],onLinkDetected:n,onCodeDetected:i,hasLinkRef:r,hasCodeRef:o,className:d,linkTarget:c="_blank",flagShowCodeHeader:u,unsafeAllowNavigationWithoutConfirmation:m,onOpenArtifact:p,isLastMessage:f,publishedArtifacts:h,messageUuid:g,onLinkClick:x}=e;return(0,a.jsx)(l.fP,{text:t,blockCitations:s,onLinkDetected:n,onCodeDetected:i,hasLinkRef:r,hasCodeRef:o,className:d,linkTarget:c,isStreaming:!1,flagShowCodeHeader:u,unsafeAllowNavigationWithoutConfirmation:m,onOpenArtifact:p,isLastMessage:f,publishedArtifacts:h,messageUuid:g,onLinkClick:x})},(e,t)=>e.text===t.text);o.displayName="MemoizedMarkdownChunk";let d=(0,i.memo)(e=>{let{text:t,blockCitations:s=[],onLinkDetected:d,onCodeDetected:c,hasLinkRef:u,hasCodeRef:m,className:p,linkTarget:f="_blank",isStreaming:h=!1,flagShowCodeHeader:g,unsafeAllowNavigationWithoutConfirmation:x,onOpenArtifact:C,isLastMessage:v,publishedArtifacts:j,messageUuid:b,onLinkClick:y}=e,{completedChunks:w,streamingChunk:_}=((e,t)=>{let[s,a]=(0,i.useState)([]),[n,l]=(0,i.useState)(""),o=(0,i.useRef)(new r);return(0,i.useEffect)(()=>{if(!e){a([]),l("");return}if(!t){a([e]),l(""),o.current.reset();return}let s=e.split("\n"),n=[],i=[],r=-1;o.current.reset();for(let e=0;e<s.length;e++){let t=s[e],{insideStructure:a,structureJustClosed:l,previousLineWasEmpty:d}=o.current.processLine(t);if(i.push(t),l||!a&&""===t.trim()&&i.length>1&&!d){for(;i.length>0&&""===i[i.length-1].trim();)i.pop();i.length>0&&(n.push(i.join("\n")),r=e,i=[])}}let d=s.slice(r+1).join("\n");a(n),l(d)},[e,t]),{completedChunks:s,streamingChunk:n}})(t,h);return(0,a.jsxs)("div",{className:(0,n.A)("grid-cols-1 grid gap-2.5 [&_>_*]:min-w-0",p),children:[w.map((e,t)=>(0,a.jsx)(o,{text:t>0?"\n\n"+e:e,blockCitations:s,onLinkDetected:d,onCodeDetected:c,hasLinkRef:u,hasCodeRef:m,className:"",linkTarget:f,flagShowCodeHeader:g,unsafeAllowNavigationWithoutConfirmation:x,onOpenArtifact:C,isLastMessage:v,publishedArtifacts:j,messageUuid:b,onLinkClick:y},t)),_&&(0,a.jsx)(l.fP,{text:w.length>0?"\n\n"+_:_,blockCitations:s,onLinkDetected:d,onCodeDetected:c,hasLinkRef:u,hasCodeRef:m,className:"",linkTarget:f,isStreaming:!0,flagShowCodeHeader:g,unsafeAllowNavigationWithoutConfirmation:x,onOpenArtifact:C,isLastMessage:v,publishedArtifacts:j,messageUuid:b,onLinkClick:y})]})});d.displayName="ProgressiveStandardMarkDown"},40304:(e,t,s)=>{s.d(t,{z:()=>c});var a=s(54568),n=s(90732),i=s(11727),l=s(57820),r=s(80870),o=s(72902),d=s(29820);let c=e=>{let{className:t,code:s,codeTagProps:c,language:m,title:p}=e,{codeStyle:f}=(0,l.V)(),{exceedsSizeLimit:h}=(0,r.y)(s),g="code-block__code !my-0 !p-0 !rounded-none !text-sm !leading-relaxed";return(0,a.jsxs)("div",{className:(0,o.A)("flex flex-col gap-3 p-3 bg-bg-100 rounded-md",t),children:[(0,a.jsx)(u,{language:m,title:p}),h?(0,a.jsx)(n.R,{code:s,codeClassName:(0,o.A)(g,"-px-3")}):(0,a.jsx)(d.A,{className:g,codeTagProps:c,language:m,PreTag:"div",style:f,renderer:i.G,wrapLongLines:!0,children:s})]})},u=e=>{let{language:t,title:s}=e;return(0,a.jsx)("div",{className:"flex justify-between items-center h-3",children:(0,a.jsx)("p",{className:(0,o.A)("text-text-300 text-[0.6875rem]",s?"font-ui font-medium":"font-mono font-[450]"),children:s||t})})}},44e3:(e,t,s)=>{s.d(t,{F:()=>i});var a=s(87087);let n={sm:"(min-width: 640px)",md:"(min-width: 768px)",lg:"(min-width: 1024px)",xl:"(min-width: 1280px)","2xl":"(min-width: 1536px)"};function i(e){return(0,a.U)(n[e])}},45318:(e,t,s)=>{s.d(t,{z:()=>m});var a=s(2348),n=s(54568),i=s(59922),l=s(37541),r=s(28044),o=s(72902),d=s(91755);function c(){let e=(0,a._)(["\n  from-bg-100\n  via-bg-100\n  via-65%\n  to-bg-100/0\n  pointer-events-none\n  absolute\n  inset-0\n  -bottom-5\n  z-[-1]\n  bg-gradient-to-b\n  blur-sm\n"]);return c=function(){return e},e}let u=i.J.div(c());function m(e){let{children:t,className:s,contentClassName:a,sticky:i,fixed:c,mdTitle:m,large:p,narrow:f}=e,{isMobile:h,isExpanded:g}=(0,d.V)(),x=(0,r.V)(l.E_),C=!t&&!m,v=p&&!x;return(0,n.jsxs)("header",{className:(0,o.A)("flex w-full bg-bg-100",i&&"sticky top-0 z-header",c&&"fixed top-0 z-header",x?l.X_:"h-12",x&&[!g&&"pl-[133px]",!C&&l.zo],v&&["mx-auto md:h-24 md:items-end",f?"max-w-4xl":"max-w-7xl"],s),"aria-hidden":C,"data-testid":"page-header",children:[!x&&(i||c)&&(0,n.jsx)(u,{}),(0,n.jsx)("div",{className:(0,o.A)("flex w-full items-center justify-between gap-4",x&&g&&"lg:px-4",!x&&"pl-11 lg:px-8",x&&!(h&&g)&&"draggable","",a,v?"px-4 md:px-8":"pr-3"),children:m?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:(0,o.A)("text-text-200 flex items-center gap-2 text-center max-md:hidden min-w-0",x?"font-medium leading-tight":"font-heading",!x&&(v?"text-2xl":"text-lg")),children:(0,n.jsx)("span",{className:"truncate",children:m})}),(0,n.jsx)("div",{}),t]}):t})]})}},48321:(e,t,s)=>{s.d(t,{J:()=>n,y:()=>i});var a=s(78458);function n(e,t){let{filepath:s,orgUuid:n,source:i}=e,l=s.replace("computer://","");t.track({event_key:"wiggle.file.downloaded",...(0,a.k)({filePath:s,isShared:e.isShared,conversationUuid:e.isShared?void 0:e.conversationUuid,snapshotUuid:e.isShared?e.snapshotUuid:void 0,source:i})});let r=document.createElement("form");r.method="GET",r.action=e.isShared?"/api/organizations/".concat(n,"/snapshots/").concat(e.snapshotUuid,"/wiggle/download-file"):"/api/organizations/".concat(n,"/conversations/").concat(e.conversationUuid,"/wiggle/download-file"),r.style.display="none";let o=document.createElement("input");o.type="hidden",o.name="path",o.value=l,r.appendChild(o),document.body.appendChild(r),r.submit(),document.body.removeChild(r)}function i(e,t){let{filepaths:s,orgUuid:a,source:n}=e,i=s.map(e=>e.replace("computer://","")).filter(t=>!e.isShared||t.startsWith("/mnt/user-data/"));t.track({event_key:"wiggle.file.downloaded_all",file_count:i.length,is_snapshot:e.isShared,source:n,conversation_uuid:e.isShared?null:e.conversationUuid,snapshot_uuid:e.isShared?e.snapshotUuid:null});let l=document.createElement("form");l.method="GET",l.action=e.isShared?"/api/organizations/".concat(a,"/snapshots/").concat(e.snapshotUuid,"/wiggle/download-files"):"/api/organizations/".concat(a,"/conversations/").concat(e.conversationUuid,"/wiggle/download-files"),l.style.display="none",i.forEach(e=>{let t=document.createElement("input");t.type="hidden",t.name="paths",t.value=e,l.appendChild(t)}),document.body.appendChild(l),l.submit(),document.body.removeChild(l)}},53270:(e,t,s)=>{s.d(t,{_:()=>z});var a=s(54568),n=s(69104),i=s(74813),l=s(64328),r=s(35984),o=s(89626),d=s(23812),c=s(17321),u=s(68067),m=s(28044),p=s(77795),f=s(94229),h=s(51944),g=s(69841),x=s(5231),C=s(90448),v=s(56641),j=s(72902),b=s(7620),y=s(10369),w=s(59666),_=s(22167),k=s(4887),N=s(27769),M=s(85239),S=s(48321),A=s(78418),E=s(71196);function z(e){let{file:t,conversationUuid:s,onOpen:z,isInSidebar:T=!1,isShared:L}=e,{activeOrganization:R}=(0,l.YL)(),I=(0,i.st)(),U=(0,y.A)(),[O,F]=(0,b.useState)(null),[D,P]=(0,b.useState)(!1),B=(0,m.V)(),G=(0,u.fS)("wiggle_desktop_integration"),W=(0,_.kO)(),V=(0,u.fS)("claudeai_skill_artifact_integration");(0,b.useEffect)(()=>{let e=!0;if(B&&(null===c.Q2||void 0===c.Q2?void 0:c.Q2.whichApplication)&&G)return c.Q2.whichApplication(t.path).then(t=>{e&&F(t)}),()=>{e=!1}},[G,t.path,B]);let{addError:q}=(0,r.Y)(),H=(0,N.Ud)(t.name),Y={code:{IconComponent:f.l,label:(0,a.jsx)(w.A,{defaultMessage:"Code",id:"G8PgU8iXdR",description:"A label for a category of filetypes"}),isPreviewable:!0},table:{IconComponent:h.K,label:(0,a.jsx)(w.A,{defaultMessage:"Table",id:"o1Bm9Seua1",description:"A label for a category of filetypes"}),isPreviewable:!0},spreadsheet:{IconComponent:h.K,label:(0,a.jsx)(w.A,{defaultMessage:"Spreadsheet",id:"WeEn8OTS2e",description:"A label for a category of filetypes"}),isPreviewable:!0},doc:{IconComponent:g.d,label:(0,a.jsx)(w.A,{defaultMessage:"Document",id:"86Gv/DR1uA",description:"A label for a category of filetypes"}),isPreviewable:!0},image:{IconComponent:x.x,label:(0,a.jsx)(w.A,{defaultMessage:"Image",id:"8mG9Cg7ges",description:"A label for a category of filetypes"}),isPreviewable:!0},diagram:{IconComponent:v.n,label:(0,a.jsx)(w.A,{defaultMessage:"Diagram",id:"HDIA+OJNvT",description:"A label for a category of filetypes"}),isPreviewable:!0},preso:{IconComponent:C.Z,label:(0,a.jsx)(w.A,{defaultMessage:"Presentation",id:"KUNdHQwOKr",description:"A label for a category of filetypes"}),isPreviewable:!1},skill:{IconComponent:o.xPp,label:null,isPreviewable:!1}},{IconComponent:J,label:K}=H?Y[H]:{IconComponent:p.o,label:null},{displayName:X,displayExt:Z}=(0,N.FT)(t),Q=(0,a.jsxs)(a.Fragment,{children:[K,K&&Z&&(0,a.jsx)("span",{className:"opacity-50",children:" \xb7 "}),Z]}),$=!T&&!L&&(0,M.z)(t.path,W);return(0,a.jsx)(n.d,{icon:(0,a.jsx)(J,{size:20,weight:"light",className:"text-text-500"}),properties:{id:t.path,title:X||t.name},isStreaming:!1,className:(0,j.A)(T&&"!m-0"),displayType:Q,actions:(0,a.jsxs)("div",{className:"flex min-w-0 items-center justify-center gap-2 shrink-0",children:[$&&(0,a.jsx)(A.M,{file:t,conversationUuid:s,source:"wiggle_card",variant:"secondary",size:"icon",className:"!rounded-lg"}),!T&&!L&&V&&(0,a.jsx)(E.a,{file:t,conversationUuid:s,source:"wiggle_artifact_card",variant:"secondary",size:"default",className:"!rounded-lg"}),B&&(null===c.Q2||void 0===c.Q2?void 0:c.Q2.writeFileDownloadAndOpen)&&G?(0,a.jsx)(d.$,{"aria-label":U.formatMessage({id:"JfG49wNHKP",defaultMessage:"Open"}),variant:T?"ghost":"secondary",loading:D,onClick:e=>{if(e.preventDefault(),e.stopPropagation(),!(null==R?void 0:R.uuid))return;let a=t.path.split("/");P(!0);let n=(0,k.T)(L?{organizationUuid:R.uuid,snapshotUuid:s,filePath:t.path.replace(/^computer:\/\//,""),isShared:!0}:{organizationUuid:R.uuid,conversationUuid:s,filePath:t.path.replace(/^computer:\/\//,""),isShared:!1});c.Q2.writeFileDownloadAndOpen(a[a.length-1],new URL(n,window.location.href).href).catch(()=>{q(U.formatMessage({defaultMessage:"Failed to download and open file",id:"cxAbUvhHjJ"}),{messageForLogging:"Failed to download and open file"})}).then(()=>{P(!1)})},size:T?"icon":"default",prepend:!T&&O&&O.appIconBase64&&(0,a.jsx)("img",{src:O.appIconBase64,height:20,width:20,alt:U.formatMessage({defaultMessage:"Open file on desktop",id:"7tjfei6CPJ"})}),children:T?(0,a.jsx)(o.vdG,{size:16,className:"text-text-400"}):O?(0,a.jsx)(w.A,{id:"AsiqC3lr7Z",defaultMessage:"Open in {appName}",values:{appName:O.appName}}):(0,a.jsx)(w.A,{id:"JfG49wNHKP",defaultMessage:"Open"})}):(0,a.jsx)(d.$,{"aria-label":U.formatMessage({id:"5q3qC0sC3r",defaultMessage:"Download"}),variant:T?"ghost":"secondary",onClick:e=>{e.preventDefault(),e.stopPropagation(),(null==R?void 0:R.uuid)&&(0,S.J)(L?{filepath:t.path,orgUuid:R.uuid,snapshotUuid:s,isShared:!0,source:"wiggle_card_download_button"}:{filepath:t.path,orgUuid:R.uuid,conversationUuid:s,isShared:!1,source:"wiggle_card_download_button"},I)},size:T?"icon":"default",children:T?(0,a.jsx)(o.f5X,{size:16,className:"text-text-400"}):(0,a.jsx)(w.A,{id:"5q3qC0sC3r",defaultMessage:"Download"})})]}),onOpenArtifact:z},t.path)}},57958:(e,t,s)=>{s.d(t,{wD:()=>U,z7:()=>I});var a=s(54568),n=s(91640),i=s.n(n),l=s(1613),r=s(64328),o=s(48252),d=s(16256),c=s(68067),u=s(95617),m=s(18868),p=s(90361),f=s(72902),h=s(61295),g=s(39109),x=s(7620),C=s(10369),v=s(59666),j=s(24407),b=s(23812),y=s(3075),w=s(84617),_=s(61970),k=s(85705),N=s(19920),M=s(54671),S=s(94629),A=s(3424);function E(e){let{onCancel:t,onConfirm:s}=e,n=(0,x.useRef)(null),{menuOptions:i,getEnabledRemoteTools:l}=(0,S.$3)(),r=(0,A.Cn)({setMcpDirectoryModalIsOpen:z,setStyleModalOpenWithScreen:z,setCreateProjectModalIsOpen:z,setGithubModalIsOpen:z,setGmailAuthModalIsOpen:z,setCreatePromptArgumentModalIsOpen:z}),o=(0,M._9)({actions:r,inputMenuIsOpen:!0,setInputMenuIsOpen:()=>void 0,rootItems:i,menuType:"research"});return(0,x.useEffect)(()=>{setTimeout(()=>{n.current&&n.current.focus()})},[]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(y.aF,{isOpen:!0,modalSize:"2lg",onClose:t,children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:(0,a.jsx)(v.A,{defaultMessage:"Enable connectors for Claude to use in research",id:"bnGGwdCceV"})}),(0,a.jsx)("div",{className:"border border-border-300 rounded-lg",children:(0,a.jsxs)("div",{className:"p-2",children:[o.path&&(0,a.jsx)(N.s,{path:o.path,inputMenuSearchQuery:o.inputMenuSearchQuery,setInputMenuSearchQuery:o.setInputMenuSearchQuery,handleBack:o.handleBack}),(0,a.jsx)("div",{className:"space-y-1",children:o.menuView.currentItems.filter(e=>{let{menuItemHidden:t}=e;return!t}).map(e=>(0,a.jsx)(k.$,{item:e,onClick:()=>o.handleClickItem(e),isHighlighted:o.highlightedItemKey===e.key},e.key))})]})}),(0,a.jsx)("div",{className:"bg-bg-300 border-border-400 border px-4 py-3 rounded-lg text-sm text-text-300",children:(0,a.jsx)(v.A,{defaultMessage:"Ensure you have appropriate permissions and trust third-party tools before continuing. <link>Learn more</link> about safely using research with connected apps.",id:"VU67M+9esK",values:{link:e=>(0,a.jsx)(w.Y,{href:"https://support.anthropic.com/",target:"_blank",rel:"noreferrer noopener",children:e})}})}),(0,a.jsxs)("div",{className:"flex flex-row justify-end gap-2",children:[(0,a.jsx)(b.$,{variant:"secondary",onClick:t,children:(0,a.jsx)(v.A,{defaultMessage:"Cancel Research",id:"GuxgLirKvY"})}),(0,a.jsxs)(b.$,{ref:n,onClick:function(){s({tools:l()})},children:[(0,a.jsx)(v.A,{defaultMessage:"Confirm",id:"N2IrpMDHDB"}),(0,a.jsx)("span",{className:"inline-block ml-2 p-1 bg-bg-000/20 rounded-sm",children:(0,a.jsx)(_.y,{size:12})})]})]})]})})})}function z(){}var T=s(18849),L=s(58841),R=s(37080);let I=j.z.preprocess(e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e},j.z.object({task_id:j.z.string()}));function U(e){let{toolUseId:t,isFirstBlockOfMessage:s=!1,isLastBlockOfMessage:n=!1,conversationUuid:i,toolResult:o,isShared:d,isExpanded:m=!1,isStreaming:p=!1,context:h}=e,g=(0,c.fS)("papi_mcp"),{activeOrganization:v}=(0,r.YL)(),{dispatchChatResource:j}=(0,L.i)(),{setIsDrawerExpanded:b}=(0,T.x)(),{decisionState:y,approveTool:w,denyTool:_}=function(e,t,s,a){let[n,i]=(0,x.useState)("pending"),r=!!(e&&t&&a),{isPending:o}=(0,l.Sk)("/api/organizations/".concat(e,"/chat_conversations/").concat(t,"/tool_approval_state/").concat(s),{enabled:r}),d=(0,l.L2)("/api/organizations/".concat(e,"/chat_conversations/").concat(t,"/tool_approval"),"POST",{enabled:!!(t&&!o),onSuccess(e,t){i(t.is_approved?"approved":"denied")}}).mutate;return{decisionState:n,isStatePending:o,approveTool:(0,x.useCallback)(e=>{let{tools:t}=e;d({tool_use_id:s,is_approved:!0,params:{tools:t}})},[d,s]),denyTool:(0,x.useCallback)(()=>{d({tool_use_id:s,is_approved:!1,params:{disapproval_reason:"user_canceled"}})},[d,s])}}(null==v?void 0:v.uuid,i,t,p),k=p?"approved"===y:o&&!(null==o?void 0:o.is_error),N=g&&(null==h?void 0:h.tools.length)&&p&&"pending"===y,M=(0,x.useMemo)(()=>{if(!(null==o?void 0:o.content))return;let e=o.content.map(e=>e&&"text"in e?e.text:"").join("\n"),{data:t}=I.safeParse(e);return null==t?void 0:t.task_id},[null==o?void 0:o.content]),{compassStatus:S,isLoading:A,error:z}=(0,R.CH)({organizationUuid:null==v?void 0:v.uuid,conversationUuid:i,taskId:M,isShared:d,enabled:k});(0,R.IK)(i,null==S?void 0:S.status);let U=!S,O=(0,x.useCallback)(()=>{U||(b(!0),j({type:"OPEN_COMPASS_STATUS",data:{conversationUuid:i,organizationUuid:null==v?void 0:v.uuid,isShared:d,toolUseId:null==o?void 0:o.tool_use_id,taskId:M}}))},[U,j,i,null==v?void 0:v.uuid,b,d,o,M]),P=(null==S?void 0:S.status)||u.zu.Starting,B=!!z||!!(null==o?void 0:o.is_error),G=(0,C.A)(),{title:W,subtitle:V}=(0,x.useMemo)(()=>{let e,t;if(B){var s,a;return(null==o?void 0:o.is_error)&&((null==o?void 0:o.message)==="user_canceled"||(null==o||null==(s=o.content)?void 0:s.some(e=>(null==e?void 0:e.type)==="text"&&(null==e?void 0:e.text)==="Denied.")))?{title:G.formatMessage({defaultMessage:"Stopped",id:"1LBny5MvRa"}),subtitle:G.formatMessage({defaultMessage:"At your request",id:"2n0LtR1+bC"})}:(null==o?void 0:o.is_error)&&((null==o?void 0:o.message)==="approval_timeout"||(null==o||null==(a=o.content)?void 0:a.some(e=>(null==e?void 0:e.type)==="text"&&(null==e?void 0:e.text)==="No approval received.")))?{title:G.formatMessage({defaultMessage:"Stopped",id:"1LBny5MvRa"}),subtitle:G.formatMessage({defaultMessage:"No response on which connectors to enable during research",id:"HZp4wEGqGR"})}:{title:G.formatMessage({defaultMessage:"Something went wrong",id:"JqiqNj0Ooi"})}}let n=(null==S?void 0:S.total_sources)||0,i=0===n?G.formatMessage({defaultMessage:"Searching for sources...",id:"+4r/aaeR9v"}):G.formatMessage({defaultMessage:"{count, plural, one {# source} other {# sources}} and counting...",id:"wfqjY4cYXF"},{count:n}),l=G.formatMessage({defaultMessage:"{count, plural, one {# source} other {# sources}}",id:"WrpI57Uej/"},{count:n}),r=(0,R.Ui)(S),d=r||G.formatMessage({defaultMessage:"Researching...",id:"eD084+/kcH"}),c=r||G.formatMessage({defaultMessage:"Research complete",id:"9Tbl1w5GjC"});switch(P){case u.zu.Starting:{let t=[G.formatMessage({defaultMessage:"Getting everything ready...",id:"5nJVpwt8gP"}),G.formatMessage({defaultMessage:"Preparing your research assistant...",id:"vxRKHhLIWM"}),G.formatMessage({defaultMessage:"Initializing research tools...",id:"Lm6wYLrJ1Q"}),G.formatMessage({defaultMessage:"Setting up my research space...",id:"EGN8CB7IRt"}),G.formatMessage({defaultMessage:"Configuring research parameters...",id:"eYoO3vRQgY"}),G.formatMessage({defaultMessage:"Loading research capabilities...",id:"GHM/w3WPnr"}),G.formatMessage({defaultMessage:"Preparing to dive in...",id:"EW22N+F8aq"}),G.formatMessage({defaultMessage:"Setting the stage for discovery...",id:"l8a+mVgI7N"}),G.formatMessage({defaultMessage:"Getting your assistant ready...",id:"GLpbkAPwDC"}),G.formatMessage({defaultMessage:"Activating research mode...",id:"SPBnT2clve"}),G.formatMessage({defaultMessage:"Warming up the engines...",id:"biUnCTBtnQ"})],s=Math.floor(Math.random()*t.length);e=t[s];break}case u.zu.Planning:e=d,t=G.formatMessage({defaultMessage:"Creating my research plan...",id:"4eRg5buC9J"});break;case u.zu.InitiatingAgents:e=d,t=G.formatMessage({defaultMessage:"Searching for sources...",id:"+4r/aaeR9v"});break;case u.zu.Searching:e=d,t=i;break;case u.zu.CreatingArtifact:e=d,t=G.formatMessage({defaultMessage:"Writing and citing report...",id:"2b/CKxnAiJ"});break;case u.zu.Completed:t=l,e=c;break;case u.zu.Cancelled:e=d,t=G.formatMessage({defaultMessage:"Interrupted",id:"rJQDmlVOoX"});break;case u.zu.TimedOut:case u.zu.Failed:e=G.formatMessage({defaultMessage:"Something went wrong",id:"JqiqNj0Ooi"})}return{title:e,subtitle:t}},[G,P,S,B,null==o?void 0:o.is_error,null==o?void 0:o.message,null==o?void 0:o.content]);return N?(0,a.jsx)(E,{onCancel:_,onConfirm:e=>{let{tools:t}=e;w({tools:t})}}):(0,a.jsx)("div",{className:(0,f.A)("my-3",s?"mt-2":"mt-3",n?"mb-2":"mb-3"),children:A?(0,a.jsxs)("div",{className:"w-full p-4 text-text-000 font-ui rounded-xl border border-border-300 shadow-xs",children:[(0,a.jsx)("div",{className:"h-5 bg-bg-300/30 rounded-md w-3/4"}),(0,a.jsx)("div",{className:"flex text-text-300 text-xs items-center mt-2",children:(0,a.jsx)("div",{className:"h-5 bg-bg-300/30 rounded-md w-24"})})]}):(0,a.jsxs)("button",{className:(0,f.A)("transition-[border] duration-300 w-full p-4 !pt-0 text-text-000 font-ui rounded-xl border shadow-xs overflow-hidden",!U&&"cursor-pointer hover:shadow-sm hover:bg-bg-000/50 hover:border-border-200",m?"!border-accent-secondary-200":"border-border-300"),disabled:U,onClick:O,children:[(0,a.jsx)(F,{title:W,compassStatus:S,useShimmer:P===u.zu.Starting,isError:B||P===u.zu.Failed||P===u.zu.TimedOut,isExpanded:m}),(0,a.jsx)(D,{subtitle:V,compassStatus:S,isError:P===u.zu.Cancelled,useShimmer:!m&&!!S&&![u.zu.CreatingArtifact,u.zu.Completed,u.zu.Cancelled,u.zu.TimedOut,u.zu.Failed].includes(S.status)})]})})}function O(e){let{className:t,text:s,useShimmer:n}=e,[l,r]=(0,x.useState)(s),[d,c]=(0,x.useState)(!1),[u,m]=(0,x.useState)("");return(0,x.useEffect)(()=>{if(s!==l){m(l),r(s),c(!0);let e=setTimeout(()=>{c(!1)},300);return()=>clearTimeout(e)}},[s,l]),(0,a.jsxs)("div",{title:l,className:"jsx-34e91f3cef6c43c9 "+((0,f.A)("relative overflow-hidden",t)||""),children:[(0,a.jsx)(i(),{id:"34e91f3cef6c43c9",children:"@keyframes slideUpFadeOut{0%{transform:translatey(0);opacity:1}100%{transform:translatey(-100%);opacity:0}}@keyframes slideUpFadeIn{0%{transform:translatey(100%);opacity:0}100%{transform:translatey(0);opacity:1}}"}),d&&(0,a.jsx)("div",{style:{animation:"slideUpFadeOut 300ms forwards"},className:"jsx-34e91f3cef6c43c9 absolute w-full text-ellipsis overflow-hidden whitespace-nowrap text-left",children:n?(0,a.jsx)(o.N,{children:u}):u}),(0,a.jsx)("div",{style:d?{animation:"slideUpFadeIn 300ms forwards"}:void 0,className:"jsx-34e91f3cef6c43c9 w-full relative text-ellipsis overflow-hidden whitespace-nowrap text-left",children:n?(0,a.jsx)(o.N,{children:l}):l})]})}function F(e){let{title:t,isError:s,compassStatus:n,useShimmer:i,isExpanded:l}=e,[r,o]=(0,x.useState)(!1),c=(0,R.Nw)(n),u=(0,x.useRef)(c);(0,x.useEffect)(()=>{c&&!u.current&&(o(!0),setTimeout(()=>{o(!1)},3.5*c.length+.5),u.current=c)},[c]);let C=!l&&r;return(0,a.jsxs)("div",{className:"flex flex-row justify-between items-center h-9 gap-4 relative",children:[(0,a.jsxs)("div",{className:"h-9 min-w-0 w-full",children:[C&&!!c&&(0,a.jsx)(h.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:(0,a.jsx)(P,{thought:c})}),(0,a.jsx)(g.N,{initial:!1,children:!(C&&c)&&(0,a.jsxs)(h.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5,ease:d.A.inOutQuart},className:(0,f.A)("absolute w-[calc(100%-1.75rem)] top-0 left-0 flex items-center rounded-lg text-sm min-w-0 mt-4",s?"text-danger-000":""),children:[s&&(0,a.jsx)(m.N,{className:"text-danger-000 mr-1 flex-shrink-0",size:16}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden text-left text-ellipsis break-words text-nowrap",children:(0,a.jsx)(O,{text:t,useShimmer:!!i&&!s})})]})})]}),!!n&&(0,a.jsx)(p.K,{size:12,className:"text-text-500 mt-4"})]})}function D(e){var t,s;let{subtitle:n,isError:i,compassStatus:l,useShimmer:r}=e,o=(0,x.useMemo)(()=>(null==l?void 0:l.agents)&&!(l.agents.length<1)?(0,R.mk)({agents:l.agents,n:3}):[],[null==l?void 0:l.agents]);return n?(0,a.jsxs)("div",{className:"flex text-text-300 text-xs items-center mt-2 tabular-nums h-5",children:[!!o.length&&(0,a.jsx)("div",{className:"flex-shrink-0 mr-1",children:(0,a.jsx)(R.mq,{hrefs:o})}),(null==l?void 0:l.status)===u.zu.Completed&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.A,{defaultMessage:"Research complete",id:"9Tbl1w5GjC"}),(0,a.jsx)("span",{className:"text-[0.4rem] mx-1 text-[#A29F95]",children:"â€¢"})]}),(0,a.jsx)(O,{text:n,useShimmer:r,className:i?"text-danger-000":""}),!!(null==l?void 0:l.started_at)&&l.status!==u.zu.Cancelled&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-[0.4rem] mx-1 text-[#A29F95]",children:"â€¢"}),(0,a.jsx)("div",{className:"text-text-500",children:(0,a.jsx)(R.YE,{startedAt:null!=(t=null==l?void 0:l.started_at)?t:null,completedAt:null!=(s=null==l?void 0:l.finished_at)?s:null})})]})]}):null}function P(e){let{thought:t}=e;return(0,a.jsx)("div",{className:"h-9 w-full",children:(0,a.jsx)("div",{className:"blur-[2px] h-11 px-1 -mx-1 -mb-2 w-full relative overflow-y-hidden overflow-x-visible [mask-image:linear-gradient(to_top,_hsl(var(--always-black)/0%)_0%,hsl(var(--always-black)/100%)_75%,_hsl(var(--always-black)/0%)_100%)]",children:(0,a.jsx)(h.P.div,{className:"absolute top-0 left-1 right-0 text-left",initial:{y:40},animate:{y:"calc(-100%)"},transition:{delay:.5,duration:3.5*t.length/1e3,ease:d.A.inOutBase},children:(0,a.jsx)(R.GT,{thought:t})})})})}},60516:(e,t,s)=>{s.d(t,{E:()=>m,Hg:()=>d,KG:()=>p,Lr:()=>g,ZH:()=>h,gT:()=>c,vn:()=>u,zZ:()=>o});var a=s(1613),n=s(64328),i=s(4869),l=s(7620);let r="notificationPreferences";var o=function(e){return e.FCM="FCM",e.APNS="APNS",e}({});let d=()=>{let{activeOrganization:e}=(0,n.YL)(),t=null==e?void 0:e.uuid;return(0,a.Sk)("/api/organizations/".concat(t,"/notification/preferences"),{queryKey:[r,{orgUuid:t}],enabled:!!t})},c=()=>{let{activeOrganization:e}=(0,n.YL)(),t=null==e?void 0:e.uuid,s=(0,i.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(t,"/notification/preferences"),"PUT",{onSuccess:()=>{s.invalidateQueries({queryKey:[r,{orgUuid:t}]})}})},u=()=>{let{activeOrganization:e}=(0,n.YL)(),t=null==e?void 0:e.uuid,s=(0,i.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(t,"/notification/preferences"),"PATCH",{onSuccess:()=>{s.invalidateQueries({queryKey:[r,{orgUuid:t}]})}})},m=()=>{let{activeOrganization:e}=(0,n.YL)(),t=null==e?void 0:e.uuid,s=(0,i.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(t,"/notification/channels"),"POST",{onSuccess:()=>{s.invalidateQueries({queryKey:["notificationChannels",{orgUuid:t}]})},meta:{noToast:!0}})},p=e=>{var t,s,a;let{data:n}=d();return(null==n||null==(a=n.preferences)||null==(s=a.feature_preference)||null==(t=s[e])?void 0:t.enable_push)===!0},f=["bogosort","compass","completion"],h=()=>{var e;let{data:t}=d(),s=null!=(e=null==t?void 0:t.preferences.feature_preference)?e:{};return f.every(e=>{let t=s[e];return(null==t?void 0:t.enable_push)===!0})},g=()=>{let{data:e}=d(),{mutateAsync:t}=c();return(0,l.useCallback)(async function(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f,n=(null==e?void 0:e.preferences)||{},i={...n.feature_preference};for(let e of a){var l,r;i[e]={...i[e],enable_push:s,enable_email:null!=(r=null==(l=i[e])?void 0:l.enable_email)&&r}}await t({preferences:{...n,feature_preference:i}})},[e,t])}},62210:(e,t,s)=>{s.d(t,{NG:()=>f,Wk:()=>h,aO:()=>p,oE:()=>m,y$:()=>u});var a=s(34003),n=s(1613),i=s(64328),l=s(16178),r=s(80688),o=s(4869),d=s(81562);function c(e){return{skillId:e.id,skillName:e.name,skillDescription:e.description,creatorType:e.creator_type,updatedAt:e.updated_at,enabled:e.enabled}}let u=()=>{let{activeOrganization:e}=(0,i.YL)(),t=null==e?void 0:e.uuid,s=(0,a.JO)();return(0,n.Sk)("/api/organizations/".concat(t,"/skills/list-skills"),{queryKey:[r.Gm,t],enabled:!!t&&s},e=>({skills:e.skills.map(c).sort((e,t)=>{if("user"===e.creatorType&&"anthropic"===t.creatorType)return -1;if("anthropic"===e.creatorType&&"user"===t.creatorType)return 1;if("user"===e.creatorType&&"user"===t.creatorType){let s=e.updatedAt?new Date(e.updatedAt).getTime():0;return(t.updatedAt?new Date(t.updatedAt).getTime():0)-s}return e.skillName.localeCompare(t.skillName)})}))},m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:t}=(0,i.YL)(),s=null==t?void 0:t.uuid,a=(0,o.useQueryClient)(),u=(0,n.mn)();return(0,d.useMutation)({mutationFn:async e=>{let t=new URLSearchParams({overwrite:"true"===e.get("overwrite")?"true":"false"}),a=await u("/api/organizations/".concat(s,"/skills/upload-skill?").concat(t),{method:"POST",body:e});if(!a.ok){let e=await a.json();throw(0,l.a5)({status:a.status,response:e,fallbackMessage:"Failed to upload skill"})}let n=await a.json();return"validation_errors"in n?{skill:0===n.validation_errors.length?c(n.skill):null,validationErrors:n.validation_errors}:{skill:c(n),validationErrors:[]}},...e,onSuccess:async function(){for(var t,n=arguments.length,i=Array(n),l=0;l<n;l++)i[l]=arguments[l];await a.invalidateQueries({queryKey:[r.Gm,s]}),await (null==(t=e.onSuccess)?void 0:t.call(e,...i))}})},p=e=>{let{activeOrganization:t}=(0,i.YL)(),s=null==t?void 0:t.uuid;return(0,n.Qv)("/api/organizations/".concat(s,"/skills/enable-skill"),"POST",(e,t)=>{let{skillId:s}=e;return t?{...t,skills:t.skills.map(e=>e.skillId===s?{...e,enabled:!0}:e)}:void 0},{queryKey:[r.Gm,s],transformVariables:e=>{let{skillId:t}=e;return{skill_id:t}},meta:{noToast:!0},onError:e.onError})},f=e=>{let{activeOrganization:t}=(0,i.YL)(),s=null==t?void 0:t.uuid;return(0,n.Qv)("/api/organizations/".concat(s,"/skills/disable-skill"),"POST",(e,t)=>{let{skillId:s}=e;return t?{...t,skills:t.skills.map(e=>e.skillId===s?{...e,enabled:!1}:e)}:void 0},{queryKey:[r.Gm,s],transformVariables:e=>{let{skillId:t}=e;return{skill_id:t}},meta:{noToast:!0},onError:e.onError})},h=e=>{let{activeOrganization:t}=(0,i.YL)(),s=null==t?void 0:t.uuid,a=(0,o.useQueryClient)();return(0,n.L2)("/api/organizations/".concat(s,"/skills/delete-skill"),"POST",{transformVariables:e=>{let{skillId:t}=e;return{skill_id:t}},meta:{noToast:!0},onError:e.onError,onSuccess:async()=>{await a.invalidateQueries({queryKey:[r.Gm,s]})}})}},65018:(e,t,s)=>{s.d(t,{I:()=>n,q:()=>i});var a=s(7620);let n=(0,a.createContext)(null),i=()=>{let e=(0,a.useContext)(n);if(!e)throw Error("useReplExecutionSandbox must be used within a ReplExecutionSandboxContextProvider");return e}},68616:(e,t,s)=>{s.d(t,{Dr:()=>E,Hz:()=>A,L_:()=>M,_L:()=>N,gy:()=>z});var a=s(54568),n=s(6542),i=s(74813),l=s(44995),r=s(13750),o=s(89626),d=s(23812),c=s(3075),u=s(84617),m=s(67453),p=s(64371),f=s(47592),h=s(68067),g=s(72902),x=s(20795),C=s.n(x),v=s(32536),j=s(19664),b=s.n(j),y=s(7620),w=s(59666),_=s(10369);let k=e=>{let{artifact:t,selectedVersion:s,messageUuid:r,isOpen:o,richSandboxRef:d,copyToClipboard:c}=e,{track:u}=(0,i.st)(),{publishedArtifactsBaseUrl:m}=(0,l._r)(),{mutateAsync:p,isPending:f}=(0,n.yx)(),[h,g]=(0,y.useState)(),x=(0,y.useCallback)(async()=>{var e;let t=await (null==(e=d.current)?void 0:e.getScreenshot());t&&g(t)},[d]);return(0,y.useEffect)(()=>{o&&d.current&&x()},[d,o,x]),(0,a.jsx)(N,{canScreenshot:!0,title:t.title,isLoading:f,screenshot:h,fetchScreenshot:x,setScreenshot:g,handlePublishArtifact:()=>{var e;p({title:t.title,artifact_type:t.type,code_language:t.language,message_uuid:r,artifact_identifier:t.id,content:null!=(e=t.versions[s].resultState)?e:"",screenshot:h,artifact_version_uuid:t.versions[s].uuid}).then(e=>{let{published_artifact_uuid:t}=e;return c("".concat(m,"/public/artifacts/").concat(t))}),u({event_key:"artifact.publish.modal.publish_button_clicked",message_uuid:r,artifact_type:null==t?void 0:t.type,artifact_language:null==t?void 0:t.language})}})};function N(e){let{canScreenshot:t,title:s,isLoading:n,screenshot:i,fetchScreenshot:l,setScreenshot:r,handlePublishArtifact:c}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-text-400 flex flex-col gap-3 py-3",children:(0,a.jsx)("p",{children:(0,a.jsx)(w.A,{defaultMessage:"Publishing this Artifact will make it accessible to anyone on the internet and potentially visible in search engine results. Your chat will remain private.",id:"zG4O5rdNXZ"})})}),(0,a.jsxs)("div",{className:"border-0.5 border-border-300 text-text-100 flex flex-col sm:flex-row gap-4 rounded-xl py-3 pl-3 pr-5 items-center",children:[t?(0,a.jsxs)("div",{className:"relative group w-[160px] h-[84px]",children:[(0,a.jsxs)("div",{className:"rounded-lg overflow-hidden shrink-0 relative w-full h-full",children:[i?(0,a.jsx)("img",{src:i,alt:s,className:"w-full h-auto bg-always-white"}):(0,a.jsx)(v.default,{src:"/images/claude_ogimage.png",alt:s,className:"w-full h-auto",width:1138,height:640}),!i&&(0,a.jsx)(L,{handleCapture:()=>void l()})]}),i&&(0,a.jsx)("div",{className:"absolute top-0 right-0 translate-x-1/4 -translate-y-1/4 hidden group-hover:block",children:(0,a.jsx)(T,{handleRemove:()=>r(void 0)})})]}):null,(0,a.jsx)("div",{children:null!=s?s:(0,a.jsx)(w.A,{defaultMessage:"Claude Artifact",id:"l6aMQuX1m4"})})]}),(0,a.jsxs)("div",{className:"bg-bg-300 text-text-300 mt-3 flex gap-3 rounded-xl px-4 py-3 text-sm leading-normal",children:[(0,a.jsx)(o.R2D,{size:16,className:"mt-0.5 shrink-0"}),(0,a.jsx)("span",{children:(0,a.jsx)(w.A,{defaultMessage:"Anthropicâ€™s <link>Usage Policy</link> prohibits use of Claude for harmful use cases like producing violent, abusive, or deceptive content. Donâ€™t share personal information or third-party content without permission.",id:"3BDMxIIlWR",values:{link:e=>(0,a.jsx)(u.Y,{href:"https://www.anthropic.com/legal/aup",target:"_blank",children:e})}})})]}),(0,a.jsx)("div",{className:"mt-3 flex w-full items-center justify-end gap-2",children:(0,a.jsx)(d.$,{size:"lg",loading:n,onClick:c,children:(0,a.jsx)(w.A,{defaultMessage:"Publish & copy link",id:"q8Svey6avC"})})})]})}let M=e=>{let{artifactUuid:t,publishedLink:s,onClose:i,onUnpublish:l}=e,{copyToClipboard:r,didCopy:c}=(0,p.C)(),{mutateAsync:u,isPending:m}=(0,n.lT)(t),f=async()=>{await u({}),null==l||l(),i()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"border-0.5 border-border-300 text-text-100 flex flex-col rounded-xl my-3",children:[(0,a.jsxs)("div",{className:"border-b-0.5 border-border-300 flex gap-3 py-3 pl-3 pr-5",children:[(0,a.jsx)("div",{children:(0,a.jsx)(o.qzq,{className:"mt-1",size:16})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h6",{className:"font-medium",children:(0,a.jsx)(w.A,{defaultMessage:"Published (Public)",id:"7G+T0FbG5h"})}),(0,a.jsx)("p",{className:"text-text-300",children:(0,a.jsx)(w.A,{defaultMessage:"Anyone on the web with the link can view the Artifact only. Your chat will remain private.",id:"lJBHtZSUCz"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 py-3 pl-3 pr-5",children:[(0,a.jsx)(b(),{className:"text-text-300 truncate text-sm",href:s,children:s}),(0,a.jsx)("div",{children:(0,a.jsx)(d.$,{variant:"ghost",className:"!text-accent-secondary-000 hover:bg-accent-secondary-900 font-medium",onClick:()=>{r(s)},prepend:c?(0,a.jsx)(o.rAV,{size:16}):(0,a.jsx)(o.Xq1,{size:16}),children:c?(0,a.jsx)(w.A,{defaultMessage:"Link copied",id:"zU/q1NoIdN"}):(0,a.jsx)(w.A,{defaultMessage:"Copy link",id:"lbr3Lq2Lnm"})})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(d.$,{size:"lg",variant:"secondary",loading:m,onClick:f,children:(0,a.jsx)(w.A,{defaultMessage:"Unpublish",id:"VjZ6FKc+ZZ"})}),(0,a.jsxs)("p",{className:"text-text-400 text-xs",children:[(0,a.jsx)(w.A,{defaultMessage:"Once Artifact is unpublished, it cannot be republished.",id:"HKGP87Xpbb"}),(0,a.jsx)("br",{}),(0,a.jsx)(w.A,{defaultMessage:"A new Artifact must be created.",id:"vWfM4LMkFW"})]})]})]})},S=e=>e.split(",").map(e=>e.trim().toLowerCase()).filter(e=>e.length>0);function A(e){let{artifactUuid:t,closeEmbedSettings:s,embedLink:i}=e,l=(0,_.A)(),{mutateAsync:c}=(0,n.eH)(t),{data:u,isSuccess:m}=(0,n.gY)(t),{copyToClipboard:f,didCopy:h}=(0,p.C)(),g='<iframe src="'.concat(i,'" title="Claude Artifact" width="100%" height="600" frameborder="0" allow="clipboard-write" allowfullscreen></iframe>'),[x,v]=(0,y.useState)(""),[j,b]=(0,y.useState)(!1),[k,N]=(0,y.useState)(!1),M=/^(?:(\*\.)?)(?:[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9-]{0,24}[a-z0-9]$/,A=S(x),E=A.filter(e=>!M.test(e)),[z,T]=(0,y.useState)([]),L=!C()(A.toSorted(),z.toSorted());(0,y.useEffect)(()=>{if(u){var e,t;let s=null!=(t=null==(e=u.embed_whitelist)?void 0:e.join(", "))?t:"";v(s),T(S(s))}},[m,u]);let R=async()=>{t&&(await c({embed_whitelist:A}),T(A),N(!0))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("p",{className:"text-text-100 font-base-bold",children:(0,a.jsx)(w.A,{defaultMessage:"Allowed domains",id:"J1MOf/PGed"})}),(0,a.jsx)("p",{className:"text-text-300 font-small mb-2",children:(0,a.jsx)(w.A,{defaultMessage:"Only these domains can embed this artifact. Separate with commas.",id:"mySCaN71No"})}),(0,a.jsx)(r.fs,{value:x,onValueChange:e=>{v(null!=e?e:""),b(!0),N(!1)},onBlur:()=>{b(!1),L&&0===E.length&&R()},placeholder:"www.example.com, www.myblog.com",minRows:1,className:"text-sm"}),(0,a.jsx)("div",{className:"font-base mt-2 text-danger-000",children:E.length>0&&!j?1===E.length?l.formatMessage({defaultMessage:"{invalidDomain} is not a valid domain",id:"4BVWTznQQj"},{invalidDomain:E[0]}):l.formatMessage({defaultMessage:"{invalidDomains} are not valid domains",id:"woDBbyq+SX"},{invalidDomains:"".concat(E.slice(0,E.length-1).join(", ")," and ").concat(E[E.length-1])}):void 0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-text-100 font-base-bold mb-2",children:(0,a.jsx)(w.A,{defaultMessage:"Embed code",id:"O4prKQr/hN"})}),(0,a.jsx)(r.fs,{value:g,readOnly:!0,className:"text-sm read-only:text-text-200 read-only:!opacity-100",rows:5}),(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2 mt-4",children:[k&&(0,a.jsxs)("div",{className:"text-xs flex-grow flex items-center gap-1",children:[(0,a.jsx)(o.Jlk,{size:12,className:"inline"}),(0,a.jsx)(w.A,{defaultMessage:"Saved",id:"fsB/4pdUqN"})]}),(0,a.jsx)(d.$,{size:"default",variant:"secondary",onClick:s,children:(0,a.jsx)(w.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,a.jsx)(d.$,{size:"default",variant:"primary",prepend:h?(0,a.jsx)(o.rAV,{size:14}):(0,a.jsx)(o.QRo,{size:14}),onClick:()=>f(g),className:"w-28",children:(0,a.jsx)(w.A,{defaultMessage:"Copy code",id:"CNXQN5zp9z"})})]})]})]})}let E=e=>{let t,s,{onClose:n,isOpen:i,artifact:r,selectedVersion:d,messageUuid:u,publishedArtifactUuid:m,richSandboxRef:f}=e,h=(0,_.A)(),{publishedArtifactsBaseUrl:x,publishedArtifactsEmbedBaseUrl:C}=(0,l._r)(),v=!!m,[j,b]=(0,y.useState)(!1),N="".concat(x,"/public/artifacts/").concat(m),S="".concat(C,"/public/artifacts/").concat(m,"/embed"),[E,T]=(0,y.useState)("");(0,y.useEffect)(()=>{if(""===E)return;let e=setTimeout(()=>T(""),5e3);return()=>clearTimeout(e)},[E]);let{copyToClipboard:L}=(0,p.C)(),R=v?"shared":"private",I=(0,y.useRef)(R);I.current!==R&&("private"===R&&T(h.formatMessage({defaultMessage:"Artifact no longer published",id:"2ERgiFTuIj"})),I.current=R);let U=()=>{T(""),b(!1),n()};return j?(t=(0,a.jsxs)("div",{className:"flex items-center justify-start gap-2",children:[(0,a.jsx)("button",{onClick:()=>b(!1),children:(0,a.jsx)(o.ZK0,{})}),(0,a.jsx)(w.A,{defaultMessage:"Get embed code",id:"3TjDDwZ836"})]}),s=(0,a.jsx)(A,{artifactUuid:null!=m?m:"",closeEmbedSettings:()=>b(!1),embedLink:S})):v?(t=(0,a.jsx)(w.A,{defaultMessage:"Artifact published",id:"ykyvCB8a6W"}),s=(0,a.jsx)(M,{artifactUuid:null!=m?m:"",publishedLink:N,onClose:U})):(t=(0,a.jsx)(w.A,{defaultMessage:"Publish artifact",id:"D1fyBhklj/"}),s=(0,a.jsx)(k,{artifact:r,selectedVersion:d,messageUuid:u,isOpen:i,richSandboxRef:f,copyToClipboard:L})),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(c.aF,{title:(0,a.jsx)("span",{className:"text-text-200 font-heading  font-medium",children:t}),isOpen:i,onClose:U,modalSize:"lg",hasCloseButton:!0,className:(0,g.A)(!j&&"-mt-20","!p-8 !rounded-2xl"),children:[(0,a.jsxs)("div",{className:"mt-2 flex flex-col gap-2.5",children:[E&&(0,a.jsx)("div",{className:"bg-accent-secondary-900 text-accent-secondary-000 rounded-2xl px-3 py-2 text-sm",children:E}),s]}),(0,a.jsx)(z,{isPublished:v,onOpen:()=>{b(!0)}})]})})};function z(e){let{isPublished:t=!0,isEmbedSettingsOpen:s=!1,onOpen:n}=e;return(0,h.fS)("embed_artifacts")&&t&&!s?(0,a.jsx)("div",{className:"absolute top-full left-0 right-0 mt-3",children:(0,a.jsx)("div",{className:"bg-bg-100 border-0.5 border-border-300 rounded-2xl shadow-lg p-3",onClick:n,children:(0,a.jsxs)(d.$,{variant:"ghost",className:"flex items-center justify-between py-3 pl-3 pr-3 cursor-pointer hover:bg-bg-200/50 transition-colors rounded-xl w-full",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-md flex items-center justify-center",children:(0,a.jsx)(o.NGz,{size:16,className:"text-text-300"})}),(0,a.jsx)("span",{className:"text-text-100",children:(0,a.jsx)(w.A,{defaultMessage:"Get embed code",id:"3TjDDwZ836"})})]}),(0,a.jsx)(o.K3R,{size:16,className:"text-text-300"})]})})}):null}let T=e=>{let{handleRemove:t}=e;return(0,a.jsx)(m.Tooltip,{tooltipContent:(0,a.jsx)(w.A,{defaultMessage:"Remove",id:"G/yZLul6P1"}),side:"bottom",children:(0,a.jsx)("button",{className:(0,g.A)("transition-all hover:bg-bg-000/50 text-text-500 hover:text-text-200 w-5 h-5 rounded-full border-0.5 border-border-300/25 bg-bg-000/90 backdrop-blur-sm flex items-center justify-center",(0,f.Fr)()&&"!opacity-100 !bg-bg-000/50"),onClick:e=>{e.stopPropagation(),e.preventDefault(),t()},children:(0,a.jsx)(o.X,{size:12})})})},L=e=>{let{handleCapture:t}=e;return(0,a.jsx)("div",{className:"absolute inset-0 items-center justify-center bg-accent-main-900/20 hidden group-hover:flex",children:(0,a.jsx)(m.Tooltip,{tooltipContent:(0,a.jsx)(w.A,{defaultMessage:"Capture screenshot",id:"4aPgLNzYUy"}),side:"right",children:(0,a.jsx)(d.$,{variant:"secondary",size:"icon",onClick:t,className:"!bg-bg-100",children:(0,a.jsx)(o.i7d,{})})})})}},69351:(e,t,s)=>{s.d(t,{n:()=>w,M:()=>y});var a=s(19736),n=s(65018),i=s(32049),l=s(65315),r=s(56929),o=s(7620),d=s(44007),c=s(50571),u=s(47831),m=s(44894),p=s(74813),f=s(35984),h=s(8019),g=s(23670),x=s(35580);function C(e){let{mimeType:t,base64Data:s}=e;if(!m._F[t])throw(0,r.Cp)(Error("Unsupported image type"),{extra:{mimeType:t}}),Error("The tool returned an image in an unsupported format.");let a=m._F[t];return{type:"image",file_name:"".concat((0,h.b)(),".").concat(a),source:{media_type:t,type:"base64",data:s}}}var v=s(19354);async function j(e,t){let s=v.zN.safeParse(e);if(s.success)try{let e=await t(s.data.code);return{content:[{type:"text",text:JSON.stringify(e)}]}}catch(t){let e=t instanceof Error?t.message:String(t);throw Error("Error executing code: ".concat(e))}throw Error("Error parsing input: ".concat(s.error.message))}var b=s(73648);function y(){let{mutateAsync:e}=(0,a.Pt)(),t=function(){let{executeReplCode:e}=(0,n.q)(),t=function(){let{track:e}=(0,p.st)(),{addError:t}=(0,f.Y)();return(0,o.useCallback)(async(s,a,n)=>{let i;try{let t=await (0,x.KU)(n).callTool({name:a.name,arguments:s},g.zo,{timeout:24e4});e({event_key:"mcp.tools.called",result:"success",argument_count:Object.keys(s).length}),i="content"in t?t:{content:[{type:"text",text:JSON.stringify(t.toolResult,null,2)}],isError:!1}}catch(i){throw(0,r.Cp)(i,{tags:{serverUuid:n}}),t("Failed to call tool ".concat(a.name),{error:i}),e({event_key:"mcp.tools.called",result:"failure",argument_count:Object.keys(s||{}).length}),Error("Tool execution failed")}return{is_error:i.isError,content:i.content.map(e=>{switch(e.type){case"text":return{type:"text",text:e.text};case"image":return C({mimeType:e.mimeType,base64Data:e.data});case"resource":{let t=e.resource;if("text"in t)return{type:"text",text:t.text};if("blob"in t){if(!t.mimeType)throw(0,r.Cp)(Error("Missing MIME type for resource"),{tags:{serverUuid:n}}),Error("The tool returned a resource without a valid format.");return C({mimeType:t.mimeType,base64Data:t.blob})}}}throw(0,r.Cp)(Error("Unsupported content type"),{tags:{serverUuid:n},extra:{mimeType:e.type}}),Error("The tool returned content in an unsupported format.")})}},[e,t])}();return(0,o.useCallback)(async(s,a)=>{let n=(0,b.p)(a);if("repl"===s)return await j(n,e);{let e=(0,x.pK)(s);if((null==e?void 0:e.tool)&&(null==e?void 0:e.server))return await t(n,e.tool,e.server.uuid)}},[e,t])}();return(0,o.useCallback)(async function(s,a,n,i){let{overriddenResult:l}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};try{let o=null!=l?l:await t(a,i);if(void 0===o){(0,x.qT)(a)&&(0,r.Cp)(Error("Tool not found"),{tags:{conversationUuid:s,toolId:n},level:"warning"});return}await e({conversation_uuid:s,type:"tool_result",tool_use_id:n,...o})}catch(a){(0,r.Cp)(a,{tags:{conversationUuid:s,toolId:n}});let t=a instanceof Error?a.message:String(a);await e({conversation_uuid:s,type:"tool_result",tool_use_id:n,content:[{type:"text",text:t}]})}},[t,e])}let w=(e,t)=>{let s=(0,l.wc)(),{value:a}=(0,i.N)(null!=e?e:{}),n=(0,d.p9)(),r=(0,u.Pb)(t),m=(0,c.yr)();return(0,o.useCallback)(()=>{let t=(0,x._b)(n,e,m),i=null==s?void 0:s[l.U3];return i&&t.push({type:(null==s?void 0:s[l.$6])||"",name:i}),t.push({type:"artifacts_v0",name:"artifacts"}),a&&t.push({type:"repl_v0",name:"repl"}),r&&t.push({type:"project_knowledge_search",name:"project_knowledge_search"}),t},[e,a,s,r,n,m])}},71196:(e,t,s)=>{s.d(t,{a:()=>C});var a=s(54568),n=s(74813),i=s(64328),l=s(35984),r=s(23812),o=s(16178),d=s(19664),c=s.n(d),u=s(7620),m=s(10369),p=s(59666),f=s(62210),h=s(4887),g=s(34498);function x(e){let{skillName:t,isOpen:s,isLoading:n,onConfirm:i,onCancel:l}=e,r=(0,m.A)();return(0,a.jsx)(g.R,{isOpen:s,onClose:l,onConfirm:i,title:r.formatMessage({defaultMessage:"Replace â€œ{skillName}â€ skill?",id:"RSqxaAn/FM"},{skillName:t}),message:r.formatMessage({defaultMessage:"Thereâ€™s an existing skill with the same name. Uploading this skill will replace the existing one, which canâ€™t be restored.",id:"dRMF/vTgCW"}),confirmText:r.formatMessage({defaultMessage:"Upload and replace",id:"TtbWBGHNcO"}),cancelText:r.formatMessage({defaultMessage:"Cancel",id:"47FYwba+bI"}),variant:"danger",isLoading:n})}function C(e){let{file:t,conversationUuid:s,source:d,variant:g="ghost",size:C="default",className:v}=e,{activeOrganization:j}=(0,i.YL)(),{addError:b,addSuccess:y}=(0,l.Y)(),w=(0,n.st)(),_=(0,m.A)(),[k,N]=(0,u.useState)(!1),[M,S]=(0,u.useState)(!1),[A,E]=(0,u.useState)(""),[z,T]=(0,u.useState)(!1),[L,R]=(0,u.useState)(null),[I,U]=(0,u.useState)(!1),O=(0,f.oE)({meta:{noToast:!0},onSuccess:e=>{let{skill:t,validationErrors:s}=e;(z?T:N)(!1),t&&(U(!0),y((0,a.jsxs)("span",{children:[(0,a.jsx)(p.A,{defaultMessage:"Skill uploaded successfully. ",id:"dHDmXia2qf"}),(0,a.jsx)(c(),{href:"/settings/capabilities#skills",className:"underline hover:no-underline",children:(0,a.jsx)(p.A,{defaultMessage:"View",id:"FgydNeoT78"})})]})),z&&(S(!1),R(null),E(""))),s.length>0&&s.forEach(e=>{b(e.message,{errorContext:{tags:{code:e.error_code}}})})},onError:e=>{e instanceof o.LG&&"upload_skill_already_exists"===e.errorCode?(E(e.extra.details.skill_name),S(!0),N(!1)):((z?T:N)(!1),b(e instanceof Error&&e.message?e.message:_.formatMessage({defaultMessage:"Failed to upload skill. You can try again.",id:"3wfKKwlXcY"}),{error:e,errorContext:{tags:{source:"skill_file_upload"}},messageForLogging:"Failed to upload skill."}))}}),F=(0,u.useCallback)(async(e,t)=>{let s=t?T:N;s(!0);try{let s=new FormData;s.append("file",e),s.append("overwrite",t?"true":"false"),await O.mutateAsync(s)}catch(e){s(!1)}},[O]),D=(0,u.useCallback)(async()=>{if(null==j?void 0:j.uuid){w.track({event_key:"claudeai.skills.file_save_skill.clicked",source:d,file_path:t.path}),N(!0);try{let e=(0,h.T)({organizationUuid:j.uuid,conversationUuid:s,filePath:t.path.replace(/^computer:\/\//,""),isShared:!1}),a=await fetch(e);if(!a.ok)throw Error("Failed to download file: ".concat(a.status," ").concat(a.statusText));let n=await a.blob(),i=t.path.split("/").pop()||"skill.skill",l=new File([n],i,{type:n.type});R(l),await F(l,!1)}catch(t){N(!1);let e=t instanceof Error?t:Error(String(t));b(e.message||_.formatMessage({defaultMessage:"Failed to download and upload skill. You can try again.",id:"KTwAodcnD6"}),{error:e,errorContext:{tags:{source:"skill_file_download"}},messageForLogging:"Failed to download and upload skill."})}}},[j,w,s,t.path,d,F,b,_]),P=(0,u.useCallback)(async()=>{L&&await F(L,!0)},[L,F]),B=(0,u.useCallback)(()=>{S(!1),R(null),E(""),T(!1)},[]);return t.path.endsWith(".skill")?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.$,{variant:g,size:C,loading:k,onClick:e=>{e.preventDefault(),e.stopPropagation(),D()},className:v,children:I?(0,a.jsx)(p.A,{defaultMessage:"Save again",id:"sCntRO8ziR"}):(0,a.jsx)(p.A,{defaultMessage:"Save skill",id:"QvmjxZ7K5S"})}),(0,a.jsx)(x,{skillName:A,isOpen:M,isLoading:z,onConfirm:P,onCancel:B})]}):null}},72098:(e,t,s)=>{s.d(t,{c:()=>tO});var a=s(54568),n=s(64328),i=s(7620),l=s(24423),r=s(68067),o=s(61295);s(96442);var d=s(2348),c=s(32049),u=s(59922),m=s(23812),p=s(18868),f=s(21114),h=s(85524),g=s(10369),x=s(59666),C=s(16685);function v(){let e=(0,d._)(["\n  flex flex-row gap-1 rounded-md p-2 text-xs select-none -mx-1 mb-1 mt-4 outline outline-1 text-text-100\n"]);return v=function(){return e},e}function j(){let e=(0,d._)(["\n  bg-bg-300/80 text-text-300 outline-bg-400/80\n"]);return j=function(){return e},e}function b(){let e=(0,d._)(["\n  bg-accent-secondary-200/20 outline-accent-secondary-200/30\n"]);return b=function(){return e},e}function y(){let e=(0,d._)(["\n  cursor-pointer items-center bg-danger-900/50 hover:bg-danger-900/75 transition group/banner outline-danger-000/25 hover:outline-danger-000/50\n"]);return y=function(){return e},e}let w=u.J.div(v()),_=(0,u.J)(w)(j()),k=(0,u.J)(w)(b()),N=(0,u.J)(w)(y()),M=(0,i.memo)(function(e){var t;let{message:s,messageWarningPropsFromParent:n,hasLink:l,hasCode:o,hasDriveDocWithImages:d,onRetry:u,onSendContinue:v,conversationSettings:j,isLastMessage:b}=e,y=(0,g.A)(),{value:w}=(0,c.N)(null!=j?j:{}),M=null==j?void 0:j.enabled_web_search,S=(0,r.fS)("claudeai_web_search"),A=(0,i.useMemo)(()=>({a:e=>{let{node:t,...s}=e;return(0,a.jsx)("a",{...s,className:"underline"})}}),[]);if((null==n?void 0:n.style)==="prominent")return(0,a.jsxs)(k,{"data-testid":"message-warning",children:[(0,a.jsx)(p.N,{className:"shrink-0",size:16}),(0,a.jsx)(C.o,{components:A,children:n.contentMarkdown})]});let E="human"===s.sender;if(!E&&"error"===s.stop_reason&&u)return(0,a.jsxs)(N,{"data-testid":"message-warning",onClick:()=>u(s.parent_message_uuid),children:[(0,a.jsxs)("div",{className:"relative h-4 w-4 shrink-0 text-danger-000",children:[(0,a.jsx)(p.N,{className:"absolute inset-0 group-hover/banner:opacity-0 group-hover/banner:scale-75  opacity-50 transition",size:16}),(0,a.jsx)(f.o,{className:"absolute inset-0 group-hover/banner:opacity-75 group-hover/banner:rotate-0 rotate-[20deg] opacity-0 transition",size:16})]}),(0,a.jsx)("div",{className:"flex flex-grow text-danger-000",children:(0,a.jsx)(x.A,{defaultMessage:"This response didnâ€™t load. Try again by chatting to Claude.",id:"g0FIIo0clM"})})]});if(!E&&b&&"max_tokens"===s.stop_reason&&v)return(0,a.jsx)(_,{"data-testid":"message-warning",children:(0,a.jsxs)("div",{className:"flex max-sm:flex-col gap-2 w-full",children:[(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(h.R,{className:"shrink-0",size:16}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(x.A,{defaultMessage:"This response paused because Claude reached its max length for a message. Hit continue to nudge Claude along.",id:"oje9UAHUmL"})})]}),(0,a.jsx)("div",{className:"ml-6",children:(0,a.jsx)(m.$,{variant:"secondary",size:"sm",className:"block flex-shrink-0",onClick:()=>null==v?void 0:v(),"aria-label":y.formatMessage({defaultMessage:"Continue",id:"acrOozm08x"}),children:(0,a.jsx)(x.A,{defaultMessage:"Continue",id:"acrOozm08x"})})})]})});if(!E&&b&&(null==(t=s.metadata)?void 0:t.is_resume_completion_placeholder_message))return(0,a.jsx)("div",{className:"m-2 w-full",children:(0,a.jsx)(_,{"data-testid":"message-warning",children:(0,a.jsx)("div",{className:"p-1",children:(0,a.jsx)(x.A,{defaultMessage:"Claude is still creating a response in the background. Once itâ€™s complete, youâ€™ll see it here.",id:"PBOdLw2o4Z"})})})});let z=[];return(E?(l&&!M&&(S?z.push(y.formatMessage({defaultMessage:"Claude does not have internet access enabled. Enable web search to get up to date info from web links.",id:"fPI2JySdII"})):z.push(y.formatMessage({defaultMessage:"Claude does not have internet access and cannot get up to date info from web links.",id:"SXpasVsDUZ"}))),d&&z.push(y.formatMessage({defaultMessage:"Claude cannot yet access images from Google Docs.",id:"8Wb1yCJBBv"}))):(l&&!M&&(S?z.push(y.formatMessage({defaultMessage:"Claude does not have internet access enabled. Enable web search for up to date and accurate links.",id:"sN35Yf2Rzl"})):z.push(y.formatMessage({defaultMessage:"Claude does not have internet access. Links provided may not be accurate or up to date.",id:"c8NyKXBwfo"}))),!o||w||(null==j?void 0:j.enabled_monkeys_in_a_barrel)||z.push(y.formatMessage({defaultMessage:"Claude does not have the ability to run the code it generates yet.",id:"dSVZQBKb/U"})),s.stop_reason,"conversation_length_limit"===s.stop_reason&&z.push(y.formatMessage({defaultMessage:"Claude hit the maximum length for this conversation. Please start a new conversation to continue chatting with Claude.",id:"jujWu4WTLz"})),n&&z.push(n.contentMarkdown)),0===z.length)?null:(0,a.jsxs)(_,{"data-testid":"message-warning",children:[(0,a.jsx)(h.R,{className:"shrink-0",size:16}),(0,a.jsx)(C.o,{components:A,children:z.reverse().join(" ")})]})});var S=s(88769);let A=e=>{let{message:t,isLastMessage:s,conversationSettings:n,messageWarningPropsFromParent:i,hasDriveDocWithImages:l,onRetry:r,onSendContinue:o}=e,d=(0,S.LR)(t.uuid),c=(0,S.Kc)(t.uuid);return(0,a.jsx)(M,{message:t,hasLink:d,hasCode:c,isLastMessage:s,hasDriveDocWithImages:l,conversationSettings:n,messageWarningPropsFromParent:i,onRetry:r,onSendContinue:o})};function E(){let e=(0,d._)(["\n  group\n  relative\n  inline-flex\n  gap-2\n  bg-bg-300\n  rounded-xl\n  pl-2.5\n  py-2.5\n  break-words\n  text-text-100\n  transition-all\n  max-w-[75ch]\n  flex-col\n"]);return E=function(){return e},e}function z(){let e=(0,d._)(["\n  group\n  relative\n"]);return z=function(){return e},e}function T(){let e=(0,d._)(["\n  font-claude-response\n  relative\n  leading-[1.65rem]\n  [&_pre>div]:bg-bg-000/50\n  [&_pre>div]:border-0.5\n  [&_pre>div]:border-border-400\n  [&_.ignore-pre-bg>div]:bg-transparent\n  [&_.standard-markdown_:is(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2\n  [&_.standard-markdown_:is(p,blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8\n  [&_.progressive-markdown_:is(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2\n  [&_.progressive-markdown_:is(p,blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8\n"]);return T=function(){return e},e}let L={initial:!1,animate:{y:0,opacity:1}},R={initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{type:"spring",damping:10,stiffness:100}},I={initial:{scale:1.02,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3,ease:"easeOut"}},U={initial:{height:"0px",opacity:0},animate:{height:"auto",opacity:1},transition:{ease:"linear",duration:.1}},O=(0,u.J)(o.P.div)(E()),F=(0,u.J)(o.P.div)(z()),D=u.J.div(T());var P=s(86545),B=s(74813),G=s(89626),W=s(64371),V=s(57291),q=s(41473),H=s(72902),Y=s(39109),J=s(24407),K=s(13644),X=s(10665),Z=s(1613),Q=s(57820),$=s(96614),ee=s(98944),et=s(87483),es=s(1720),ea=s(3075),en=s(29820),ei=s(88775),el=s(69351);function er(e){let{isOpen:t,onClose:s,conversationUuid:n,messageUuid:i}=e;return(0,a.jsx)(ea.aF,{isOpen:t,onClose:s,modalSize:"xl",hasCloseButton:!0,title:(0,a.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,a.jsx)(x.A,{defaultMessage:"Debug information",id:"NqgO+Si31g"}),(0,a.jsx)("span",{className:"ml-2 mt-px pb-px text-sm font-medium text-always-white bg-always-black px-2 rounded",children:(0,a.jsx)(x.A,{defaultMessage:"Internal use only",id:"xg5Va4c/VJ"})})]}),children:(0,a.jsx)(eo,{conversationUuid:n,messageUuid:i})})}function eo(e){let{conversationUuid:t,messageUuid:s}=e,{data:l,isPending:r,mutateAsync:o}=((e,t)=>{let{activeOrganization:s}=(0,n.YL)(),a=null==s?void 0:s.uuid;return(0,Z.L2)("/api/organizations/".concat(a,"/chat_conversations/").concat(e,"/chat_messages/").concat(t,"/debug"),"POST")})(t,s),d=(0,ei.Tc)(e=>e.model,"ChatMessageDebugModal"),c=(0,X.vP)("paprika_mode"),u=(0,ee.B)(),p=(0,el.n)(null==u?void 0:u.enabled_mcp_tools),{codeStyle:f}=(0,Q.V)(),h=l?JSON.stringify(function(e){for(let[t,s]of Object.entries(e.logs.api_usage))if("string"==typeof s)try{let a=JSON.parse(s);e.logs.api_usage[t]=a}catch(e){}return e}(l),null,2):"",g=(0,$.Z3)(t);(0,i.useEffect)(()=>{(async()=>{await o({prompt:"",model:d||g,tools:p(),personalized_styles:[],paprika_mode:c})})()},[o,d,p,c,g]);let{didCopy:C,copyToClipboard:v}=(0,W.C)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"absolute top-6 bg-bg-100 right-16 flex items-center space-x-2",children:[(0,a.jsx)(m.$,{variant:"ghost",size:"icon_sm",onClick:()=>{v(h)},prepend:(0,a.jsx)(W.u,{didCopy:C}),tooltip:(0,a.jsx)(x.A,{defaultMessage:"Copy debug information",id:"XVVZO6tEau"}),className:"ml-auto"}),(0,a.jsx)(ed,{messageUuid:s})]}),r?(0,a.jsx)("div",{className:"my-2 flex w-full items-center justify-center h-[32rem]",children:(0,a.jsx)(es.Loading,{})}):(0,a.jsx)(en.A,{customStyle:{maxHeight:"32rem",fontSize:".875rem"},language:"json",PreTag:"div",style:f,children:h})]})}let ed=e=>{let{messageUuid:t}=e,{copyToClipboard:s}=(0,W.C)(),n=(0,g.A)(),r=(0,i.useCallback)(async()=>{let e=l.oz.getState().messageByUuid[t];if(!e)return;let a=(0,q.C)(e);await s(a)},[t,s]);return(0,a.jsx)(et.ms,{onCloseAutoFocus:e=>{e.preventDefault()},trigger:(0,a.jsx)(m.$,{variant:"ghost",size:"icon_sm","aria-label":n.formatMessage({defaultMessage:"More options",id:"IzCVhGdYVc"}),children:(0,a.jsx)(G.FOq,{})}),children:(0,a.jsxs)(et.tJ,{onSelect:r,children:[(0,a.jsx)(G.B0c,{}),(0,a.jsx)(x.A,{defaultMessage:"Copy unmodified message",id:"+yNntDpG9W"})]})})};var ec=s(95617),eu=s(69524);function em(e){var t,s;let{conversationUuid:n,message:l}=e,[r,o]=(0,i.useState)(void 0),[d,c]=(0,i.useState)(!1),u=e=>{"flag"===e?(null==r?void 0:r.startsWith("flag"))||o(ec.kj.FLAG):r!==ec.kj.UPVOTE&&o(ec.kj.UPVOTE),c(!0)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.$,{variant:"ghost",size:"icon_sm",className:(null==(t=l.chat_feedback)?void 0:t.type.includes("upvote"))?"bg-bg-200 !text-accent-secondary-100":"",tooltip:(0,a.jsx)(x.A,{defaultMessage:"Give positive feedback",id:"FGCv00cdfW"}),onClick:()=>u("upvote"),prepend:(0,a.jsx)(G.twC,{size:16})}),(0,a.jsx)(m.$,{variant:"ghost",size:"icon_sm",className:(0,H.A)((null==(s=l.chat_feedback)?void 0:s.type.includes("flag"))&&"bg-bg-200 !text-danger-100"),tooltip:(0,a.jsx)(x.A,{defaultMessage:"Give negative feedback",id:"ngzzQUJCXB"}),onClick:()=>u("flag"),prepend:(0,a.jsx)(G.SuN,{size:16})}),(0,a.jsx)(eu.B,{conversationUuid:n,message:l,requestedFeedbackType:r,setRequestedFeedbackType:o,isOpen:d,onClose:()=>c(!1)})]})}var ep=s(67453);function ef(e){let{children:t,onClick:s,tooltipContent:n,Icon:i,disabled:l,"data-testid":r}=e,o=(0,a.jsx)(m.$,{variant:"ghost",size:"sm",className:"!font-base !px-2 !h-7 !min-w-0",onClick:s,disabled:l,"data-testid":r,children:i||t});return n?(0,a.jsx)(ep.Tooltip,{tooltipContent:n,children:o}):o}var eh=s(21266),eg=s(47147);function ex(e){let{paprikaMode:t,supportedPaprikaModes:s,onRetry:n,parentMessageUuid:l,setPaprikaModeState:r}=e,[o,d]=(0,i.useState)(!1),c=(0,eg.Wi)().filter(e=>e.paprika_mode_value&&e.paprika_mode_value!==t&&s.includes(e.paprika_mode_value)),u=(0,i.useCallback)((e,t)=>{n(e,t),r(t)},[n,r]);return(0,a.jsxs)(et.ms,{align:"start",unstyledTrigger:!0,onCloseAutoFocus:e=>e.preventDefault(),open:o,onOpenChange:d,trigger:(0,a.jsx)(m.$,{variant:"ghost",size:"sm",className:"!font-base select-none !pl-2 !pr-1",append:(0,a.jsx)(G.biH,{className:"text-text-500"}),children:(0,a.jsx)(x.A,{defaultMessage:"Retry",id:"62nsdyMyIO"})}),children:[(0,a.jsx)(et.tJ,{className:"text-sm",onClick:()=>n(l),children:(0,a.jsx)(x.A,{defaultMessage:"With no changes",id:"h3WdKJh51e"})}),c.map(e=>(0,a.jsx)(et.tJ,{className:"text-sm",onClick:()=>u(l,e.paprika_mode_value),children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex flex-col",children:"extended"===e.id?(0,a.jsx)(x.A,{defaultMessage:"With extended thinking",id:"/zFAxhC9JS",description:"Lets the user try again using a different thinking mode"}):"With ".concat(e.title.toLowerCase()," thinking")}),(0,a.jsx)("div",{className:"text-text-500 text-xs",children:e.description_key?(0,a.jsx)(eh.X5,{id:e.description_key}):e.description})]})},e.id))]})}var eC=s(87017),ev=s(90458);let ej={default:{allowed:"never"}},eb=J.z.record(J.z.object({allowed:J.z.enum(["never","first_turn","always"])})),ey=e=>{let{isStreaming:t,isLastMessage:s,isInteractive:n,isAssistant:i,children:l}=e;return(0,a.jsx)(Y.N,{children:!t&&(0,a.jsx)(o.P.div,{className:"absolute bottom-0 right-2 pointer-events-none",initial:{scale:.95},animate:{scale:1},transition:{type:"spring",damping:30,stiffness:400},children:(0,a.jsx)("div",{className:(0,H.A)("rounded-lg transition min-w-max pointer-events-auto",i?"translate-x-2":"translate-y-4 bg-bg-100/80 backdrop-blur-sm translate-x-1 group-hover:translate-x-0.5 border-0.5 border-border-300 p-0.5 shadow-sm",s?"translate-y-full pt-2":"opacity-0 group-hover:opacity-100"),children:l})})})},ew=(0,i.memo)(function(e){var t,s,n,o,d,c;let{message:u,previousMessage:p,conversationUuid:f,isStreaming:h,isTemporary:g=!1,onRetry:C,isLastMessage:v,isLastHumanMessage:j,isInteractive:b=!0,changeDisplayedConversationPath:y,editMessage:w,editable:_=!1,isFirstAssistantMessage:k,isResearchPending:N,model:M,extendedThinkingSetting:S,showArtifacts:A=!1,chatFeedbackEnabled:E}=e,[z,T]=(0,i.useState)(!1),{track:L}=(0,B.st)(),R="human"===u.sender,I="assistant"===u.sender,U=h&&v,O=(0,r.fS)("anthropic_internal_only_expose_chat_debug"),F=!h&&(null!=(o=u.nOptions)?o:0)>1&&y,D=!h&&!N&&_&&w&&u.parent_message_uuid&&b,H=null==u||null==(t=u.content)?void 0:t.some(e=>"tool_use"===e.type&&"end_conversation"===e.name),Y=!h&&!N&&b&&!H,J=Y&&R&&!v&&!u.pending,Z=(0,i.useCallback)((e,t,s)=>{L({event_key:"claudeai.message.user_triggered_retry",is_last_human_message:"assistant_message_footer"===e?v:j,source:e}),C(t,s)},[L,j,v,C]),{didCopy:Q,copyToClipboard:$}=(0,W.C)(),ee=(0,i.useCallback)(async()=>{let e=l.oz.getState().messageByUuid[u.uuid],t=(0,q.C)(e),s=(A?(0,V.it)(t):t).trim();try{let e=(0,eC.u)(s);await $({text:s,html:e})}catch(e){await $(s)}},[A,u.uuid,$]),et=(0,K.QY)(),{toggleConversationSetting:es}=(0,X.rX)(),ea=(0,i.useCallback)(e=>{es("paprika_mode",null!=e?e:null)},[es]),{allModelOptions:en}=(0,P.A9)(),ei=(0,r.iW)("claude_ai_paprika_retry",ej,eb),el=(0,ev.Z)(f),eo=null!=(c=null!=(d=M&&(null==(s=ei[M])?void 0:s.allowed))?d:null==(n=ei.default)?void 0:n.allowed)?c:"never";if(R&&!D&&!J&&!F)return null;let ed=en.find(e=>e.model===M),ec=null==ed?void 0:ed.paprika_modes,eu=ec&&ec.length>0&&!S&&("always"===eo||"first_turn"===eo&&k);return(0,a.jsx)(ey,{isStreaming:U,isLastMessage:v,isInteractive:b,isAssistant:I,children:(0,a.jsxs)("div",{className:"text-text-300 flex items-stretch justify-between",children:[I&&O&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.$,{variant:"ghost",size:"icon_sm",tooltip:(0,a.jsx)(x.A,{defaultMessage:"Debug",id:"z3UjXRZwzQ"}),onClick:()=>T(!0),prepend:(0,a.jsx)(G.IFY,{})}),(0,a.jsx)(er,{isOpen:z,onClose:()=>T(!1),messageUuid:u.uuid,conversationUuid:f})]}),!el&&R&&(D||J)&&(0,a.jsxs)("div",{className:"flex items-center",children:[J&&(0,a.jsx)(m.$,{variant:"ghost",size:"icon_sm",onClick:()=>Z("human_message_hover",u.uuid),tooltip:(0,a.jsx)(x.A,{defaultMessage:"Retry",id:"62nsdyMyIO"}),prepend:(0,a.jsx)(G.MvQ,{})}),D&&(0,a.jsx)(m.$,{variant:"ghost",size:"icon_sm",onClick:()=>w(u,"test edit message"),tooltip:(0,a.jsx)(x.A,{defaultMessage:"Edit",id:"wEQDC6Wv3/"}),prepend:(0,a.jsx)(G.ffu,{})})]}),I&&(0,a.jsx)(m.$,{variant:"ghost",size:"icon_sm",onClick:ee,"data-testid":"action-bar-copy",tooltip:(0,a.jsx)(x.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"}),prepend:(0,a.jsx)(W.u,{didCopy:Q})}),I&&!U&&!N&&b&&"error"!==u.stop_reason&&(void 0!==E?E:et)&&!g&&(0,a.jsx)(em,{conversationUuid:f,message:u}),(0,a.jsxs)("div",{className:"flex items-center",children:[F&&(0,a.jsx)(e_,{message:u,changeDisplayedConversationPath:y}),I&&Y&&(eu?(0,a.jsx)(ex,{paprikaMode:S,supportedPaprikaModes:ec,onRetry:(e,t)=>Z("assistant_message_footer",null!=e?e:void 0,t),parentMessageUuid:u.parent_message_uuid,setPaprikaModeState:ea}):(0,a.jsx)(ef,{onClick:()=>{Z("assistant_message_footer",u.parent_message_uuid)},children:(0,a.jsx)(x.A,{defaultMessage:"Retry",id:"62nsdyMyIO"})}))]})]})})});function e_(e){var t;let{message:s,changeDisplayedConversationPath:n}=e,i=(null!=(t=s.selectedOption)?t:0)+1,l=i===s.nOptions;return(0,a.jsxs)("div",{className:"inline-flex items-center gap-1",children:[(0,a.jsx)(m.$,{variant:"ghost",size:"icon_xs",disabled:1===i,onClick:()=>n(s,-1),children:(0,a.jsx)(G.ZK0,{})}),(0,a.jsx)("span",{className:"self-center shrink-0 select-none font-small text-text-300",children:(0,a.jsx)(x.A,{defaultMessage:"{selectedOption} / {totalOptions}",id:"0zCqdBEnn7",values:{selectedOption:i,totalOptions:s.nOptions}})}),(0,a.jsx)(m.$,{variant:"ghost",size:"icon_xs",disabled:l,onClick:()=>n(s,1),children:(0,a.jsx)(G.K3R,{})})]})}var ek=s(9398),eN=s(26752),eM=s(66365),eS=s(79052);let eA=()=>{let e=(0,B.st)(),{initDriveAuth:t}=(0,eS.cI)({});return(0,i.useEffect)(()=>{e.track({event_key:"claudeai.in_chat_upsell.connect_gdrive.displayed"})},[e]),(0,a.jsx)(eE,{title:(0,a.jsx)(x.A,{defaultMessage:"Add context from all your docs more easily",id:"gHPka72Ai9"}),icon:(0,a.jsx)(eN.g,{size:18}),cta:(0,a.jsxs)(m.$,{className:"bg-bg-100 border-border-300",size:"sm",variant:"secondary",onClick:()=>{e.track({event_key:"claudeai.in_chat_upsell.connect_gdrive.start"}),t()},children:[(0,a.jsx)(ek.ft,{size:16,className:"mr-1"}),(0,a.jsx)(x.A,{defaultMessage:"Connect Drive",id:"XzTB2bvNw1"})]})})},eE=e=>{let{title:t,icon:s,cta:n}=e;return(0,a.jsx)(o.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"mt-3",children:(0,a.jsx)("div",{className:"overflow-hidden rounded-lg border-0.5 border-border-300 bg-bg-100 shadow-sm",children:(0,a.jsx)("div",{className:"px-2.5 py-2.5",children:(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"rounded-lg bg-primary-100 p-1",children:s}),(0,a.jsx)("h3",{className:"text-sm text-text-100",children:t})]}),n]})})})})},ez=e=>{let{previousMessage:t}=e,s=(0,eS.LP)(),{isDriveAuthenticated:n}=(0,eS.cI)({}),l=(0,i.useMemo)(()=>!!t&&t.attachments.some(e=>"docx"===e.file_type),[t]),o=(0,r.fS)("pumpernickel_enabled"),d=(0,eM.useLayer)("trials_freemium").get("free_integrations",!1);return(o||d)&&s&&!n&&l?(0,a.jsx)(eA,{}):null};var eT=s(19069);function eL(){let e="dark"===(0,eT.D)().resolvedMode?"#3D3D3A":"#E3DACC";return(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"31",viewBox:"0 0 40 31",fill:"none",children:[(0,a.jsx)("path",{d:"M24.4924 3.83232L24.7685 8.56589C24.7685 8.56589 22.1187 8.29883 21.4575 8.56589C20.7963 8.83294 20.0683 9.11469 20.0683 9.11469C20.0683 9.11469 22.0046 10.5304 21.8725 11.6262C21.7405 12.723 21.5561 13.2338 21.5561 13.2338C21.5561 13.2338 23.1606 12.621 24.1656 13.2338C25.1707 13.8465 26.5385 15.7133 25.7693 17.0702C25 18.4271 23.8552 19.8376 22.4977 19.5645C21.1402 19.2914 20.4087 18.2767 19.6172 18.3087C18.8257 18.3407 17.6911 19.0174 17.9149 19.8895C18.1388 20.7606 19.4817 22.5721 21.9403 22.7467C24.3989 22.9213 26.5325 21.8669 26.5325 21.8669L27.0427 21.4149C27.0427 21.4149 26.6259 27.8217 26.7992 29.5631C26.9724 31.3046 28.8581 30.1768 28.8581 30.1768L29.9833 28.0775C29.9833 28.0775 29.8469 30.4291 31.0252 30.175C32.2035 29.9218 33.0481 29.5476 33.3543 28.3947C33.6604 27.2417 34.2804 27.3411 34.2804 27.3411C34.2804 27.3411 34.1372 29.125 35.1852 29.1345C36.2339 29.144 37.287 26.4821 37.5751 25.1338C37.8633 23.7856 38.6385 7.75867 38.6385 7.75867L38.768 3.57996L24.4932 3.83319L24.4924 3.83232Z",fill:e}),(0,a.jsx)("path",{d:"M16.7101 12.1171C16.7101 12.1171 18.258 11.8475 18.9912 12.4801C19.7244 13.1128 20.7303 13.6253 20.7303 13.6253C20.7303 13.6253 19.9293 15.123 19.7835 16.1913C19.6378 17.2604 19.2604 18.2646 18.5487 18.065C17.8369 17.8654 16.5574 17.0936 16.5969 15.7505C16.6363 14.4074 16.7092 12.1171 16.7092 12.1171H16.7101Z",fill:e}),(0,a.jsx)("path",{d:"M22.6029 18.8634C22.6953 18.4517 22.7252 18.2201 22.7629 17.9988C22.78 17.8864 22.7962 17.7741 22.8056 17.6308C22.8116 17.5597 22.8159 17.4807 22.8159 17.3915C22.8159 17.3023 22.8193 17.202 22.8116 17.087C22.7902 16.6282 22.7714 16.4 22.7509 16.1727C22.7389 16.0595 22.7295 15.9446 22.7038 15.8056C22.6918 15.7361 22.6799 15.6581 22.6576 15.5732C22.6362 15.4882 22.6166 15.3905 22.5806 15.2867C22.5635 15.2344 22.5473 15.1846 22.5327 15.1383C22.5147 15.0945 22.4968 15.0559 22.4805 15.0182C22.4634 14.9813 22.4472 14.9462 22.4318 14.9127C22.4129 14.8827 22.395 14.8535 22.3779 14.8261C22.3128 14.7146 22.241 14.6442 22.1768 14.5705C22.1409 14.5379 22.1049 14.5061 22.069 14.4718C22.0331 14.4367 21.9894 14.4101 21.9484 14.3732C21.9278 14.3535 21.9039 14.3397 21.8791 14.3226C21.8551 14.3054 21.8303 14.2874 21.8029 14.2685C21.7747 14.254 21.7465 14.2368 21.7165 14.2179C21.6874 14.1974 21.6532 14.1888 21.6198 14.1699C21.3444 14.0593 21.2263 14.0876 21.1074 14.1107C21.0458 14.1236 20.9919 14.1553 20.9234 14.2042C20.8516 14.2728 20.7797 14.3517 20.7215 14.5087C20.6633 14.6674 20.6479 14.8329 20.636 14.9685C20.6257 15.1074 20.6257 15.2258 20.6231 15.3467C20.618 15.5886 20.6231 15.8416 20.5393 16.3494C20.4965 16.6033 20.4477 16.792 20.3998 16.9455C20.375 17.0244 20.3571 17.0862 20.3254 17.1677C20.3109 17.2054 20.2972 17.2423 20.2818 17.2783C20.2647 17.3135 20.2475 17.3487 20.2313 17.383C20.1628 17.5202 20.0807 17.6531 19.9635 17.8058C19.8463 17.9576 19.6906 18.1292 19.4545 18.3076C19.2175 18.4843 19.0267 18.5812 18.8693 18.6593C18.7118 18.7347 18.5844 18.7922 18.456 18.842C18.3277 18.8926 18.1985 18.9372 18.036 18.9775C17.8734 19.0178 17.6766 19.0547 17.4165 19.077C16.8981 19.1173 16.6465 19.1061 16.3959 19.1036C16.3334 19.1019 16.2718 19.1001 16.2051 19.0984C16.1888 19.0984 16.1717 19.0976 16.1555 19.0967H16.1298L16.0981 19.0933C16.0554 19.0898 16.0109 19.0864 15.9638 19.0821C15.7773 19.065 15.5412 19.0272 15.2443 18.8994C14.95 18.7682 14.7549 18.6104 14.624 18.468C14.553 18.3985 14.5017 18.3299 14.4538 18.2647C14.4033 18.2004 14.3656 18.1369 14.3289 18.0734C14.1834 17.8195 14.0619 17.5622 13.8857 17.0647C13.8429 16.9404 13.8104 16.8314 13.7779 16.7354C13.7497 16.6385 13.7231 16.5544 13.6983 16.4772C13.6752 16.4009 13.6547 16.3314 13.6342 16.2671C13.6239 16.2336 13.6136 16.2044 13.6042 16.171C13.5957 16.1367 13.5871 16.1024 13.5777 16.0689C13.5606 16.0003 13.5443 15.9325 13.5264 15.8596C13.5144 15.7867 13.5041 15.7078 13.493 15.6212C13.4802 15.5337 13.4776 15.4376 13.4784 15.3278C13.4784 15.2729 13.4784 15.2146 13.4802 15.1529C13.487 15.0911 13.493 15.0259 13.5007 14.9564C13.5127 14.8166 13.54 14.6966 13.564 14.5902C13.576 14.537 13.5862 14.4864 13.5999 14.4392C13.6153 14.3929 13.6299 14.3492 13.6436 14.3071C13.6727 14.2239 13.6958 14.1493 13.7248 14.0807C13.7565 14.0129 13.7864 13.9495 13.8155 13.886C13.9422 13.6381 14.0705 13.3851 14.4255 12.9536C14.5102 12.8421 14.6018 12.7607 14.6779 12.6826C14.7164 12.644 14.7524 12.6071 14.7866 12.5728C14.8234 12.5419 14.8584 12.5119 14.8918 12.4845C14.9585 12.4279 15.0193 12.3773 15.0758 12.3301C15.1339 12.2838 15.193 12.2469 15.2494 12.2066C15.3076 12.1671 15.3649 12.1277 15.4265 12.0856C15.4898 12.0479 15.56 12.0127 15.637 11.9724C15.6755 11.9527 15.7166 11.9321 15.7593 11.9098C15.7807 11.8995 15.803 11.8883 15.8261 11.8772C15.85 11.8686 15.874 11.8592 15.8996 11.8498C16.0006 11.812 16.1144 11.7708 16.2444 11.7254C16.5088 11.6611 16.709 11.6079 16.8741 11.5941C17.0392 11.5727 17.171 11.5556 17.3096 11.5564C17.378 11.5547 17.4456 11.553 17.5183 11.5513C17.5902 11.5487 17.6706 11.5581 17.757 11.5616C17.8443 11.5667 17.9393 11.5684 18.0505 11.589C18.1609 11.6053 18.2849 11.6199 18.4261 11.6611C18.7101 11.7297 18.9103 11.8326 19.0677 11.9201C19.2226 12.0127 19.3372 12.0968 19.4416 12.1843C19.4972 12.2272 19.5443 12.2709 19.5965 12.3172C19.6504 12.3635 19.7017 12.4116 19.7582 12.463C19.872 12.5642 20.0029 12.6878 20.156 12.7847C20.2321 12.831 20.2929 12.861 20.3459 12.8765C20.3596 12.8807 20.3707 12.8876 20.3853 12.891C20.4007 12.8936 20.4152 12.897 20.4298 12.8996C20.4589 12.9048 20.4854 12.9133 20.5119 12.9159C20.6171 12.9271 20.7036 12.9305 20.7882 12.9193C20.8302 12.9142 20.8729 12.9108 20.9157 12.8962C20.9371 12.891 20.9594 12.885 20.9833 12.8799C21.0047 12.8713 21.0278 12.8619 21.0518 12.8516C21.145 12.8113 21.2562 12.7521 21.3563 12.6311C21.4564 12.5093 21.4932 12.3893 21.5206 12.2889C21.5309 12.2366 21.5334 12.186 21.5403 12.1405C21.5446 12.0942 21.5386 12.0462 21.5403 12.0016C21.5428 11.957 21.5343 11.9089 21.5266 11.8583C21.518 11.8077 21.518 11.7554 21.5001 11.6936C21.4847 11.6336 21.4727 11.5633 21.4522 11.4921C21.4308 11.4217 21.4051 11.3428 21.3649 11.2545C21.2862 11.0778 21.2032 10.95 21.1322 10.8445C21.0577 10.7407 20.9944 10.6566 20.9251 10.5777C20.8918 10.5374 20.8558 10.498 20.8156 10.4577C20.7771 10.4156 20.7326 10.3745 20.683 10.3281C20.5821 10.2381 20.4572 10.1317 20.2732 10.0091C19.9019 9.76804 19.6906 9.68141 19.4844 9.59478C19.2748 9.5133 19.066 9.42924 18.6314 9.30144C18.1959 9.17792 17.9684 9.14876 17.7442 9.11874C17.5192 9.09215 17.2933 9.06556 16.8407 9.04498C16.7287 9.04155 16.6371 9.04841 16.5524 9.04926C16.4686 9.05184 16.3942 9.05355 16.3274 9.06642C16.2607 9.07671 16.2008 9.08615 16.1443 9.09472C16.0879 9.10416 16.0348 9.11102 15.9826 9.12732C15.7739 9.18221 15.5643 9.22682 15.1579 9.37863C14.7541 9.5356 14.5599 9.64196 14.3682 9.74831C14.3203 9.77576 14.2724 9.80321 14.2219 9.83237C14.1714 9.86239 14.1201 9.89756 14.0619 9.9353C14.0328 9.95417 14.0029 9.9739 13.9704 9.99534C13.9139 10.0382 13.854 10.0837 13.7907 10.1326C13.7257 10.1832 13.6564 10.2364 13.582 10.293C13.5649 10.305 13.5426 10.3264 13.5212 10.3462C13.4998 10.3659 13.4784 10.3856 13.4562 10.4062C13.4126 10.4474 13.3672 10.4885 13.321 10.5323C13.2748 10.5752 13.2295 10.6172 13.1858 10.6584L13.1533 10.6884L13.1225 10.7124C13.102 10.7278 13.0823 10.7433 13.0626 10.7587C12.9839 10.8188 12.9104 10.8745 12.8411 10.9277C12.8017 10.9637 12.7846 10.9543 12.7624 10.9594C12.741 10.962 12.7196 10.9637 12.699 10.9663C12.6785 10.968 12.6588 10.9706 12.6392 10.9723L12.6109 10.9749C12.6024 10.9749 12.5981 10.9732 12.5912 10.9723C12.5442 10.9637 12.4937 10.9569 12.4706 10.9466C12.4569 10.9423 12.4398 10.9371 12.4304 10.9337C12.4176 10.9268 12.4167 10.9346 12.3799 10.9088C12.3679 10.8942 12.3551 10.8805 12.3431 10.8659C12.3312 10.8505 12.3183 10.8291 12.3055 10.8102C12.2927 10.7887 12.2798 10.775 12.267 10.745C12.2542 10.715 12.2405 10.6832 12.2268 10.6506C12.2199 10.6343 12.2122 10.6172 12.2054 10.6L12.1943 10.5743C12.1908 10.5657 12.1926 10.5451 12.1908 10.5306C12.1883 10.4679 12.1857 10.401 12.1831 10.3307C12.1814 10.2955 12.1797 10.2595 12.1789 10.2226C12.1789 10.2038 12.1763 10.1866 12.1772 10.1652C12.1797 10.142 12.1814 10.1189 12.184 10.0948C12.1934 9.99963 12.2028 9.89927 12.2131 9.7912C12.2319 9.57419 12.2542 9.39493 12.2721 9.23025C12.2807 9.14962 12.2892 9.07414 12.2969 9.00295C12.3021 8.96092 12.3072 8.92146 12.3115 8.88372C12.3303 8.73276 12.3448 8.61182 12.3602 8.49003C12.3919 8.24815 12.4218 8.00627 12.4929 7.52336C12.5639 7.04046 12.6143 6.80116 12.6648 6.56185C12.6896 6.44177 12.7153 6.32254 12.747 6.17244C12.7769 6.02234 12.8137 5.84222 12.8616 5.60205C12.9583 5.12172 12.9882 4.87555 13.0199 4.62853C13.037 4.50073 13.0455 4.39351 13.0678 4.24855C13.0934 4.10617 13.1114 3.93806 13.1508 3.71676C13.1645 3.60697 13.1764 3.51091 13.1867 3.42513C13.1961 3.33936 13.1978 3.26731 13.2038 3.19955C13.2064 3.1661 13.2089 3.13436 13.2115 3.10349C13.2115 3.07347 13.2115 3.04516 13.2115 3.01771C13.2115 2.96282 13.2124 2.9105 13.2132 2.85818C13.2124 2.80757 13.2055 2.75868 13.203 2.70636C13.2012 2.67977 13.1987 2.65318 13.197 2.62487C13.1918 2.59914 13.1867 2.57169 13.1816 2.54339C13.1764 2.51508 13.1704 2.48506 13.1653 2.45333C13.1576 2.42331 13.1465 2.395 13.1362 2.36327C13.1268 2.33153 13.1174 2.29636 13.1003 2.26806C13.0926 2.25262 13.0857 2.23718 13.078 2.22088C13.0712 2.20373 13.0635 2.18657 13.0524 2.17456C12.9771 2.0562 12.9087 2.0116 12.8376 1.98586C12.8291 1.98158 12.8214 1.97814 12.8137 1.97386C12.8043 1.97214 12.7957 1.97043 12.7863 1.96785C12.7683 1.96356 12.7521 1.95927 12.7367 1.95499C12.699 1.95327 12.6665 1.94727 12.6306 1.94727C12.6118 1.94727 12.593 1.94898 12.5733 1.94898C12.5545 1.94898 12.5356 1.94898 12.5091 1.95241C12.4595 1.9567 12.4056 1.96013 12.3568 1.97043C12.3303 1.97386 12.3038 1.97814 12.2807 1.98501C12.2567 1.99187 12.2276 1.9953 12.2062 2.00559C12.1831 2.01503 12.1566 2.02017 12.1352 2.03475C12.1233 2.04076 12.1113 2.04591 12.0984 2.05105C12.0873 2.05963 12.0753 2.06735 12.0625 2.07593C11.9616 2.14026 11.8786 2.24576 11.811 2.33753C11.7425 2.43188 11.6895 2.5228 11.6382 2.61458C11.5346 2.79985 11.4354 3.00399 11.2609 3.43714C11.1753 3.64986 11.112 3.8094 11.0581 3.9432C11.0051 4.06586 10.9666 4.17822 10.9238 4.28372C10.8408 4.49901 10.7621 4.72202 10.6611 5.18519C10.5636 5.65094 10.5362 5.88939 10.5088 6.12698C10.4823 6.36543 10.4541 6.60302 10.3762 7.07649C10.2231 8.02428 10.2487 8.02857 10.1102 8.98065C10.0426 9.45669 10.0041 9.69428 9.96556 9.93187C9.94674 10.0511 9.92877 10.1695 9.90567 10.3187C9.89541 10.3933 9.88343 10.4748 9.8706 10.5683C9.86461 10.6146 9.85776 10.6644 9.85092 10.7167C9.8475 10.7433 9.84408 10.7699 9.84065 10.7982C9.83894 10.8119 9.83723 10.8265 9.83552 10.8411L9.83295 10.8625V10.8677L9.82868 10.89L9.82269 10.9191C9.81841 10.9388 9.81328 10.956 9.80643 10.9766C9.7782 11.0598 9.72344 11.1473 9.64644 11.2116C9.5703 11.2759 9.48132 11.3145 9.39919 11.33C9.31449 11.3454 9.23321 11.3411 9.15194 11.318C9.07151 11.2957 8.98767 11.2493 8.91923 11.1799C8.88415 11.1447 8.85421 11.1035 8.83111 11.0606C8.81913 11.0392 8.80886 11.0169 8.80031 10.9937C8.79261 10.9732 8.78576 10.9509 8.78063 10.9294C8.76951 10.8831 8.76608 10.8488 8.76523 10.8093V10.7459C8.76694 10.7175 8.76779 10.6892 8.76865 10.6627C8.77036 10.6086 8.77207 10.5589 8.77464 10.5108C8.77806 10.4156 8.78148 10.3324 8.78405 10.2561C8.78918 10.1043 8.79432 9.98247 8.79859 9.86068C8.80801 9.61794 8.81656 9.37434 8.84565 8.88887C8.87559 8.40254 8.92008 8.16152 8.96457 7.92049C9.00992 7.67947 9.0544 7.43931 9.09804 6.95383C9.14167 6.4675 9.16391 6.22391 9.1853 5.98031C9.20755 5.73414 9.23321 5.49483 9.28711 5.02137C9.33845 4.5479 9.34786 4.31117 9.3547 4.07701C9.35812 3.84371 9.36839 3.60612 9.35812 3.15838C9.34101 2.71493 9.29053 2.52023 9.23407 2.36069C9.20498 2.2835 9.1699 2.21745 9.12627 2.16856C9.10488 2.14283 9.08264 2.12224 9.05355 2.10595C9.03815 2.09737 9.02189 2.08879 9.0005 2.08107C8.99623 2.07764 8.96457 2.06906 8.94404 2.0622C8.92094 2.05534 8.89698 2.04762 8.87217 2.0399C8.48546 1.9344 8.3751 1.98501 8.23051 2.02789C8.16036 2.05963 8.08934 2.09051 7.99695 2.15998C7.95075 2.18915 7.90027 2.23632 7.84124 2.28264C7.78391 2.33753 7.71804 2.39586 7.64532 2.47563C7.57174 2.55111 7.51014 2.6283 7.45453 2.69349C7.42715 2.7278 7.40234 2.76039 7.37838 2.79127C7.36641 2.80671 7.35443 2.82129 7.34331 2.83587C7.33218 2.85046 7.31935 2.86589 7.31593 2.87361C7.30481 2.89248 7.29368 2.90964 7.28256 2.92594C7.27144 2.94824 7.26117 2.96968 7.25005 2.99027C7.22866 3.02801 7.2107 3.07947 7.19187 3.12321C7.12001 3.31277 7.049 3.51948 6.93607 3.96636C6.82399 4.41495 6.77864 4.64911 6.72988 4.87984C6.68368 5.11229 6.63662 5.34473 6.56048 5.81563C6.41247 6.76084 6.42445 6.76342 6.2944 7.71635C6.16864 8.67186 6.12073 8.66586 5.99753 9.62566C5.93422 10.1068 5.90256 10.3479 5.87091 10.588C5.8538 10.709 5.83754 10.8291 5.81615 10.98C5.80503 11.0555 5.79305 11.1387 5.77936 11.233C5.77252 11.2802 5.76482 11.3308 5.75626 11.384L5.75284 11.4046L5.74685 11.4372C5.74172 11.4612 5.73488 11.4852 5.72718 11.5084C5.71691 11.535 5.70493 11.5616 5.69039 11.5864C5.63221 11.6928 5.51928 11.7803 5.41062 11.812C5.30111 11.8463 5.19588 11.842 5.09407 11.8077C4.99397 11.7734 4.88874 11.6971 4.82543 11.5847C4.79292 11.5281 4.77495 11.4706 4.76554 11.4123C4.76212 11.3866 4.75955 11.3608 4.75955 11.3343V11.3128C4.76041 11.2982 4.76126 11.2828 4.76212 11.2674C4.78436 10.7776 4.77495 10.5323 4.77067 10.2861C4.76383 10.0399 4.76126 9.79377 4.80233 9.30573C4.84853 8.81768 4.87762 8.57494 4.91013 8.3322C4.94178 8.08947 4.97344 7.84759 5.03675 7.36297C5.16765 6.39717 5.24465 6.40746 5.39009 5.45023C5.46281 4.97334 5.49618 4.73574 5.52612 4.50073C5.54238 4.38236 5.5535 4.26828 5.57061 4.12333C5.5766 4.05385 5.58344 3.97665 5.59114 3.89002C5.59285 3.81111 5.60055 3.72019 5.59371 3.62842C5.58344 3.44143 5.54665 3.3325 5.51329 3.26474C5.47821 3.19612 5.44827 3.16095 5.40549 3.13179C5.38838 3.11292 5.35843 3.1052 5.33362 3.08805C5.30026 3.07775 5.27031 3.06146 5.2224 3.05288C5.13171 3.03229 5.00167 3.01771 4.80404 3.03744C4.75356 3.0443 4.70651 3.05031 4.66287 3.05545C4.61753 3.06403 4.57475 3.07261 4.53454 3.08033C4.48749 3.08805 4.47294 3.09577 4.44899 3.10177C4.42674 3.10863 4.40621 3.11978 4.38568 3.12664C4.30525 3.16438 4.24194 3.21499 4.17863 3.2716C4.11532 3.32735 4.05458 3.39769 3.98015 3.49289C3.90657 3.5881 3.8193 3.71333 3.71578 3.90032C3.51302 4.27943 3.42575 4.49387 3.33421 4.70144C3.24694 4.91244 3.16053 5.12687 3.0399 5.57803C2.92354 6.03092 2.86793 6.26079 2.81232 6.49066C2.75757 6.72053 2.70367 6.95126 2.62923 7.4213C2.55651 7.89133 2.5317 8.12892 2.50689 8.36651C2.48208 8.6041 2.45812 8.84169 2.4162 9.31688C2.36915 9.79034 2.37 10.0331 2.36487 10.2732C2.36059 10.5134 2.3546 10.7536 2.32637 11.2348C2.26563 12.1963 2.30669 12.1988 2.25365 13.1621C2.20488 14.1262 2.21943 14.127 2.17323 15.0911C2.13131 16.0561 2.05687 16.0526 2.01752 17.0184C1.97731 17.9842 1.99185 17.9842 1.95421 18.95C1.92683 19.5939 1.89974 20.2378 1.87293 20.8816C1.83785 21.8474 1.80277 21.8466 1.76855 22.8124C1.73604 23.7791 1.75657 23.7791 1.72578 24.7457C1.70353 25.3902 1.68129 26.0346 1.65904 26.679C1.65134 26.9209 1.64963 27.1019 1.65049 27.2529C1.65049 27.2906 1.65049 27.3266 1.65134 27.3609C1.65134 27.3918 1.65134 27.4416 1.65391 27.4338C1.65648 27.4433 1.6599 27.4518 1.66332 27.4579C1.66674 27.4639 1.67016 27.4707 1.67273 27.4759L1.67701 27.4836C1.67701 27.4836 1.67872 27.4896 1.68556 27.487C1.69583 27.4844 1.70439 27.4819 1.7138 27.481C1.71808 27.481 1.72235 27.4802 1.72749 27.4793H1.73433C1.74973 27.4793 1.76599 27.4793 1.78224 27.4793C2.7473 27.4793 2.7473 27.5676 3.71236 27.5676C4.67742 27.5676 4.67742 27.5188 5.64248 27.5188C6.60753 27.5188 6.60753 27.5702 7.57259 27.5702C8.2154 27.5691 8.85848 27.5679 9.50186 27.5668C10.4669 27.5668 10.4669 27.4321 11.432 27.4321C12.397 27.4321 12.397 27.5411 13.3621 27.5411C13.8446 27.5411 14.0859 27.5282 14.3271 27.5153C14.3571 27.5136 14.387 27.5119 14.4178 27.5102C14.4281 27.5102 14.4272 27.5102 14.429 27.5093H14.4324L14.4384 27.5059C14.4452 27.5033 14.4529 27.5007 14.4615 27.4973C14.4692 27.4947 14.4769 27.493 14.4854 27.4913C14.4854 27.481 14.4837 27.469 14.4846 27.4561C14.4811 27.0762 14.4786 26.8857 14.4769 26.6962C14.4734 26.4526 14.4829 26.2107 14.4974 25.7261C14.5214 25.0799 14.5453 24.4338 14.5693 23.7876C14.5735 23.6864 14.577 23.5955 14.5795 23.5123C14.5855 23.3888 14.5907 23.2781 14.5949 23.1761C14.6018 23.0483 14.6078 22.9325 14.6129 22.8227C14.6163 22.7686 14.6172 22.7155 14.6249 22.6674C14.6317 22.6203 14.6428 22.5782 14.6582 22.5422C14.6873 22.4702 14.7241 22.4135 14.7609 22.3724C14.7797 22.3484 14.7986 22.3329 14.8174 22.3132C14.8285 22.3029 14.8328 22.2978 14.849 22.2857C14.8687 22.272 14.8756 22.2737 14.8875 22.2686C14.9106 22.2617 14.9337 22.254 14.9662 22.2471C14.9816 22.2437 14.9979 22.2403 15.0142 22.2377C15.0338 22.236 15.0535 22.2343 15.074 22.2326C15.0954 22.2326 15.1125 22.2266 15.1391 22.23C15.1647 22.2326 15.1921 22.236 15.2195 22.2394C15.27 22.2386 15.3393 22.2686 15.4069 22.2926C15.4839 22.3312 15.578 22.3629 15.6892 22.405C15.7431 22.4238 15.7918 22.4367 15.8483 22.4539C15.8757 22.4616 15.9039 22.4702 15.9322 22.4787C15.9493 22.483 15.9655 22.4873 15.9835 22.4916C16.1982 22.5439 16.3634 22.5714 16.5028 22.5877C16.6414 22.6048 16.7535 22.6143 16.8664 22.6185C16.9785 22.6254 17.0914 22.6271 17.2326 22.6297C17.3027 22.6288 17.3832 22.6314 17.467 22.6288C17.55 22.6228 17.6424 22.6263 17.7493 22.6125C17.8554 22.6022 17.9487 22.5928 18.0325 22.5765C18.1155 22.5636 18.1891 22.5508 18.255 22.5345C18.3884 22.5079 18.4937 22.4762 18.5998 22.4487C18.8085 22.3827 19.0233 22.3192 19.4211 22.1219C19.7239 21.9675 19.8694 21.9264 19.9686 21.9632C20.0662 21.9993 20.1175 22.1065 20.1954 22.2154C20.2732 22.3235 20.3622 22.4075 20.3425 22.5233C20.3237 22.6366 20.2022 22.7867 19.8454 22.9676C19.6119 23.0843 19.4331 23.1623 19.2808 23.2224C19.1293 23.2841 19.0044 23.3262 18.8812 23.3699C18.7546 23.4077 18.6297 23.4497 18.4671 23.4857C18.4269 23.4951 18.3842 23.5046 18.3388 23.5157C18.2935 23.5234 18.2447 23.532 18.1934 23.5415C18.142 23.55 18.0881 23.5612 18.0291 23.5681C17.9701 23.5741 17.9076 23.5809 17.84 23.5878C17.7733 23.5964 17.71 23.5998 17.6501 23.6006C17.5902 23.6032 17.5346 23.6049 17.4816 23.6075C17.3763 23.6109 17.2916 23.6075 17.2103 23.6075C17.0495 23.6041 16.9203 23.6015 16.7911 23.5929C16.6619 23.5861 16.5328 23.5749 16.3711 23.5543C16.2094 23.5346 16.0151 23.502 15.7576 23.4403C15.7123 23.4291 15.6721 23.4188 15.6404 23.4111C15.6361 23.4111 15.6336 23.4102 15.6327 23.4111C15.6242 23.4102 15.6199 23.4102 15.6165 23.4111C15.6147 23.4154 15.6199 23.4257 15.6207 23.4308C15.6224 23.4351 15.6242 23.4394 15.6259 23.4445V23.4471C15.6259 23.4788 15.6259 23.5114 15.6242 23.5466C15.6216 23.6255 15.619 23.713 15.6165 23.8091C15.5848 24.7723 15.5164 24.7706 15.4847 25.7347C15.4702 26.2167 15.4539 26.4577 15.4488 26.6979C15.4471 26.818 15.4454 26.9381 15.4436 27.0882C15.4436 27.2872 15.4419 27.5265 15.4411 27.8447C15.4454 27.9562 15.4342 28.0565 15.4051 28.1303C15.3778 28.2058 15.3435 28.259 15.3102 28.3036C15.2973 28.319 15.2854 28.3267 15.2751 28.3345C15.2648 28.3422 15.252 28.3499 15.2409 28.3576C15.2186 28.3731 15.1913 28.3868 15.1656 28.3988C15.1125 28.4237 15.0518 28.4417 14.9868 28.4494C14.8533 28.458 14.7258 28.4528 14.6095 28.4554C14.5162 28.4554 14.429 28.4571 14.3417 28.458C14.1004 28.4614 13.86 28.464 13.3775 28.464C12.4133 28.464 12.4133 28.5017 11.4499 28.5017C10.4866 28.5017 10.4857 28.4691 9.52239 28.4691C8.87959 28.4685 8.23678 28.4677 7.59398 28.4665C6.62978 28.4665 6.62978 28.5463 5.66558 28.5463C5.02277 28.5435 4.37969 28.5406 3.73631 28.5377C2.77211 28.5377 2.77211 28.4262 1.80791 28.4262C1.61284 28.4279 1.44259 28.4288 1.28945 28.4297C1.11406 28.4391 0.995137 28.3902 0.91386 28.3456C0.892471 28.3345 0.876216 28.3224 0.857394 28.3113C0.832583 28.2959 0.82916 28.2718 0.818894 28.2504C0.800927 28.2066 0.782961 28.1638 0.766705 28.1226C0.748739 28.0814 0.731628 28.0411 0.715373 28.0017L0.702539 27.9716L0.69655 27.9571V27.9365C0.693984 27.9099 0.693984 27.8816 0.693128 27.8541C0.687995 27.3095 0.670884 27.1851 0.686284 26.6782C0.716228 25.7115 0.744461 25.7124 0.776116 24.7457C0.806916 23.7791 0.764139 23.7782 0.79665 22.8115C0.830016 21.8449 0.900171 21.8474 0.935248 20.8808C0.971182 19.9141 0.933537 19.9124 0.971182 18.9457C1.00797 17.9791 1.05674 17.9808 1.09695 17.0141C1.1363 16.0475 1.11748 16.0466 1.1594 15.08C1.20475 14.1133 1.25522 14.1159 1.30399 13.1492C1.35703 12.1817 1.32281 12.1808 1.38441 11.2125C1.41264 10.7287 1.4212 10.4851 1.4289 10.2415C1.43831 9.99706 1.43831 9.75603 1.48622 9.26627C1.52985 8.77651 1.54354 8.53205 1.55894 8.28674C1.57434 8.04143 1.58974 7.79526 1.66418 7.30722C1.74032 6.81917 1.81646 6.58072 1.89175 6.34313C1.96875 6.10554 2.04404 5.86966 2.16724 5.38676C2.29471 4.90472 2.36744 4.66198 2.44358 4.41924C2.48294 4.2983 2.52315 4.17651 2.58218 4.0264C2.64207 3.8763 2.7165 3.69618 2.84483 3.46116C2.97316 3.22614 3.09037 3.05288 3.19903 2.91135C3.30768 2.76983 3.41035 2.66004 3.52499 2.55625C3.63964 2.45333 3.76968 2.35383 3.96303 2.26034C4.00923 2.23546 4.0657 2.21745 4.12131 2.19515C4.17692 2.17542 4.24622 2.15741 4.30611 2.14369C4.41134 2.1231 4.5277 2.09908 4.66972 2.0845C5.23438 2.02532 5.60996 2.12482 5.92138 2.33582C6.07709 2.44475 6.21398 2.59399 6.32349 2.79299C6.433 2.99284 6.50316 3.24244 6.52284 3.53835C6.5254 3.61126 6.53054 3.68074 6.52968 3.74421C6.52797 3.80597 6.52626 3.86429 6.5254 3.91919C6.51941 4.02126 6.51428 4.11132 6.51 4.19366C6.49974 4.34977 6.49118 4.47499 6.48348 4.60022C6.46637 4.84725 6.44755 5.09256 6.37397 5.57032C6.22938 6.52411 6.20286 6.51896 6.07453 7.46933C6.01293 7.94451 5.98897 8.1821 5.96844 8.42055C5.9462 8.65814 5.92481 8.89659 5.88032 9.37177C5.84011 9.84695 5.81359 10.0845 5.79305 10.3221C5.78193 10.4405 5.76995 10.5597 5.75883 10.7081C5.74942 10.8565 5.73915 11.0349 5.72803 11.2734C5.72803 11.2879 5.72632 11.3025 5.72632 11.3171V11.3385L5.72461 11.3488V11.3531C6.13271 11.3694 5.16936 11.3334 5.26775 11.3368C5.26603 11.3368 5.26432 11.3368 5.26261 11.3368C5.25149 11.3411 5.26261 11.3343 5.26005 11.3334C5.25833 11.3368 5.26775 11.3437 5.25577 11.3368H5.2532C5.10177 11.3128 4.95034 11.2888 4.79891 11.2656V11.2605L4.80062 11.2511L4.80318 11.2322C4.80489 11.2193 4.80661 11.2073 4.80832 11.1953C4.81174 11.1704 4.81516 11.1473 4.81858 11.1241C4.83142 11.0323 4.84168 10.9509 4.85109 10.8762C4.86906 10.7278 4.88104 10.6086 4.89302 10.4894C4.91612 10.2501 4.93922 10.0108 5.00081 9.53302C5.12401 8.57494 5.14626 8.57751 5.27202 7.61686C5.35929 6.9747 5.45254 6.33198 5.55179 5.68868C5.62964 5.20578 5.66472 4.96133 5.69894 4.71687C5.73659 4.47156 5.7691 4.22797 5.88973 3.73735C6.01464 3.24587 6.10789 2.99713 6.22168 2.74152C6.28585 2.61029 6.3406 2.48421 6.46979 2.30322C6.48519 2.28178 6.50145 2.25862 6.51856 2.23632C6.53225 2.22002 6.54594 2.20287 6.56048 2.18572C6.58871 2.15055 6.61951 2.11367 6.65117 2.07507C6.71619 1.99701 6.79233 1.90953 6.88302 1.81003C7.25176 1.41547 7.52639 1.23364 7.83268 1.10412C7.98839 1.04408 8.1595 0.992614 8.37253 0.980606C8.58385 0.966024 8.83282 0.990898 9.10916 1.06638C9.17846 1.08525 9.2392 1.10498 9.29823 1.12299C9.37096 1.14701 9.45309 1.18046 9.52068 1.21734C9.66013 1.29196 9.76964 1.38288 9.8552 1.47123C10.022 1.65135 10.105 1.81175 10.1726 1.96185C10.2376 2.11281 10.283 2.2612 10.3206 2.43875C10.3574 2.6163 10.3831 2.82301 10.395 3.08805C10.4045 3.35223 10.3968 3.5435 10.3865 3.70218C10.3762 3.86086 10.3625 3.98609 10.348 4.11046C10.318 4.3592 10.2855 4.60537 10.2333 5.09428C10.1786 5.58232 10.1452 5.8242 10.117 6.05836C10.0896 6.2951 10.0614 6.53183 10.0169 7.00787C9.97326 7.48391 9.94246 7.72236 9.91166 7.96081C9.88172 8.19926 9.85092 8.4377 9.82183 8.91717C9.79274 9.39665 9.79702 9.63767 9.8013 9.87869C9.80386 9.99877 9.80558 10.1197 9.80558 10.2698C9.80472 10.3453 9.80386 10.4276 9.80215 10.5211C9.8013 10.5683 9.79959 10.6181 9.79788 10.6704C9.79788 10.697 9.79616 10.7244 9.79531 10.7527C9.79531 10.7664 9.79445 10.781 9.7936 10.7956V10.8179L9.79274 10.8205V10.8222C9.89797 10.8265 8.87474 10.7887 9.30765 10.805C9.30593 10.805 9.30337 10.805 9.30251 10.805C9.29995 10.805 9.29909 10.8059 9.29995 10.805C9.30166 10.8042 9.30166 10.799 9.30166 10.8016C9.30166 10.8042 9.30508 10.8059 9.3008 10.8033C9.29995 10.8033 9.29738 10.8025 9.29567 10.8025C9.72515 10.8565 8.70962 10.7287 8.81399 10.7416V10.7373L8.81571 10.7261L8.81827 10.7047C8.82169 10.6764 8.82512 10.6489 8.82854 10.6223C8.83538 10.5692 8.84137 10.5194 8.84736 10.4722C8.85934 10.3779 8.87046 10.2955 8.87987 10.2201C8.89955 10.07 8.91495 9.94902 8.93035 9.82894C8.962 9.58792 8.99366 9.34775 9.0621 8.86657C9.20241 7.90505 9.16648 7.89991 9.32133 6.93754C9.4009 6.45635 9.46336 6.21876 9.5241 5.98203C9.58741 5.74443 9.64901 5.5077 9.74825 5.02652C9.85349 4.54447 9.89626 4.29916 9.94589 4.05042C9.95957 3.9878 9.97326 3.92519 9.98695 3.85915C10.0006 3.7931 10.0178 3.72277 10.0426 3.64214C10.0665 3.56323 10.093 3.47145 10.1256 3.37796C10.1589 3.28704 10.1957 3.18583 10.241 3.07003C10.425 2.60686 10.5396 2.37442 10.6705 2.14026C10.7013 2.08193 10.7364 2.02275 10.7758 1.96013C10.7946 1.9284 10.8151 1.89666 10.8357 1.86321C10.8588 1.8289 10.8836 1.79373 10.9092 1.75685C10.9571 1.68309 11.0256 1.59989 11.1017 1.50725C11.1462 1.46179 11.1924 1.41376 11.2429 1.3623C11.2994 1.3134 11.3601 1.26023 11.4303 1.20962C11.5047 1.16159 11.5731 1.11355 11.6459 1.08268C11.6818 1.06638 11.716 1.05008 11.7502 1.03464C11.7845 1.02006 11.8178 1.01063 11.8495 0.999476C11.882 0.989183 11.9136 0.979748 11.9436 0.970313C11.9744 0.961736 12.0026 0.957447 12.0309 0.951443C12.0865 0.94115 12.1421 0.928284 12.19 0.925711C12.2388 0.921422 12.285 0.917991 12.3286 0.913703C12.3722 0.91113 12.4107 0.912845 12.4501 0.911987C12.4903 0.912845 12.5237 0.910272 12.5664 0.91456C12.6075 0.917991 12.6486 0.92228 12.6888 0.925711C12.8505 0.942866 13.0207 0.983179 13.2226 1.07152C13.4228 1.1633 13.6598 1.33142 13.8498 1.61533C13.8729 1.65049 13.8994 1.6848 13.9156 1.71911C13.9327 1.75342 13.949 1.78687 13.9653 1.81861C13.9969 1.88294 14.0269 1.94469 14.0423 2.0013C14.0602 2.05877 14.0782 2.11281 14.0944 2.16341C14.1116 2.21488 14.1158 2.2612 14.1261 2.30666C14.1663 2.48849 14.1672 2.62659 14.1783 2.76726C14.1809 2.83673 14.1774 2.90363 14.1766 2.97568C14.1757 3.04773 14.1766 3.12493 14.168 3.20641C14.162 3.28876 14.1552 3.37882 14.1483 3.48174C14.1355 3.5821 14.1218 3.69446 14.1056 3.82312C14.0277 4.32832 13.9618 4.57535 13.9114 4.81466C13.8848 4.92959 13.8592 5.04538 13.8258 5.18863C13.7967 5.33444 13.7565 5.50684 13.7103 5.74015C13.617 6.20675 13.588 6.44434 13.558 6.68107C13.5289 6.91867 13.4998 7.1554 13.4297 7.62887C13.3595 8.10233 13.3142 8.33735 13.2671 8.57323C13.2432 8.69073 13.2209 8.8091 13.197 8.95663C13.1662 9.15734 13.1636 9.15477 13.155 9.23025C13.1431 9.34347 13.1448 9.39064 13.1491 9.42667C13.1491 9.42924 13.1491 9.43181 13.1508 9.43353C13.1542 9.43524 13.1576 9.4301 13.1593 9.42752C13.1645 9.42152 13.1696 9.41466 13.1747 9.4078C13.185 9.39493 13.1961 9.38292 13.2072 9.37006C13.2303 9.34432 13.256 9.31859 13.2911 9.29029C13.2996 9.28257 13.3082 9.27571 13.3159 9.2697C13.3304 9.25855 13.3441 9.2474 13.357 9.23711C13.3706 9.22596 13.3826 9.21566 13.3946 9.20623C13.3989 9.2028 13.3972 9.20366 13.4066 9.19679L13.4331 9.17792C13.4502 9.16592 13.4673 9.15391 13.4836 9.1419C13.5495 9.09472 13.6085 9.05184 13.665 9.01238C13.7223 8.97464 13.777 8.93862 13.8309 8.90259C13.8857 8.86743 13.9387 8.82969 13.9986 8.79452C14.0594 8.76021 14.1235 8.72419 14.1945 8.68387C14.2305 8.66414 14.2673 8.6427 14.3083 8.62212C14.3494 8.60325 14.3939 8.58266 14.4401 8.56122C14.5342 8.52005 14.636 8.46687 14.7618 8.42398C14.8867 8.38024 14.9928 8.33563 15.092 8.30561C15.1913 8.27559 15.2785 8.24986 15.3581 8.22584C15.4368 8.19926 15.5095 8.18296 15.5788 8.16752C15.6481 8.15122 15.7131 8.13578 15.7782 8.1212C16.0391 8.06716 16.3077 8.01999 16.8442 8.02342C17.3575 8.04486 17.6125 8.08861 17.8657 8.13064C17.9923 8.15294 18.1181 8.17867 18.2755 8.21212C18.4321 8.24815 18.6203 8.29017 18.8684 8.36137C19.1165 8.4317 19.2987 8.49775 19.4493 8.55693C19.5999 8.61697 19.718 8.67101 19.8352 8.72676C20.0679 8.84255 20.3014 8.95577 20.7455 9.23968C21.1835 9.5356 21.3717 9.73802 21.5505 9.94045C21.595 9.99191 21.6387 10.0434 21.6832 10.1017C21.7285 10.1583 21.7747 10.2209 21.8243 10.2913C21.9219 10.4328 22.0391 10.6069 22.158 10.8651C22.1879 10.9294 22.2144 10.9912 22.2358 11.0512C22.2598 11.1095 22.2786 11.167 22.2957 11.221C22.3043 11.2485 22.3128 11.2742 22.3214 11.2999C22.3274 11.3248 22.3342 11.3488 22.3402 11.3729C22.3522 11.42 22.3642 11.4646 22.3753 11.5075C22.3864 11.5504 22.3992 11.5899 22.4069 11.6302C22.4146 11.6713 22.4215 11.7108 22.4283 11.7485C22.4352 11.7871 22.442 11.824 22.4489 11.8609C22.4566 11.8978 22.4626 11.9347 22.4634 11.9733C22.4685 12.0496 22.4737 12.1268 22.4771 12.2091C22.4728 12.2932 22.4634 12.3841 22.4514 12.4845C22.4437 12.5351 22.4266 12.5883 22.4121 12.644C22.395 12.6998 22.383 12.7598 22.3531 12.8207C22.3257 12.8816 22.2957 12.9459 22.2615 13.0137C22.2204 13.078 22.1742 13.1458 22.1229 13.2161C21.9022 13.4906 21.6695 13.6227 21.4804 13.7119C21.3829 13.7522 21.2956 13.7882 21.2092 13.8062C21.1664 13.8165 21.1253 13.8268 21.0843 13.8371C21.0432 13.8448 21.003 13.8491 20.9619 13.8543C20.9217 13.8586 20.8806 13.8637 20.8396 13.8688C20.7985 13.8688 20.7566 13.8697 20.7138 13.8706C20.6274 13.874 20.5376 13.8654 20.4375 13.8543C20.387 13.8508 20.3357 13.8397 20.2801 13.8277C20.2527 13.8217 20.2244 13.8157 20.1954 13.8097C20.1808 13.8062 20.1663 13.8028 20.1509 13.8002C20.1355 13.7951 20.1192 13.7899 20.103 13.7839C20.0388 13.7616 19.9678 13.7385 19.8993 13.7085C19.8352 13.6759 19.7642 13.6407 19.6957 13.6004C19.6324 13.5592 19.5725 13.5197 19.5195 13.4812C19.4716 13.4434 19.4271 13.4074 19.3843 13.3739C19.3424 13.3405 19.3107 13.3105 19.2765 13.2804C19.2448 13.2513 19.2149 13.2247 19.1858 13.1981C19.0763 13.096 18.9976 13.0197 18.918 12.9476C18.8787 12.9142 18.8385 12.8773 18.7957 12.843C18.752 12.8113 18.7067 12.7778 18.6545 12.7418C18.6006 12.7126 18.5424 12.6757 18.4723 12.644C18.3996 12.6183 18.3234 12.5771 18.2242 12.5582C18.1754 12.5462 18.1309 12.5334 18.0873 12.5248C18.0428 12.5196 18.0009 12.5153 17.9615 12.5111C17.9222 12.5076 17.8854 12.5025 17.8494 12.5008C17.8127 12.5025 17.7784 12.5033 17.7459 12.5042C17.6809 12.5076 17.6227 12.5093 17.5671 12.5153C17.5106 12.5256 17.4585 12.5359 17.4054 12.5454C17.3524 12.5565 17.301 12.5634 17.2446 12.5762C17.1881 12.5917 17.1282 12.6063 17.0623 12.6217C16.9272 12.6457 16.7766 12.6946 16.5721 12.7426C16.3762 12.8113 16.2248 12.855 16.1118 12.9142C16.0528 12.9399 15.9997 12.9631 15.9501 12.9854C15.9022 13.0111 15.8594 13.0377 15.8141 13.0626C15.7696 13.0875 15.7251 13.1132 15.6781 13.1398C15.6344 13.1724 15.5891 13.2067 15.5378 13.2444C15.5121 13.2633 15.4856 13.2839 15.4573 13.3045C15.4291 13.3259 15.4043 13.3542 15.3752 13.3808C15.347 13.4082 15.3162 13.4374 15.2837 13.4691C15.2674 13.4846 15.2503 13.5 15.234 13.518C15.2186 13.5369 15.2032 13.5558 15.187 13.5755C15.0518 13.7282 14.9748 13.862 14.9046 13.9683C14.8756 14.025 14.849 14.0764 14.8234 14.1244C14.8105 14.1485 14.7986 14.1716 14.7866 14.1948C14.7763 14.2188 14.7678 14.2428 14.7575 14.2668C14.7198 14.3629 14.6771 14.4564 14.6454 14.5816C14.6274 14.6434 14.6035 14.7103 14.5907 14.7909C14.5761 14.8707 14.5513 14.9582 14.5445 15.0611C14.5385 15.1126 14.5325 15.1606 14.5273 15.206C14.5214 15.2515 14.5231 15.2944 14.5205 15.3347C14.5179 15.4153 14.5094 15.4865 14.5145 15.5509C14.5162 15.6152 14.5162 15.6735 14.5162 15.7293C14.5188 15.7842 14.5256 15.8348 14.5291 15.8871C14.5333 15.9866 14.5556 16.1041 14.5804 16.2439C14.5941 16.3134 14.6129 16.3889 14.6334 16.4755C14.6557 16.5604 14.6839 16.6539 14.7173 16.7594C14.8636 17.1745 14.9757 17.3487 15.0886 17.5091C15.1459 17.588 15.2084 17.6609 15.2905 17.7381C15.311 17.7569 15.3333 17.7775 15.3564 17.7981C15.3812 17.8161 15.4069 17.835 15.4342 17.8556C15.4608 17.8779 15.4924 17.895 15.5249 17.9139C15.5574 17.9336 15.5917 17.9551 15.6327 17.9697C15.7097 18.0082 15.7867 18.0254 15.8534 18.046C15.8885 18.052 15.9219 18.058 15.9527 18.064C15.9681 18.0666 15.9835 18.07 15.998 18.0726C16.0134 18.0734 16.0288 18.0743 16.0434 18.076C16.0733 18.0786 16.1016 18.0803 16.1281 18.0829C16.1418 18.0837 16.1555 18.0854 16.1691 18.0863C16.1854 18.0863 16.2008 18.0872 16.2171 18.0872C16.2795 18.0889 16.3385 18.0897 16.3967 18.0906C16.6294 18.0906 16.8638 18.0992 17.3139 18.0649C17.7613 18.0245 17.9692 17.9551 18.1669 17.883C18.2652 17.8461 18.3593 17.8041 18.4714 17.7518C18.5809 17.6969 18.7118 17.6317 18.8539 17.5253C18.9959 17.419 19.0772 17.3238 19.1379 17.2389C19.1696 17.1977 19.1909 17.1557 19.2149 17.1179C19.2337 17.0768 19.2551 17.0416 19.2697 17.0004C19.2851 16.9601 19.3022 16.9215 19.3141 16.8752C19.321 16.8512 19.3278 16.834 19.3355 16.8014C19.3432 16.7705 19.3509 16.738 19.3595 16.7036C19.3937 16.5673 19.4305 16.4026 19.469 16.1796C19.5434 15.7327 19.5614 15.5002 19.5888 15.2601C19.5956 15.1992 19.6025 15.1374 19.6093 15.0731C19.6161 15.0079 19.6247 14.9359 19.6358 14.8544C19.6615 14.6906 19.6777 14.489 19.783 14.1836C19.8925 13.8766 20.0627 13.6578 20.2116 13.5197C20.2493 13.4829 20.2946 13.4511 20.334 13.4203C20.375 13.3902 20.4118 13.3594 20.4546 13.3379C20.5393 13.2933 20.6146 13.2479 20.701 13.223C20.7429 13.2093 20.7848 13.1955 20.8267 13.1818C20.8695 13.1698 20.914 13.1638 20.9594 13.1552C21.05 13.1355 21.145 13.1321 21.2502 13.1286C21.4581 13.1321 21.7071 13.1638 21.9937 13.2882C22.2812 13.4134 22.4514 13.5618 22.5917 13.6819C22.6568 13.7462 22.7192 13.8019 22.7706 13.8586C22.8202 13.9169 22.8681 13.9718 22.9151 14.0267C22.9596 14.0833 22.9981 14.1425 23.0426 14.2042C23.088 14.266 23.1256 14.3355 23.1675 14.4126C23.1881 14.4512 23.2103 14.4924 23.2334 14.5353C23.2539 14.579 23.2728 14.6262 23.2942 14.676C23.3147 14.7266 23.3361 14.7798 23.3592 14.8364C23.3771 14.8921 23.396 14.9513 23.4165 15.0139C23.4593 15.14 23.4841 15.2515 23.508 15.3501C23.5337 15.4496 23.5483 15.5371 23.5619 15.616C23.5919 15.7756 23.6039 15.9025 23.6175 16.0303C23.6415 16.2851 23.6629 16.5381 23.6868 17.0433C23.698 17.2963 23.7057 17.4859 23.7125 17.6446C23.7219 17.8041 23.7288 17.9328 23.7365 18.0606C23.745 18.3196 23.7673 18.5778 23.6492 19.1096C23.5534 19.5187 23.3848 19.6877 23.2659 19.7108C23.1444 19.7349 23.0426 19.6396 22.9237 19.5779C22.8056 19.517 22.6782 19.4707 22.608 19.3763C22.5361 19.2803 22.5293 19.1722 22.6037 18.86L22.6029 18.8634Z",fill:"currentColor"}),(0,a.jsx)("path",{d:"M17.3797 12.7452C17.2873 13.1578 17.2574 13.3894 17.2198 13.6107C17.2026 13.723 17.1864 13.8363 17.177 13.9786C17.171 14.0498 17.1667 14.1287 17.1667 14.2188C17.1667 14.3089 17.1641 14.4092 17.171 14.5242C17.1924 14.983 17.2121 15.212 17.2317 15.4402C17.2429 15.5543 17.254 15.6684 17.2796 15.8073C17.2916 15.8777 17.3045 15.9548 17.3258 16.0398C17.3464 16.1247 17.3678 16.2225 17.4037 16.3262C17.4208 16.3786 17.4371 16.4283 17.4516 16.4746C17.4704 16.5175 17.4875 16.557 17.5047 16.5947C17.5218 16.6325 17.5372 16.6676 17.5534 16.6994C17.5722 16.7294 17.5902 16.7585 17.6073 16.786C17.6723 16.8975 17.7451 16.9678 17.8101 17.0407C17.846 17.0733 17.882 17.1051 17.9179 17.1394C17.9547 17.1728 17.9975 17.2003 18.0394 17.238C18.0599 17.2577 18.0847 17.2706 18.1087 17.2878C18.1335 17.3041 18.1574 17.3246 18.1848 17.3418C18.2131 17.3564 18.2413 17.3735 18.2712 17.3924C18.3012 17.4113 18.3345 17.4216 18.3688 17.4396C18.5065 17.4996 18.6049 17.5091 18.6836 17.5159C18.7221 17.5142 18.7589 17.5193 18.7897 17.5116C18.8059 17.5091 18.8222 17.5099 18.8376 17.5073C18.8521 17.5022 18.8667 17.4988 18.8821 17.4953C18.9428 17.4807 18.9976 17.4507 19.0652 17.3984C19.1379 17.3306 19.2072 17.25 19.2662 17.0922C19.3236 16.9318 19.339 16.7654 19.3501 16.629C19.3552 16.5595 19.3578 16.4961 19.3595 16.4326C19.3603 16.3691 19.3621 16.3099 19.3629 16.2499C19.368 16.008 19.3629 15.7541 19.4485 15.2455C19.4921 14.9916 19.5409 14.8029 19.5888 14.6485C19.6007 14.6099 19.6127 14.573 19.623 14.5379C19.6333 14.5044 19.6512 14.4598 19.6649 14.4229C19.6923 14.3466 19.7265 14.2771 19.7607 14.2085C19.7932 14.139 19.8369 14.0738 19.8779 14.0027C19.925 13.9349 19.9712 13.8611 20.0328 13.7874C20.1517 13.6373 20.3091 13.4666 20.5461 13.289C20.784 13.1132 20.9765 13.0206 21.133 12.9408C21.2913 12.8662 21.4188 12.8104 21.5471 12.7607C21.6755 12.7118 21.8046 12.6663 21.9681 12.6269C22.1306 12.5874 22.3282 12.5514 22.5875 12.5291C23.1059 12.4896 23.3575 12.5016 23.609 12.5042C23.6714 12.5059 23.733 12.5076 23.7998 12.5093C23.816 12.5093 23.8331 12.5102 23.8503 12.5111C23.8708 12.5128 23.8913 12.5136 23.9119 12.5153C23.9546 12.5188 24 12.5222 24.047 12.5265C24.071 12.5282 24.0949 12.5308 24.1198 12.5334C24.1446 12.5376 24.1711 12.5419 24.1976 12.5471C24.2507 12.5574 24.3071 12.5677 24.367 12.5797C24.4859 12.6131 24.6211 12.6483 24.7683 12.7178C24.8435 12.7478 24.9094 12.7864 24.9702 12.8233C25.0318 12.8593 25.0891 12.8945 25.137 12.9348C25.1866 12.9734 25.2328 13.0094 25.2747 13.0463C25.3132 13.0849 25.3492 13.1218 25.3843 13.1569C25.5177 13.2993 25.6016 13.4263 25.6751 13.5532C25.818 13.8088 25.9369 14.0661 26.1115 14.5645C26.1508 14.6888 26.1859 14.7978 26.2167 14.8947C26.2458 14.9908 26.2715 15.0757 26.2954 15.1529C26.339 15.3073 26.3818 15.4231 26.4143 15.5654C26.4306 15.6332 26.4503 15.7018 26.464 15.7756C26.4751 15.8493 26.4862 15.9274 26.4965 16.0149C26.5102 16.1024 26.5076 16.1984 26.5084 16.3082C26.5076 16.3631 26.5102 16.4214 26.5042 16.4832C26.4973 16.545 26.4905 16.6101 26.4836 16.6796C26.4717 16.8194 26.4391 16.9387 26.4178 17.0459C26.3972 17.1539 26.3639 17.2449 26.3365 17.3281C26.2852 17.4962 26.221 17.6223 26.1611 17.7484C26.1457 17.7801 26.132 17.8118 26.1149 17.8427C26.0969 17.8736 26.079 17.9045 26.0593 17.9371C26.0216 18.0014 25.9823 18.0691 25.9387 18.1446C25.8386 18.2887 25.7273 18.4663 25.5425 18.6773C25.5203 18.7039 25.4989 18.7305 25.4775 18.7553C25.4544 18.7785 25.4322 18.8016 25.4108 18.8231C25.3671 18.8668 25.3261 18.908 25.2876 18.9466C25.2482 18.9843 25.214 19.0238 25.1764 19.0538C25.1387 19.0847 25.1036 19.1139 25.0703 19.1422C25.0035 19.1979 24.9428 19.2485 24.8855 19.2966C24.8247 19.3386 24.7674 19.378 24.7101 19.4184C24.6519 19.4578 24.5954 19.499 24.5321 19.5376C24.4671 19.5719 24.3978 19.6088 24.3208 19.6491C24.1677 19.7357 23.9717 19.8026 23.7108 19.8901C23.5782 19.9218 23.4618 19.9493 23.3583 19.9742C23.3327 19.9802 23.307 19.9853 23.283 19.9913C23.2582 19.9948 23.2351 19.9982 23.212 20.0016C23.1658 20.0076 23.1222 20.0136 23.0811 20.0188C22.9981 20.0291 22.9237 20.0376 22.8535 20.0462C22.7817 20.0514 22.7124 20.0514 22.6448 20.0539C22.5763 20.0556 22.5079 20.0574 22.436 20.0591C22.3616 20.0548 22.2829 20.0505 22.1956 20.0454C22.152 20.0428 22.1058 20.0402 22.0579 20.0376C22.0083 20.0308 21.9569 20.0231 21.9013 20.0145C21.8457 20.0059 21.7875 19.9973 21.7251 19.9879C21.6626 19.9742 21.5959 19.9562 21.5257 19.9381C21.4547 19.921 21.3888 19.903 21.329 19.8772C21.2682 19.8541 21.2117 19.8318 21.1578 19.8103C21.0535 19.7632 20.9662 19.7134 20.8858 19.6705C20.8105 19.6216 20.7438 19.577 20.6822 19.5341C20.6231 19.4895 20.5701 19.4458 20.5162 19.4029C20.4135 19.3163 20.316 19.2271 20.2031 19.1242C20.0927 19.0272 19.9601 18.9011 19.8095 18.8094C19.7719 18.7896 19.7385 18.7733 19.7077 18.7553C19.6769 18.7442 19.6487 18.7356 19.623 18.7245C19.5982 18.7124 19.5623 18.7116 19.5349 18.7039C19.5066 18.697 19.4793 18.691 19.4519 18.6901C19.4254 18.6876 19.4006 18.685 19.3757 18.6824C19.3518 18.6799 19.3278 18.6824 19.3056 18.6824C19.2825 18.6824 19.2611 18.6824 19.2389 18.6824C19.2175 18.685 19.1961 18.6884 19.1755 18.691C19.155 18.6944 19.1328 18.6944 19.1122 18.6996C19.0917 18.7047 19.0703 18.7107 19.0489 18.7159C19.0036 18.7236 18.9634 18.7459 18.9146 18.7631C18.8239 18.8085 18.7161 18.8694 18.6177 18.9929C18.5176 19.1147 18.4894 19.2417 18.462 19.3429C18.4569 19.3978 18.4483 19.4458 18.444 19.4921C18.4449 19.541 18.4458 19.5865 18.4466 19.6328C18.4458 19.6782 18.4594 19.728 18.4637 19.7777C18.4671 19.8026 18.4697 19.8292 18.4731 19.8558C18.48 19.8832 18.4868 19.9124 18.4937 19.9433C18.5202 20.0694 18.5536 20.2032 18.6348 20.3799C18.7161 20.5566 18.8017 20.6835 18.8752 20.7881C18.8941 20.8139 18.912 20.8388 18.9291 20.8628C18.948 20.8859 18.9651 20.9082 18.983 20.9297C19.0164 20.9743 19.0523 21.0129 19.0866 21.0532C19.2286 21.2102 19.3783 21.3697 19.7453 21.6167C20.1192 21.856 20.3314 21.9409 20.5393 22.0267C20.7498 22.1065 20.9594 22.1897 21.3957 22.3149C21.6139 22.3775 21.7807 22.4118 21.9201 22.4384C22.0596 22.4642 22.1725 22.4796 22.2855 22.4933C22.5113 22.5182 22.7372 22.5439 23.1906 22.5619C23.4071 22.5576 23.5688 22.5594 23.7022 22.5345C23.769 22.5251 23.8289 22.5165 23.8853 22.5088C23.9418 22.4976 23.994 22.483 24.0462 22.4702C24.0984 22.4573 24.1506 22.4453 24.2062 22.4316C24.2618 22.417 24.3191 22.3964 24.3841 22.3775C24.5142 22.3424 24.6665 22.2875 24.8701 22.2137C25.2747 22.055 25.4647 21.9392 25.6589 21.8354C25.7521 21.7763 25.8505 21.7248 25.9635 21.645C25.9926 21.6253 26.0225 21.6047 26.0541 21.5833L26.0781 21.567L26.0909 21.5584L26.114 21.5404C26.1448 21.5164 26.1765 21.4915 26.209 21.4666C26.274 21.416 26.3425 21.362 26.416 21.3045C26.4511 21.2796 26.4948 21.2359 26.5375 21.1964C26.5803 21.1561 26.6248 21.1149 26.671 21.0721C26.7172 21.0292 26.7617 20.988 26.8045 20.9477C26.8472 20.9108 26.8857 20.8876 26.9251 20.8585C26.9636 20.831 27.0012 20.8044 27.0372 20.7787C27.0551 20.7658 27.0731 20.753 27.0911 20.741L27.1176 20.723C27.1262 20.7161 27.1347 20.7101 27.1407 20.711C27.1895 20.7041 27.2348 20.6981 27.2784 20.6912C27.2896 20.6895 27.2998 20.6887 27.3101 20.6869C27.3212 20.6852 27.3306 20.6844 27.3366 20.6861C27.3503 20.6878 27.364 20.6895 27.3777 20.6912C27.4025 20.6947 27.4342 20.6964 27.4496 20.7015C27.4675 20.7058 27.4846 20.7101 27.5009 20.7144C27.5146 20.717 27.5668 20.7393 27.5958 20.7616C27.6112 20.7727 27.6172 20.7796 27.6241 20.7881L27.6446 20.813C27.6583 20.8302 27.6711 20.8465 27.684 20.8653C27.6977 20.8902 27.7113 20.916 27.7259 20.9425C27.7404 20.9691 27.755 20.9957 27.7695 21.024C27.7789 21.0686 27.7866 21.1209 27.796 21.1724C27.8055 21.2239 27.8149 21.2788 27.8251 21.3362C27.8337 21.3603 27.8251 21.4083 27.8251 21.4469C27.8226 21.4881 27.8209 21.5292 27.8183 21.573C27.8097 21.7445 27.8003 21.9358 27.7892 22.1545C27.7738 22.453 27.7627 22.6777 27.7524 22.8639C27.7439 23.0157 27.737 23.1366 27.7293 23.2584C27.7139 23.5011 27.6977 23.7439 27.666 24.2294C27.5941 25.2003 27.5565 25.1969 27.465 26.1678C27.4153 26.6524 27.4119 26.902 27.4111 27.1448C27.4111 27.3832 27.4085 27.6217 27.376 28.0857C27.3469 28.548 27.346 28.7727 27.3503 28.9923C27.3529 29.1021 27.3589 29.2102 27.3743 29.338C27.382 29.4015 27.3922 29.4709 27.4093 29.543C27.4256 29.615 27.447 29.6931 27.4786 29.7634C27.5428 29.9067 27.5941 29.9324 27.6309 29.9513C27.6703 29.9667 27.7165 29.9727 27.7824 29.9684L27.8072 29.9667C27.8149 29.9667 27.8303 29.9641 27.8414 29.9633C27.8653 29.9607 27.8902 29.959 27.915 29.9564C27.9646 29.9513 28.0125 29.9418 28.0655 29.9333C28.1682 29.9118 28.2717 29.8801 28.3847 29.8097C28.4976 29.7394 28.5729 29.6425 28.6371 29.5567C28.6679 29.5113 28.6978 29.4735 28.7209 29.4263C28.7449 29.3809 28.7714 29.3449 28.7919 29.2977C28.8133 29.2522 28.8347 29.2068 28.8578 29.1587C28.8783 29.1064 28.8997 29.0515 28.9237 28.9898C28.969 28.8645 29.0186 28.7084 29.0725 28.4906C29.1264 28.2667 29.1658 28.0986 29.2 27.9588C29.2359 27.8147 29.2693 27.7006 29.3001 27.5839C29.3634 27.3532 29.4267 27.1208 29.5012 26.6464C29.6457 25.6961 29.5799 25.6866 29.7082 24.732C29.8314 23.7756 29.8049 23.7722 29.9187 22.815C30.0282 21.8569 30.0538 21.8595 30.1556 20.8997C30.1591 20.8696 30.1616 20.8405 30.1651 20.8122L30.1676 20.7916V20.7813L30.1693 20.7761V20.7659L30.1753 20.7315C30.189 20.6466 30.2369 20.5343 30.3148 20.4536C30.3935 20.3687 30.4919 20.3181 30.586 20.295C30.681 20.2718 30.7725 20.2744 30.864 20.3001C30.9539 20.3241 31.0471 20.3773 31.1199 20.4571C31.1566 20.4965 31.1866 20.5411 31.2097 20.5892C31.2311 20.6338 31.2473 20.6844 31.255 20.7264C31.2593 20.747 31.2619 20.7684 31.2636 20.7899L31.2653 20.8165V20.8259C31.2662 20.8516 31.267 20.8756 31.2679 20.8997C31.2713 20.9949 31.2739 21.0789 31.2756 21.1561C31.2798 21.3088 31.2833 21.4314 31.2875 21.5532C31.2935 21.7977 31.2995 22.0422 31.2978 22.5319C31.2952 23.0217 31.2619 23.267 31.2285 23.5106C31.1934 23.755 31.1618 23.9986 31.1335 24.4884C31.1027 24.979 31.0891 25.2252 31.0702 25.4713C31.054 25.7167 31.0292 25.9697 30.9676 26.4474C30.9051 26.9278 30.8846 27.1671 30.8658 27.4064C30.8469 27.6414 30.8281 27.8764 30.7913 28.3465C30.7614 28.8045 30.7776 29.0163 30.8067 29.1965C30.8221 29.2848 30.8461 29.3637 30.876 29.4229C30.8923 29.4504 30.9077 29.4709 30.9248 29.4864C30.9333 29.4941 30.9436 29.5018 30.9582 29.5087C30.9659 29.5121 30.9718 29.5173 30.9838 29.5207L30.9992 29.5267C31.0052 29.5293 31.0215 29.5336 31.0326 29.537C31.2319 29.6013 31.3637 29.6202 31.4629 29.6245C31.563 29.6305 31.6298 29.6125 31.7008 29.5962C31.8377 29.5499 31.9857 29.4898 32.2834 29.1956C32.3202 29.157 32.3544 29.121 32.3869 29.0867C32.4186 29.0498 32.4477 29.0155 32.4759 28.9829C32.5324 28.9194 32.5786 28.8559 32.6222 28.8011C32.6333 28.7873 32.6436 28.7736 32.6539 28.7607L32.6693 28.741L32.6778 28.7273C32.6889 28.7101 32.6992 28.693 32.7095 28.6767C32.7309 28.6347 32.7522 28.5978 32.7719 28.5532C32.8515 28.3739 32.9276 28.1681 33.0585 27.7289C33.1843 27.2846 33.2382 27.053 33.2921 26.824C33.346 26.5941 33.399 26.3625 33.4872 25.8942C33.5736 25.425 33.6095 25.1883 33.6463 24.9516C33.6814 24.7148 33.7164 24.4772 33.7866 24.0029C33.9192 23.0517 33.9688 23.0586 34.0826 22.103C34.1374 21.6253 34.1622 21.386 34.187 21.1467C34.199 21.0275 34.2109 20.9074 34.2255 20.7581C34.2323 20.6835 34.24 20.6012 34.2495 20.5077C34.2537 20.4614 34.258 20.4116 34.2631 20.3584C34.264 20.3456 34.2657 20.3318 34.2666 20.3181L34.2683 20.2975V20.2872L34.2708 20.2735L34.2743 20.2504C34.2768 20.2349 34.2803 20.2195 34.2837 20.204C34.3119 20.0771 34.4077 19.9501 34.5121 19.8875C34.6173 19.8232 34.7209 19.7992 34.8338 19.8052C34.8612 19.8069 34.8911 19.8112 34.9219 19.8181C34.951 19.8241 34.9827 19.8352 35.0152 19.8498C35.0451 19.8627 35.0802 19.8824 35.1127 19.9064C35.1435 19.9278 35.1769 19.9604 35.2042 19.993C35.2316 20.0256 35.2556 20.0659 35.2744 20.1054C35.2932 20.1457 35.3035 20.1835 35.312 20.2238C35.3197 20.2649 35.3206 20.2924 35.3206 20.3284V20.3533L35.3189 20.3661V20.3713C35.3163 20.3996 35.3146 20.427 35.312 20.4536C35.3086 20.5068 35.3052 20.5566 35.3026 20.6037C35.2975 20.6981 35.2932 20.7813 35.2915 20.8568C35.2872 21.0077 35.2881 21.1295 35.2889 21.2505C35.2907 21.4932 35.2924 21.7359 35.2539 22.218C35.1769 23.1821 35.1598 23.1804 35.0862 24.1444C35.0152 25.1077 34.939 25.1025 34.8757 26.0649C34.8449 26.5461 34.8346 26.7854 34.8244 27.0247C34.8201 27.1439 34.8158 27.2623 34.8107 27.4115C34.8073 27.5599 34.7996 27.7323 34.8056 27.9553C34.8115 28.1741 34.8321 28.3207 34.8569 28.4082C34.8637 28.4288 34.8706 28.4451 34.8757 28.4623C34.8808 28.4785 34.8885 28.4846 34.892 28.4966L34.8954 28.5051L34.8988 28.5077C34.8988 28.5077 34.9022 28.5111 34.9031 28.5137C34.9031 28.5197 34.9099 28.5206 34.9125 28.524C34.9279 28.5352 34.9313 28.5463 35.0109 28.56C35.0879 28.572 35.2291 28.5669 35.4327 28.5274C35.4566 28.5223 35.4866 28.518 35.5037 28.5137C35.5191 28.5094 35.5336 28.5051 35.5482 28.5017C35.5764 28.4906 35.6038 28.4828 35.6286 28.4683C35.6543 28.4554 35.6782 28.4434 35.7005 28.4271C35.7236 28.4142 35.7449 28.3979 35.7646 28.3816C35.8459 28.3173 35.9092 28.2521 35.9682 28.1766C36.0281 28.1037 36.0855 28.0214 36.1539 27.9124C36.2223 27.8044 36.3002 27.6646 36.396 27.4673C36.4901 27.2683 36.556 27.113 36.6091 26.9818C36.6638 26.8514 36.7057 26.7442 36.7477 26.637C36.8298 26.4217 36.9111 26.2038 37.0214 25.7475C37.1292 25.2904 37.1823 25.0588 37.2345 24.8281C37.2858 24.5965 37.3371 24.364 37.4064 23.8923C37.474 23.4197 37.4971 23.1821 37.5194 22.9436C37.5442 22.7052 37.557 22.4676 37.6023 21.9915C37.6759 21.0335 37.6246 21.03 37.6836 20.0677C37.7418 19.1044 37.7016 19.1019 37.7538 18.1369C37.8 17.1711 37.7889 17.1711 37.8316 16.2053C37.8753 15.2395 37.9471 15.2421 37.9865 14.2754C38.0267 13.3087 38.0104 13.3079 38.0489 12.3412C38.0757 11.6968 38.1026 11.0521 38.1294 10.4071C38.1627 9.43953 38.2004 9.44125 38.2329 8.47373C38.2654 7.50621 38.244 7.50535 38.2757 6.53783C38.2979 5.89282 38.3199 5.24781 38.3415 4.6028C38.3441 4.48186 38.3467 4.37636 38.3484 4.28115C38.3484 4.25713 38.3484 4.23483 38.3484 4.21253C38.3484 4.20138 38.3484 4.19023 38.3484 4.17994C38.3484 4.16879 38.3484 4.17307 38.3484 4.16964C38.3475 4.16278 38.3467 4.15592 38.3458 4.14992C38.3415 4.1259 38.3355 4.11132 38.3279 4.10188C38.3082 4.09931 38.2868 4.11303 38.2714 4.11646C38.2671 4.11732 38.2637 4.11904 38.2594 4.11989L38.2534 4.12161C38.2329 4.12161 38.2115 4.12161 38.1901 4.12247C38.096 4.12247 37.9899 4.12418 37.8693 4.12504C36.9034 4.12504 36.9034 4.0367 35.9374 4.0367C34.9715 4.0367 34.9715 4.08559 34.0048 4.08559C33.038 4.08559 33.038 4.03412 32.0721 4.03412C31.4281 4.03527 30.7842 4.03641 30.1403 4.03755C29.1743 4.03755 29.1743 4.17222 28.2076 4.17222C27.2408 4.17222 27.2417 4.06328 26.2749 4.06328C25.7915 4.06328 25.5502 4.07615 25.309 4.08902C25.2516 4.09245 25.1952 4.09502 25.1344 4.09845C25.1267 4.10103 25.119 4.1036 25.1105 4.10703C25.1028 4.1096 25.0951 4.11132 25.0857 4.11303C25.0805 4.11218 25.0763 4.11732 25.0788 4.12418C25.0788 4.13019 25.0788 4.13533 25.0788 4.1422L25.0865 4.84468C25.0865 4.8747 25.0874 4.90558 25.0882 4.9356C25.0882 4.96218 25.0891 5.01108 25.0899 5.00078C25.0951 5.06168 25.1011 5.12601 25.1071 5.19806C25.119 5.34902 25.1336 5.53 25.1533 5.77102C25.1995 6.41489 25.2459 7.05876 25.2927 7.70263C25.3004 7.80727 25.3064 7.90162 25.3124 7.98568C25.3209 8.12463 25.3295 8.249 25.3363 8.36308C25.344 8.49346 25.3509 8.61268 25.3569 8.72419C25.3654 8.83655 25.35 8.92661 25.3252 8.9978C25.2987 9.06642 25.267 9.12303 25.2337 9.16677C25.2166 9.19251 25.2012 9.20794 25.1823 9.23025C25.1618 9.2534 25.1156 9.28686 25.0882 9.29629C25.0412 9.31173 24.9856 9.32889 24.9 9.33918C24.882 9.34347 24.8547 9.34175 24.829 9.34175C24.8033 9.34175 24.7768 9.34175 24.7494 9.34175C24.7169 9.33403 24.6836 9.32631 24.6493 9.31773C24.6322 9.31345 24.6151 9.30916 24.5972 9.30573L24.5706 9.29886L24.5415 9.28686C24.4269 9.23711 24.2284 9.16334 24.0137 9.11016C23.5825 9.00724 23.354 8.99609 23.1299 8.9815C23.017 8.9755 22.904 8.97293 22.7629 8.97035C22.6927 8.97121 22.6123 8.96864 22.5276 8.97207C22.4446 8.97807 22.3522 8.97464 22.2452 8.98751C22.1383 8.99866 22.0451 9.00724 21.9621 9.02353C21.8791 9.0364 21.8055 9.04841 21.7388 9.0647C21.6053 9.09129 21.5001 9.12217 21.394 9.15048C21.1844 9.21652 20.9705 9.27999 20.5709 9.47813C20.2681 9.63252 20.1226 9.67455 20.0225 9.63681C19.925 9.60078 19.8737 9.49357 19.795 9.38549C19.7171 9.27742 19.6281 9.19336 19.6478 9.07757C19.6666 8.96435 19.7881 8.81425 20.1449 8.63241C20.3784 8.51576 20.5581 8.4377 20.7104 8.37766C20.8618 8.31505 20.9867 8.27388 21.1108 8.23013C21.2374 8.19154 21.3623 8.15036 21.5257 8.11434C21.6062 8.09375 21.696 8.07574 21.7995 8.05945C21.9022 8.03886 22.0194 8.02599 22.1537 8.01313C22.2204 8.00455 22.2838 8.00198 22.3436 8.00026C22.4035 7.99769 22.46 7.99597 22.513 7.9934C22.6183 7.98997 22.703 7.9934 22.7842 7.9934C22.9451 7.99683 23.0743 8.00026 23.2035 8.00884C23.4618 8.02857 23.7228 8.04058 24.2378 8.16323C24.2472 8.1658 24.2566 8.16752 24.2635 8.16924C24.2669 8.16924 24.2686 8.17009 24.2695 8.16924C24.2789 8.17095 24.284 8.17095 24.2874 8.17009C24.2909 8.16495 24.2832 8.15465 24.2815 8.14951C24.2789 8.14522 24.2772 8.14093 24.2738 8.13493L24.272 8.13235C24.272 8.13235 24.272 8.13407 24.272 8.12806C24.2703 8.10834 24.2686 8.08861 24.2669 8.06802C24.2601 7.98568 24.2532 7.89476 24.2455 7.79355C24.1719 6.8286 24.2395 6.82346 24.166 5.85765C24.1488 5.61663 24.1352 5.43565 24.124 5.28469C24.1189 5.20921 24.1146 5.14145 24.1103 5.07712C24.1078 5.05225 24.1069 5.01622 24.1078 4.99392C24.1078 4.97848 24.1078 4.96304 24.1078 4.9476C24.1078 4.91673 24.1086 4.88671 24.1095 4.85668C24.1112 4.73574 24.1129 4.6148 24.1146 4.46384C24.1155 4.25113 24.1172 3.99638 24.1198 3.65586C24.1292 3.55036 24.1617 3.46888 24.195 3.40626C24.213 3.37367 24.2258 3.35051 24.2507 3.32049C24.2772 3.28961 24.3071 3.26645 24.3311 3.25273C24.4295 3.1884 24.5638 3.14551 24.705 3.15066C24.9308 3.14895 25.1113 3.14809 25.2919 3.14637C25.5331 3.14294 25.7744 3.14037 26.2569 3.14037C27.222 3.14037 27.222 3.10263 28.187 3.10263C29.1521 3.10263 29.1521 3.13522 30.1172 3.13522C30.7605 3.13579 31.4039 3.13665 32.0473 3.13779C33.0123 3.13779 33.0123 3.05803 33.9782 3.05803C34.6222 3.06089 35.2658 3.06374 35.9092 3.0666C36.8751 3.0666 36.8751 3.17811 37.8402 3.17811C37.9608 3.17811 38.0661 3.17639 38.161 3.17468C38.3047 3.17125 38.4314 3.16782 38.546 3.16524C38.682 3.16181 38.8155 3.15066 38.9105 3.18068C38.9601 3.19269 39.0012 3.20984 39.0388 3.227C39.0765 3.24673 39.1047 3.25873 39.1432 3.29219C39.1612 3.30934 39.1791 3.3265 39.1885 3.34193C39.1945 3.36424 39.2005 3.38654 39.2065 3.4097C39.2185 3.45515 39.2313 3.50233 39.2433 3.55036C39.2561 3.59925 39.269 3.649 39.2826 3.70132C39.2895 3.72791 39.2963 3.7545 39.304 3.78195C39.31 3.81111 39.3229 3.83427 39.3194 3.87287C39.3194 3.99552 39.3177 4.13019 39.3169 4.28286C39.3169 4.37721 39.3143 4.48357 39.3109 4.60451C39.2818 5.57203 39.2527 5.57117 39.2219 6.53869C39.1902 7.50621 39.2347 7.50793 39.2022 8.47544C39.1697 9.44296 39.0987 9.44039 39.0645 10.4088C39.0294 11.3771 39.0653 11.378 39.0294 12.3464C38.9909 13.3148 38.9447 13.3122 38.9045 14.2806C38.8643 15.2481 38.8865 15.2489 38.8429 16.2173C38.8001 17.1848 38.7471 17.1831 38.7 18.1506C38.6478 19.119 38.6812 19.1199 38.623 20.0891C38.564 21.0583 38.6042 21.0618 38.5306 22.0344C38.4391 23.014 38.5024 23.0191 38.3689 23.9961C38.2979 24.4841 38.226 24.7243 38.1542 24.9619C38.0815 25.2003 38.0087 25.437 37.8949 25.9217C37.7786 26.4054 37.7119 26.649 37.6434 26.8917C37.5707 27.1345 37.5057 27.3798 37.2884 27.8558C37.1771 28.0934 37.0762 28.2701 36.9846 28.4159C36.894 28.5617 36.8092 28.6767 36.7177 28.789C36.6236 28.9006 36.5209 29.0112 36.3652 29.1356C36.2857 29.1965 36.1941 29.2608 36.0743 29.3208C36.0444 29.3354 36.0136 29.3509 35.9811 29.3654C35.9469 29.3783 35.9126 29.392 35.8758 29.4058C35.8399 29.4203 35.8006 29.4289 35.7603 29.4409C35.7398 29.4461 35.7193 29.4512 35.6987 29.4572C35.6816 29.4606 35.6645 29.4641 35.6474 29.4675C35.3805 29.5224 35.1521 29.5404 34.9322 29.5155C34.9048 29.5121 34.88 29.5113 34.8526 29.5061C34.8244 29.5001 34.797 29.4941 34.7705 29.4881C34.7174 29.4761 34.667 29.4641 34.6113 29.4392C34.5044 29.4006 34.4069 29.3397 34.3187 29.2702C34.2768 29.2325 34.2366 29.193 34.1981 29.1519C34.1639 29.1073 34.1297 29.0609 34.0972 29.0112C34.0681 28.9632 34.0467 28.916 34.0219 28.8645C33.9971 28.8131 33.9851 28.7659 33.9671 28.7119C33.9055 28.5043 33.8816 28.2838 33.8713 28.0188C33.8627 27.7563 33.8662 27.5651 33.8653 27.4107C33.8636 27.2546 33.8627 27.1336 33.8593 27.0093C33.855 26.7639 33.8508 26.5186 33.8824 26.034C33.9466 25.0639 33.9714 25.0665 34.0424 24.099C34.1151 23.1323 34.0955 23.1306 34.1725 22.1648C34.2109 21.6819 34.2383 21.4409 34.2649 21.1999C34.2777 21.0789 34.2905 20.9588 34.3068 20.8079C34.3136 20.7324 34.3222 20.6492 34.3307 20.5557C34.335 20.5085 34.3393 20.4588 34.3444 20.4056C34.347 20.379 34.3487 20.3516 34.3513 20.3233L34.353 20.3018V20.2907L34.3547 20.2855V20.2838C33.9714 20.2512 34.8774 20.3275 34.7842 20.3198H34.7876C34.8098 20.3207 34.8098 20.313 34.803 20.3224C34.7961 20.331 34.7944 20.3473 34.7953 20.3473C34.7953 20.349 34.7927 20.3378 34.7884 20.3336C34.7842 20.3284 34.7825 20.331 34.7944 20.3327L35.2239 20.3713V20.3807L35.2222 20.391L35.2205 20.4116C35.2162 20.4656 35.2119 20.5154 35.2077 20.5634C35.2 20.6586 35.194 20.7418 35.188 20.8182C35.1777 20.97 35.17 21.0918 35.1615 21.2136C35.1452 21.4572 35.1298 21.7008 35.0751 22.1845C34.9604 23.1529 34.9365 23.1495 34.8021 24.1161C34.7328 24.599 34.6935 24.8409 34.655 25.0819C34.6148 25.323 34.5763 25.5648 34.4873 26.0477C34.3975 26.5306 34.3555 26.7742 34.3136 27.0187C34.27 27.2631 34.2281 27.5076 34.092 27.9956C33.9483 28.4854 33.8439 28.7324 33.7147 28.988C33.6848 29.0507 33.6429 29.1184 33.6009 29.1887C33.5821 29.2222 33.5513 29.2634 33.5239 29.3028C33.5094 29.3226 33.4949 29.3431 33.4795 29.3637C33.4649 29.3826 33.4538 29.3946 33.441 29.4109C33.3366 29.5361 33.2168 29.6871 33.0252 29.8844C32.6402 30.2755 32.3416 30.4513 32.0173 30.5543C31.9369 30.5826 31.8505 30.5963 31.7607 30.6143C31.6708 30.6237 31.5733 30.6357 31.4698 30.6314C31.2619 30.6289 31.0266 30.5894 30.7614 30.5062C30.7451 30.5011 30.728 30.4959 30.7126 30.4908C30.6964 30.4856 30.6835 30.4822 30.6587 30.4728C30.6151 30.4556 30.5732 30.4419 30.5321 30.4204C30.45 30.381 30.3738 30.3338 30.3071 30.2815C30.1728 30.1769 30.0778 30.0568 30.0153 29.9504C29.9803 29.8964 29.958 29.8466 29.9332 29.7977C29.9135 29.7506 29.8921 29.7034 29.8776 29.6605C29.8468 29.573 29.8254 29.4941 29.8074 29.4169C29.7732 29.2634 29.7535 29.1167 29.7441 28.9434C29.7347 28.7702 29.7347 28.5695 29.751 28.3139C29.7869 27.8052 29.834 27.5659 29.8742 27.3223C29.9161 27.0804 29.9606 26.8403 30.0222 26.3608C30.0846 25.8779 30.1129 25.6498 30.136 25.4139C30.1599 25.1789 30.1813 24.943 30.2113 24.4687C30.2378 23.9935 30.2575 23.755 30.278 23.5174C30.2977 23.279 30.3165 23.0397 30.3199 22.5611C30.3216 22.0816 30.3028 21.8423 30.284 21.603C30.2746 21.4829 30.2643 21.3637 30.2549 21.2144C30.2506 21.1398 30.2463 21.0575 30.2412 20.964C30.2403 20.9408 30.2386 20.9168 30.2378 20.8919C30.2378 20.8799 30.2369 20.8671 30.2361 20.8542V20.8465C29.8194 20.8593 30.8033 20.8276 30.7023 20.8302H30.7032C30.7032 20.8302 30.71 20.8293 30.7109 20.8293C30.7152 20.8276 30.7143 20.8276 30.7135 20.8293C30.71 20.8336 30.7126 20.837 30.7109 20.831C30.7109 20.8293 30.7083 20.8276 30.7109 20.8293C30.7126 20.8302 30.7135 20.8302 30.7169 20.8319C30.7186 20.8319 30.7203 20.8319 30.722 20.8319L31.1874 20.8799V20.8842C31.184 20.9125 31.1815 20.9417 31.178 20.9717C31.0762 21.9384 31.0788 21.9384 30.9684 22.9033C30.8538 23.8683 30.8906 23.8725 30.7665 24.8375C30.6373 25.8024 30.5655 25.7921 30.4192 26.7571C30.3439 27.2391 30.3191 27.4827 30.2925 27.7272C30.2806 27.849 30.266 27.9716 30.2429 28.1243C30.2309 28.2015 30.2198 28.283 30.201 28.3808C30.1813 28.4794 30.1599 28.5892 30.1308 28.7144C30.0059 29.2179 29.9024 29.4744 29.7784 29.7283C29.7501 29.7917 29.7142 29.8552 29.6748 29.923C29.6552 29.9564 29.6355 29.9916 29.6149 30.0276C29.591 30.0636 29.5653 30.1005 29.5388 30.14C29.4327 30.2935 29.2838 30.4899 29.0032 30.6872C28.9331 30.7344 28.8612 30.773 28.7953 30.8099C28.7269 30.8399 28.6619 30.8673 28.6011 30.8913C28.5395 30.9102 28.4813 30.9274 28.4257 30.9419C28.371 30.9557 28.3196 30.9625 28.2709 30.9711C28.2213 30.9805 28.1759 30.9848 28.1331 30.9874C28.0904 30.9908 28.0484 30.9934 28.0082 30.996C27.9287 30.996 27.8628 30.996 27.7824 30.9934C27.6968 30.9883 27.6087 30.9797 27.5111 30.9565C27.4145 30.9351 27.3084 30.8999 27.1972 30.8416C27.0859 30.785 26.9687 30.7009 26.8661 30.5903C26.7625 30.4796 26.6736 30.345 26.6043 30.1957C26.4708 29.8964 26.4426 29.6862 26.4169 29.5138C26.3938 29.3423 26.3895 29.2093 26.3853 29.0772C26.3818 28.8148 26.3852 28.5566 26.4152 28.0565C26.4494 27.5582 26.4776 27.3138 26.5042 27.0676C26.5298 26.8291 26.5555 26.5907 26.6068 26.1138C26.6975 25.1583 26.653 25.154 26.724 24.195C26.7574 23.7147 26.7882 23.4754 26.819 23.2361C26.8344 23.116 26.849 22.9968 26.8635 22.8467C26.8712 22.7721 26.878 22.6889 26.8849 22.5954C26.8892 22.5302 26.8934 22.4581 26.8994 22.3749C26.9054 22.2583 26.9011 22.2103 26.896 22.1708C26.8934 22.1631 26.8986 22.1459 26.8806 22.1494C26.8678 22.1579 26.8592 22.1734 26.8472 22.1854C26.825 22.2111 26.7993 22.2369 26.7643 22.266C26.7514 22.2849 26.3904 22.5534 26.2047 22.6752C25.9857 22.815 25.7675 22.9651 25.2773 23.1615C25.1567 23.2138 25.0438 23.2447 24.9471 23.2816C24.8504 23.3176 24.7623 23.3425 24.6819 23.3648C24.6023 23.3879 24.5304 23.4085 24.462 23.4282C24.3935 23.4454 24.3277 23.4583 24.2626 23.4737C24.1968 23.4883 24.1317 23.502 24.0624 23.5174C23.9923 23.5303 23.917 23.538 23.834 23.5483C23.7502 23.556 23.6586 23.5732 23.5534 23.5749C23.4482 23.5766 23.3301 23.5783 23.1958 23.5809C22.6782 23.5646 22.4249 23.5209 22.1708 23.4806C21.9176 23.4325 21.6643 23.3905 21.1664 23.255C20.6702 23.1135 20.4323 23.0045 20.1971 22.8947C20.0799 22.8381 19.9635 22.7798 19.8198 22.7035C19.6769 22.6254 19.5041 22.5319 19.2833 22.3878C19.0618 22.2437 18.9052 22.1176 18.7803 22.007C18.7178 21.9512 18.6639 21.8972 18.6126 21.8474C18.563 21.7951 18.5168 21.7462 18.4714 21.6948C18.3824 21.5918 18.2952 21.4872 18.1951 21.3465C18.095 21.2067 17.9752 21.0352 17.8529 20.7787C17.7322 20.5223 17.6655 20.3061 17.6253 20.138C17.5731 19.9707 17.5551 19.8215 17.5269 19.6757C17.5209 19.5993 17.5158 19.5221 17.5124 19.4398C17.5089 19.3986 17.5115 19.3557 17.5166 19.3094C17.5209 19.264 17.526 19.2159 17.532 19.1653C17.5355 19.1405 17.5372 19.1147 17.5432 19.0881C17.55 19.0615 17.5568 19.0341 17.5645 19.0058C17.5799 18.95 17.5962 18.89 17.6167 18.8282C17.6433 18.7665 17.6732 18.7022 17.7074 18.6335C17.7228 18.5992 17.7434 18.5649 17.7673 18.5315C17.7904 18.498 17.8144 18.4628 17.8392 18.4268C18.0514 18.1463 18.2798 18.0057 18.4663 17.9088C18.6596 17.823 18.8205 17.7775 18.9822 17.7535C19.0635 17.7441 19.1439 17.7295 19.2303 17.7321C19.2731 17.7321 19.3176 17.7321 19.3638 17.7312C19.41 17.7312 19.4579 17.7389 19.5075 17.7432C19.6084 17.7492 19.7171 17.7758 19.8403 17.8024C19.9053 17.8238 19.9738 17.8479 20.0465 17.8744C20.1175 17.9027 20.1817 17.9405 20.2561 17.9791C20.3263 18.0185 20.3802 18.0589 20.4375 18.0966C20.4922 18.1343 20.5324 18.1695 20.5761 18.2038C20.6197 18.2381 20.6539 18.269 20.6873 18.2982C20.7198 18.3273 20.7506 18.3556 20.7797 18.3822C20.8832 18.48 20.9662 18.5589 21.0492 18.637C21.0894 18.6713 21.1288 18.7056 21.1715 18.7425C21.2143 18.7768 21.2614 18.8085 21.3127 18.8454C21.3649 18.8806 21.4256 18.9097 21.4941 18.9483C21.53 18.9629 21.5677 18.9775 21.6087 18.9938C21.6489 19.0101 21.6917 19.0281 21.7413 19.0375C21.7901 19.0495 21.8354 19.0607 21.8782 19.0718C21.9219 19.0813 21.9646 19.0821 22.004 19.0873C22.0433 19.0907 22.081 19.095 22.1161 19.0984C22.1511 19.1027 22.1862 19.0976 22.2187 19.0967C22.2837 19.0924 22.3419 19.089 22.3975 19.0864C22.4531 19.0796 22.507 19.0667 22.5592 19.0581C22.6114 19.0487 22.6645 19.0392 22.7201 19.0289C22.7765 19.0152 22.8364 19.0006 22.9023 18.9843C22.9682 18.9672 23.0435 18.9578 23.123 18.9355C23.2026 18.9123 23.2916 18.8891 23.3943 18.8651C23.4464 18.8557 23.4901 18.8342 23.5346 18.8205C23.5782 18.8051 23.6184 18.7914 23.6569 18.7785C23.6954 18.7648 23.7322 18.7545 23.7656 18.7416C23.7981 18.727 23.8289 18.7124 23.858 18.6987C23.917 18.673 23.97 18.649 24.0197 18.6275C24.071 18.6069 24.1121 18.5761 24.1574 18.5529C24.2019 18.528 24.2464 18.5023 24.2934 18.4757C24.3405 18.4483 24.3833 18.4105 24.4355 18.3736C24.5407 18.3016 24.6528 18.1961 24.7905 18.046C24.823 18.0065 24.853 17.9697 24.882 17.9345C24.9111 17.9002 24.9385 17.8676 24.959 17.8333C25.0027 17.7664 25.042 17.708 25.0771 17.6549C25.1088 17.5991 25.1336 17.5468 25.1592 17.4988C25.1841 17.4499 25.2106 17.4061 25.2277 17.3572C25.2636 17.2603 25.3107 17.1685 25.3423 17.0424C25.3825 16.9198 25.4185 16.768 25.4476 16.563C25.4578 16.46 25.4741 16.37 25.4732 16.2894C25.4749 16.2087 25.4852 16.1367 25.4818 16.0724C25.4801 16.008 25.4792 15.9497 25.4801 15.8939C25.4818 15.8382 25.4715 15.7876 25.469 15.7361C25.463 15.6829 25.463 15.6358 25.4527 15.5749C25.4424 15.5148 25.4313 15.4514 25.4193 15.381C25.392 15.2412 25.3526 15.0757 25.285 14.863C25.1396 14.4461 25.0292 14.2703 24.9163 14.1082C24.8589 14.0284 24.7973 13.9546 24.7152 13.8757C24.6947 13.8568 24.6724 13.8363 24.6493 13.8157C24.6271 13.7934 24.5989 13.7779 24.5715 13.7565C24.5578 13.7462 24.5441 13.7359 24.5296 13.7247C24.5142 13.7145 24.4979 13.7067 24.4817 13.6973C24.4474 13.6793 24.4158 13.6544 24.3739 13.6398C24.3328 13.6244 24.2986 13.6029 24.2601 13.5935C24.2224 13.5824 24.1873 13.5712 24.154 13.5609C24.1198 13.5532 24.0855 13.5489 24.0547 13.5421C24.0231 13.536 23.9948 13.5292 23.964 13.5283C23.9341 13.5258 23.9059 13.524 23.8793 13.5223C23.852 13.5198 23.828 13.5172 23.7946 13.5172C23.7322 13.5155 23.6732 13.5146 23.6141 13.5129C23.3814 13.512 23.1461 13.5035 22.6953 13.5369C22.2461 13.5764 22.0382 13.645 21.8397 13.7162C21.7422 13.7539 21.6455 13.7934 21.5334 13.8465C21.4231 13.9006 21.2922 13.9666 21.1467 14.0704C21.0038 14.1768 20.9217 14.2711 20.8601 14.3552C20.7977 14.4384 20.7617 14.5147 20.7267 14.5919C20.7121 14.6322 20.6933 14.6708 20.6813 14.7163C20.6745 14.7394 20.6676 14.7626 20.6599 14.7875C20.6522 14.8184 20.6445 14.8509 20.636 14.8853C20.6017 15.0225 20.5641 15.1872 20.5256 15.4102C20.4503 15.8571 20.4323 16.0895 20.405 16.3297C20.3981 16.3906 20.3913 16.4523 20.3844 16.5167C20.3776 16.5818 20.369 16.653 20.3588 16.7354C20.334 16.8983 20.3177 17.0999 20.215 17.4053C20.1081 17.7115 19.9404 17.9345 19.7898 18.0726C19.7556 18.1103 19.7077 18.1421 19.6692 18.1729C19.6281 18.203 19.5913 18.2347 19.5494 18.257C19.5075 18.2801 19.4673 18.3016 19.4271 18.3222L19.3672 18.3522L19.3047 18.3745C19.2209 18.4037 19.1379 18.432 19.0464 18.4448C19.001 18.4517 18.9548 18.4628 18.906 18.4663C18.8581 18.468 18.8077 18.4706 18.7546 18.4731C18.5459 18.4723 18.296 18.4423 18.0086 18.3187C17.7203 18.1952 17.5491 18.046 17.408 17.9276C17.343 17.8633 17.2805 17.8075 17.2275 17.7509C17.177 17.6926 17.1299 17.6377 17.0829 17.5828C17.0367 17.5271 16.999 17.467 16.9545 17.4053C16.934 17.3735 16.9092 17.3418 16.8895 17.3075C16.8698 17.2723 16.8502 17.2354 16.8288 17.1968C16.8082 17.1582 16.786 17.1171 16.7629 17.0742C16.7415 17.0304 16.7235 16.9833 16.7022 16.9335C16.6816 16.8829 16.6602 16.8297 16.6371 16.7731C16.6175 16.7174 16.5995 16.6582 16.579 16.5947C16.5362 16.4678 16.5105 16.3571 16.4866 16.2576C16.4609 16.1581 16.4455 16.0706 16.4318 15.9909C16.4019 15.8313 16.389 15.7035 16.3762 15.5766C16.3522 15.3218 16.3308 15.068 16.306 14.5627C16.2949 14.3097 16.2872 14.1193 16.2804 13.9606C16.271 13.8011 16.2641 13.6724 16.2564 13.5438C16.2479 13.2839 16.2256 13.0257 16.3437 12.493C16.4395 12.0831 16.608 11.9141 16.727 11.8909C16.8484 11.8669 16.9503 11.9621 17.0692 12.0239C17.1872 12.0848 17.3147 12.1311 17.3849 12.2254C17.4567 12.3215 17.4636 12.4296 17.3892 12.7418L17.3797 12.7452Z",fill:"currentColor"})]})}function eR(e){let{message:t,conversationUuid:s}=e,n=(0,g.A)(),{track:l}=(0,B.st)(),r=(e=>{var t;if("assistant"!==e.sender)return!1;let s=null==(t=e.content)?void 0:t.some(e=>{var t,s;if("text"===(t=e).type||"thinking"===t.type||"tool_use"===t.type){return null==(s=e.flags)?void 0:s.includes("self_harm_risk")}return!1});return null!=s&&s})(t),[o,d]=(0,i.useState)(!1),c=(0,i.useRef)(!1);(0,i.useEffect)(()=>{!r||o||c.current||(l({event_key:"claudeai.safety.self_harm_banner.viewed",conversation_uuid:s,message_uuid:t.uuid}),c.current=!0)},[r,o,s,t.uuid,l]);let u=(0,i.useCallback)(()=>{l({event_key:"claudeai.safety.self_harm_banner.dismissed",conversation_uuid:s,message_uuid:t.uuid}),d(!0)},[s,t.uuid,l]),m=(0,i.useCallback)(()=>{l({event_key:"claudeai.safety.self_harm_banner.resources_clicked",conversation_uuid:s,message_uuid:t.uuid})},[s,t.uuid,l]);return!r||o?null:(0,a.jsx)("div",{className:"mb-4 mt-2",children:(0,a.jsxs)("div",{className:"flex gap-2 rounded-[16px] border-[0.5px] border-border-300 bg-bg-200 p-[14px] shadow-sm",children:[(0,a.jsx)("div",{className:"flex items-center justify-center flex-shrink-0 text-text-000 w-[46px] h-[46px]",children:(0,a.jsx)("div",{className:"w-full h-full [&>svg]:w-full [&>svg]:h-full",children:(0,a.jsx)(eL,{})})}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)("p",{className:"font-ui text-[14px] font-[430] leading-[140%] text-text-000",children:(0,a.jsx)(x.A,{defaultMessage:"If you or someone you know is having a difficult time, support is available.",id:"2H7uH+vuKu"})})}),(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-shrink-0",children:[(0,a.jsx)("a",{href:"https://findahelpline.com",target:"_blank",rel:"noopener noreferrer",onClick:m,className:"flex h-9 items-center justify-center rounded-lg border-[0.5px] border-border-200 px-4 font-ui text-[14px] font-medium leading-[140%] text-text-100",children:(0,a.jsx)(x.A,{defaultMessage:"Find resources",id:"ViSIod1c4W"})}),(0,a.jsx)("button",{onClick:u,className:"flex items-center justify-center text-text-400 hover:text-text-500 transition-colors","aria-label":n.formatMessage({defaultMessage:"Dismiss",id:"TDaF6JVgG6"}),children:(0,a.jsx)(G.X,{className:"size-5"})})]})]})})}let eI=e=>{let{title:t,text:s}=e,n=(0,g.A)();t=t||n.formatMessage({defaultMessage:"Untitled note",id:"fkEfiUjl/t"}),s=s||"";let{didCopy:i,copyToClipboard:l}=(0,W.C)(),r=async()=>{let e=t+"\n"+s;try{let t=(0,eC.u)(e);await l({text:e,html:t})}catch(t){await l(e)}};return(0,a.jsxs)("div",{className:"group relative mt-4 mb-1 rounded-2xl border-border-300/25 border font-claude-response-body",children:[(0,a.jsxs)("div",{className:"pt-1 pb-1 px-3 border-b-0.5 border-border-300/25 font-semibold flex justify-between items-center",children:[(0,a.jsx)("span",{className:"flex-1",children:t}),(0,a.jsx)(m.$,{variant:"ghost",size:"icon_sm",onClick:r,children:(0,a.jsx)(W.u,{didCopy:i})})]}),(0,a.jsx)(C.o,{className:"px-4 pt-2 pb-4",children:s})]})};var eU=s(787),eO=s(20804),eF=s(39510),eD=s(78334),eP=s(72062),eB=s(97208),eG=s(7881),eW=s(44007),eV=s(96547),eq=s(50571),eH=s(73648),eY=s(35580);let eJ=(0,i.memo)(e=>{var t,s,n;let{conversationUuid:l,block:r,message:o,updatedMessage:d,index:c,shareType:u,isStreaming:m,isLastMessage:p,publishedArtifacts:f,isFirstBlockOfMessage:h,isLastBlockOfMessage:g,renderMode:x,isFirstItemInGroup:C,isLastItemInGroup:v}=e,j=(0,eB.nb)(),{renderToolUseCell:b}=(0,eG.Q)(),y=(0,eP.Y)(r),w=r.name,_=r.id,k=r.context,N=null==(t=d.content)?void 0:t[c+1],M=(null==N?void 0:N.type)==="tool_result"?N:void 0,S=function(e,t,s,a,n,l){let r=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=null!=l?l:"{}",d=(0,el.M)(),{track:c}=(0,B.st)(),u=(0,eW.p9)(),{mutate:m}=(0,eV.p4)(e),{toggleMcpToolAlwaysApproved:p}=(0,eq.es)(),[f,h]=(0,i.useState)(r),g=(0,eY.pK)(t),x=(null==g?void 0:g.tool)||null,C=(null==g?void 0:g.server)||null,v=u&&(null==C?void 0:C.uuid)&&!(0,eY.HG)(null==C?void 0:C.uuid,u)&&(null==C?void 0:C.type)==="remote",j=(0,eq.yr)()(C,x),b=a?a.includes("always"):!!j.showAlwaysAllowed,y=!!s,w=y&&!!x&&(u&&(null==C?void 0:C.type)==="remote"&&!(0,eY.HG)(C.uuid,u)?!!a&&!!n:j.approvalRequired),_=(0,i.useCallback)(a=>{if(y&&x&&!f){if("always"!==a||n||p(x.alwaysApprovedKey,!0),"deny"===a)if(v)m({tool_use_id:s,is_approved:!1,approval_key:n});else{var i;d(e,t,s,o,{overriddenResult:{content:[{type:"text",text:"The user has chosen to disallow the tool call."}],is_error:!0}}),c({event_key:"mcp.tools.called",result:"disallowed",argument_count:Object.keys(null!=(i=(0,eH.p)(o))?i:{}).length})}else v?m({tool_use_id:s,is_approved:!0,approval_key:n,approval_option:a}):d(e,t,s,o);h(!0)}},[y,f,x,n,p,v,m,d,e,t,s,o,c,h]),k=y&&!w&&!f&&!v&&!!l,N=(0,ev.Z)(e);return k&&(d(e,t,s,o),h(!0)),(0,i.useMemo)(()=>({approvalRequired:w&&!f,disabled:!l,submitToolApproval:_,showAlwaysAllowed:b}),[w,l,f,_,b,N])}(l,r.name,r.id,r.approval_options,r.approval_key,r.buffered_input,!!M),A=j?void 0:S,E=!!d.content&&d.content.length<=c+1&&m,z=((e,t,s)=>{var a,n,i,l;let r,o,d,c=(null==t?void 0:t.type)==="tool_use"&&(null==t?void 0:t.name)==="artifacts",u=(null==e?void 0:e.type)==="tool_use"&&(null==e?void 0:e.name)==="artifacts";s.partial_json?s.partial_json.includes('"command":"create"')&&(r=(e=>{let t=e.match(/"id"\s*:\s*"([^"]*)"/);return t?t[1]:void 0})(s.partial_json)):r=null==(n=s.input)?void 0:n.id,u&&(o=null==e||null==(i=e.input)?void 0:i.id),!c||(null==t?void 0:t.partial_json)||(d=null==t||null==(l=t.input)?void 0:l.id);let m=r===o,p=r===d,f="individual_cell_create",h=null==(a=s.input)?void 0:a.command;if(h&&(f=({create:"individual_cell_create",update:"individual_cell_update",rewrite:"individual_cell_rewrite"})[h]),!c&&!u)return f;if(c&&u)if(!m&&!p)return f;else if(m&&!p)return"multi_edit_last";else return"multi_edit_not_last";if(c&&!u)if(!p)return f;else return"multi_edit_not_last";if(!c&&u&&m)return"multi_edit_last";return f})(null==(s=d.content)?void 0:s[c-2],null==(n=d.content)?void 0:n[c+2],r);if(!b)throw Error("renderToolUseCell() is not provided, missing ChatMessageContext?");let T=(0,i.useMemo)(()=>b({toolUseId:_,input:y,isLastMessage:p,message:o,publishedArtifacts:f,isStreaming:E,toolName:w,toolResult:M,displayData:{integrationName:r.integration_name,integrationIcon:r.integration_icon_url,message:(null==M?void 0:M.message)||r.message,input:r.display_content,result:null==M?void 0:M.display_content},approvalData:A,artifactCellType:z,isFirstBlockOfMessage:h,isLastBlockOfMessage:g,shareType:u,context:k,renderMode:x,groupItemKey:String(c),isFirstItemInGroup:C,isLastItemInGroup:v}),[A,z,r.display_content,r.integration_icon_url,r.integration_name,r.message,k,c,y,h,C,g,v,p,o,f,x,b,u,E,w,M,_]);return(0,a.jsx)(i.Fragment,{children:T})});eJ.displayName="ToolUse";var eK=s(20680),eX=s(26434),eZ=s(53270),eQ=s(96091);function e$(e){let{text:t,conversationUuid:s,onOpen:n,onDownloadAll:l,shareType:r}=e,o=(0,i.useMemo)(()=>(0,eQ.n)(t).filter(e=>(0,eX.m)(e,r)),[t,r]);return 0===o.length?null:(0,a.jsxs)("div",{className:"flex flex-col gap-2 py-2",children:[o.map(e=>{let t=e.split("/").pop()||e;return(0,a.jsx)(eZ._,{conversationUuid:s,file:{name:t,path:e},onOpen:()=>{n(e)},isShared:!!r},e)}),o.length>1&&(0,a.jsx)("div",{children:(0,a.jsx)(m.$,{variant:"secondary",prepend:(0,a.jsx)(eK.e,{size:"1.1rem"}),onClick:()=>{l(o)},children:(0,a.jsx)(x.A,{defaultMessage:"Download all",id:"V1UrPNM96z"})})})]})}var e1=s(48321),e0=s(18849),e2=s(58841),e3=s(37380),e4=s(84656),e8=s(54130);let e9=["year","month","day","hour","minute","second","millisecond"],e5=e=>{let{value:t,...s}=e;return function(e,t){let{listStyle:s,...a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e8.dw.fromDurationLike(t);return e.formatList(e9.filter(e=>0!==n["".concat(e,"s")]).map(t=>e.formatNumber(n["".concat(t,"s")],{...a,style:"unit",unit:t})),{...a,style:s})}((0,g.A)(),t,s)};var e7=s(45312),e6=s(19664),te=s.n(e6),tt=s(99411),ts=s(72253);function ta(){let e=(0,d._)(["\nbg-bg-100 text-text-300 border-0.5 border-border-300 flex flex-row gap-1.5 rounded-md p-2 mx-4 mb-4 font-small"]);return ta=function(){return e},e}function tn(e,t){if(!e)return;let s=(t?e7.c9.fromISO(t):e7.c9.now()).diff(e7.c9.fromISO(e),["hours","minutes","seconds"]);return 0>s.toMillis()?e7.dw.fromMillis(0):s}let ti=u.J.div(ta()),tl=()=>(0,a.jsxs)(ti,{"data-testid":"message-warning",children:[(0,a.jsx)(G.R2D,{className:"shrink-0",size:16}),(0,a.jsx)(x.A,{defaultMessage:"The rest of the <link>thought process</link> is not available for this response.",id:"G/67Pe5XhQ",values:{link:e=>(0,a.jsx)(te(),{href:"https://support.anthropic.com/en/articles/10574485-using-extended-thinking-on-claude-3-7-sonnet",className:"underline",target:"_blank",children:e})}})]}),tr=e=>{let{text:t,cutOff:s}=e;return(0,a.jsxs)("div",{className:"text-text-300 text-sm font-normal gap-0.5 relative font-claude-response",children:[(0,a.jsx)(eD.fP,{className:"p-3 pt-0 pr-8",text:t}),!0!==s?null:(0,a.jsx)(tl,{})]})},to=(0,i.memo)(e=>{let t,{index:s,text:n,cutOff:l=!1,startTimestamp:r,stopTimestamp:d,isStreaming:c,mostRecentSummary:u,onToggle:m,messageUuid:p,isFirstBlockOfMessage:f,isLastBlockOfMessage:h,renderMode:x=eU.l.Standard,isFirstItemInGroup:C,isLastItemInGroup:v,conversationUuid:j}=e,b=(0,eM.useDynamicConfig)("claudeai_isp_thinking_ux"),y=b.get("enabled",!1),w=(0,g.A)(),_=w.formatMessage({defaultMessage:"Thinking",id:"AHQWDTo4+e"}),k=w.formatMessage({defaultMessage:"Thinking...",id:"QrZMdiKa7h"}),N=w.formatMessage({defaultMessage:"Thought process",id:"zl6fNbo7RW"}),{isExpanded:M,setIsExpanded:S,snappyTransition:A}=(0,ts.a)(!y&&c,String(s)),E=(0,B.st)(),[z,T]=(0,i.useState)(()=>tn(r,d)),L=(0,i.useRef)(void 0),R=(0,i.useRef)(!1),[I,U]=(0,i.useState)(null),O=(0,i.useRef)([]);(0,i.useEffect)(()=>{(0,e3.GN)(p)&&O.current.length>0&&(O.current.forEach(e=>{E.track({event_key:"claudeai.thinking_cell.clicked",is_opening:e.isOpening,is_streaming:e.wasStreamingWhenClicked,chat_message_uuid:p,timestamp:e.timestamp})}),O.current=[])},[p,E]),(0,i.useEffect)(()=>{c&&(R.current=!0)},[c]);let F=c||R.current?b.get("fallback_summary_debounce_ms",2e3):0;(0,e4.W)(()=>{!c&&n.length>0&&U(td(n,b))},[n,c],F),(0,i.useEffect)(()=>{let e=()=>{let e=tn(r,void 0);L.current=e,T(e)};if(c){e();let t=setInterval(e,1e3);return()=>clearInterval(t)}!L.current&&d&&T(tn(r,d))},[r,d,c]);let D=null==u?void 0:u.summary,P=(0,ev.Z)(j);if(P)t=n;else if(y)if(c)t=null!=D?D:k;else{var W;t=null!=(W=null!=D?D:I)?W:k}else t=null!=D?D:c?_:N;return(0,a.jsx)(tt.sH,{isStreaming:c,isExpanded:M,setIsExpanded:()=>{let e=new Date().toISOString();(0,e3.GN)(p)?E.track({event_key:"claudeai.thinking_cell.clicked",is_opening:!M,is_streaming:c,chat_message_uuid:p,timestamp:e}):O.current.push({isOpening:!M,wasStreamingWhenClicked:c,timestamp:e}),S(!M)},isFirstBlockOfMessage:f,isLastBlockOfMessage:h,text:M?N:!P&&(c||L.current)?(0,a.jsx)(Y.N,{mode:"wait",children:(0,a.jsx)(o.P.span,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.3,ease:"easeIn"},className:y?"text-text-300":"text-left relative text-sm font-claude-response leading-6 whitespace-nowrap text-text-300 text-ellipsis overflow-hidden basis-0 grow min-w-0",children:t},t)}):(0,a.jsx)("span",{className:y?"text-text-300":"text-left relative text-sm font-claude-response leading-6 whitespace-nowrap text-text-300 text-ellipsis overflow-hidden basis-0 grow min-w-0",children:t}),secondaryText:z&&z.as("seconds")>=10?(0,a.jsxs)("span",{className:"flex items-center gap-1 transition-opacity",children:[(0,a.jsx)(G.Sw4,{className:(0,H.A)("text-text-300 transition-all duration-300 ease-in-out opacity-50",c?"!opacity-0 scale-50":"scale-100 opacity-100"),size:12}),(0,a.jsx)("span",{className:"tabular-nums",children:(0,a.jsx)(e5,{value:z,listStyle:"narrow",unitDisplay:"narrow",maximumFractionDigits:0})})]}):void 0,renderMode:x,isFirstItemInGroup:C,isLastItemInGroup:v,children:(0,a.jsx)(tt.NG,{isExpanded:M,snappyTransition:A,onTransitionEnd:m,isScrollable:!0,children:(0,a.jsx)(tr,{text:n,cutOff:l})})})});to.displayName="ThinkingCell";let td=(e,t)=>{let s=t.get("fallback_summary_min_len",50),a=t.get("fallback_summary_max_len",100),n=new RegExp(t.get("fallback_summary_regex",".*(\\n|\\.(\\s|$)|ã€‚)")),i=e.substring(0,a),l=n.exec(i);if(l)return l[0];for(let e=i.length-1;e>=s;e--)if(/\s/.test(i[e]))return i.substring(0,e+1);return i},tc=(0,i.memo)(e=>{var t;let s,{block:n,index:i,isThisMessageStreaming:l,blocksCount:o}=e;if(!(0,r.fS)("empty_your_cup")||"text"!==n.type&&"thinking"!==n.type&&"tool_use"!==n.type||!(!l||i<o-1))return null;let d=new Set(null!=(t=n.flags)?t:[]);return(d.has("a2")?s=(0,a.jsx)(eh.YX,{id:"curvature_propulsion_drive"}):d.has("a1")&&(s=(0,a.jsx)(eh.YX,{id:"bubble_universe_portal"})),s)?(0,a.jsx)("div",{className:"px-1.5 py-0.5 mx-2 my-1 opacity-80 text-xs font-ui bg-danger-900 text-danger-000 rounded border-0.5 border-danger-200 select-none",children:s},"flag-".concat(i)):null});tc.displayName="FlagMessage";let tu=(0,i.memo)(e=>{let{block:t,index:s,blocks:l,isStreaming:r,isThisMessageStreaming:o,isLastMessage:d,updatedMessage:c,message:u,onResize:m,conversationUuid:p,shareType:f,publishedArtifacts:h,onOpenArtifact:g,onOpenWiggleFile:x,...C}=e,{renderMode:v,isFirstItemInGroup:j,isLastItemInGroup:b}=C,y=(0,B.st)(),{setMessageFeatures:w}=(0,S.Bk)(),_=l[s+1],k=l.length,N=(null==_?void 0:_.type)==="tool_result",M=0===s,A=!!k&&s===k-1-!!N,E=(0,i.useCallback)(e=>null==g?void 0:g(e,c.uuid),[g,c.uuid]),z=(0,i.useCallback)(()=>{w(u.uuid,{hasLink:!0})},[w,u.uuid]),T=(0,i.useCallback)(()=>{w(u.uuid,{hasCode:!0})},[w,u.uuid]),{activeOrganization:L}=(0,n.YL)(),{dispatchChatResource:R}=(0,e2.i)(),{setIsDrawerExpanded:I}=(0,e0.x)(),U=(0,i.useCallback)((e,t)=>{t.startsWith("computer://")&&(null==L?void 0:L.uuid)&&(e.preventDefault(),R({type:"SELECT_FILE",path:t.replace("computer://",""),toolType:"create_file",messageId:c.uuid}),I(!0))},[null==L?void 0:L.uuid,R,I,c.uuid]),O=(0,i.useCallback)(e=>{(null==L?void 0:L.uuid)&&(0,e1.y)(f?{filepaths:e,orgUuid:null==L?void 0:L.uuid,snapshotUuid:p,isShared:!0,source:"wiggle_file_card_download_all"}:{filepaths:e,orgUuid:null==L?void 0:L.uuid,conversationUuid:p,isShared:!1,source:"wiggle_file_card_download_all"},y)},[null==L?void 0:L.uuid,f,p,y]),F=(0,i.useCallback)(()=>{null==m||m()},[m]),D=(0,i.useCallback)(e=>{null==x||x(e,u.uuid)},[x,u.uuid]),P=(0,i.useCallback)(e=>{null==O||O(e)},[O]),G=(0,i.useMemo)(()=>{switch(t.type){case"thinking":var e;return(0,a.jsx)(to,{index:s,text:t.thinking,cutOff:t.cut_off,startTimestamp:t.start_timestamp,stopTimestamp:t.stop_timestamp,isStreaming:o&&!t.stop_timestamp,mostRecentSummary:null==(e=t.summaries)?void 0:e.at(-1),messageUuid:c.uuid,onToggle:F,isFirstBlockOfMessage:M,isLastBlockOfMessage:A,renderMode:v,isFirstItemInGroup:j,isLastItemInGroup:b,conversationUuid:p},s);case"tool_use":return(0,a.jsx)(eJ,{conversationUuid:p,block:t,message:u,updatedMessage:c,index:s,shareType:f,isStreaming:r,isLastMessage:d,publishedArtifacts:h,isFirstBlockOfMessage:M,isLastBlockOfMessage:A,renderMode:v||eU.l.Standard,isFirstItemInGroup:j,isLastItemInGroup:b},s);case"text":if(0===s&&""===t.text)return;return(0,a.jsxs)(i.Fragment,{children:[o?(0,a.jsx)(eF.qO,{text:t.text,blockCitations:t.citations,onLinkDetected:z,onCodeDetected:T,className:"progressive-markdown",isStreaming:r,onOpenArtifact:E,isLastMessage:d,publishedArtifacts:void 0,onLinkClick:U}):(0,a.jsx)(eD.fP,{text:t.text,blockCitations:t.citations,onLinkDetected:z,onCodeDetected:T,className:"standard-markdown",isStreaming:r,onOpenArtifact:E,isLastMessage:d,publishedArtifacts:h,onLinkClick:U}),(0,a.jsx)(e$,{text:t.text,onOpen:D,conversationUuid:p,onDownloadAll:P,shareType:f})]},"".concat(s,"-").concat(o?"streaming":"static"));default:return null}},[t,p,s,M,j,A,b,d,r,o,u,T,P,U,z,E,D,F,h,v,f,c]);return(0,a.jsxs)(a.Fragment,{children:[G,(0,a.jsx)(tc,{block:t,blocksCount:l.length,index:s,isThisMessageStreaming:o})]})});tu.displayName="Block";let tm=(0,i.memo)(e=>{let{blocks:t,isStreaming:s,isThisMessageStreaming:n,isLastMessage:l,updatedMessage:o,message:d,onResize:c,conversationUuid:u,shareType:m,publishedArtifacts:p,onOpenArtifact:f,onOpenWiggleFile:h}=e,g=(0,eM.useDynamicConfig)("claudeai_isp_thinking_ux"),x=(0,r.fS)("claudeai_collapse_timeline_groups"),C=(0,i.useMemo)(()=>{let e=[],s=new Set;return t.forEach((a,n)=>{if(!s.has(n))if((0,eO.Ih)(a,g)){let i={items:[{block:a,index:n,renderable:(0,eO.h4)(a)}],startIndex:n,isLastBlockOfMessage:!1};for(let e=n+1;e<t.length;e++){let a=t[e];if(!(0,eO.Ih)(a,g))break;i.items.push({block:a,index:e,renderable:(0,eO.h4)(a)}),s.add(e),e===t.length-1&&(i.isLastBlockOfMessage=!0)}let l=i.items.findLastIndex(e=>"tool_use"===e.block.type&&"artifacts"===e.block.name);l>=0&&(i.items=i.items.slice(0,l),i.items.forEach(e=>{"tool_use"===e.block.type&&"artifacts"===e.block.name&&(e.renderable=!1)})),0===i.items.filter(e=>e.renderable).length?e.push({type:"single",content:a,index:n}):e.push({type:"group",content:i,index:n})}else e.push({type:"single",content:a,index:n})}),e},[t,g]);return(0,a.jsx)(a.Fragment,{children:C.map(e=>{if("group"===e.type){let i=e.content,r=i.items.filter(e=>e.renderable);if(r.length<=1){let r=i.items[0];return r?(0,a.jsx)(tu,{block:r.block,index:r.index,blocks:t,isLastMessage:l,isStreaming:s,isThisMessageStreaming:n,updatedMessage:o,message:d,onResize:c,conversationUuid:u,shareType:m,publishedArtifacts:p,onOpenArtifact:f,onOpenWiggleFile:h},"block-".concat(e.type,"-").concat(e.index)):null}return(0,a.jsx)(eO.DT,{isFirstBlockOfMessage:0===i.startIndex,isLastBlockOfMessage:i.isLastBlockOfMessage,isStreaming:s,children:r.map((e,i)=>{let g=x&&r.length>2;return(0,a.jsx)(tu,{block:e.block,index:e.index,blocks:t,renderMode:eU.l.TimelineGroup,isFirstItemInGroup:0===i&&!g,isLastItemInGroup:i===r.length-1,isLastMessage:l,isStreaming:s,isThisMessageStreaming:n,updatedMessage:o,message:d,onResize:c,conversationUuid:u,shareType:m,publishedArtifacts:p,onOpenArtifact:f,onOpenWiggleFile:h},e.index)})},"block-".concat(e.type,"-").concat(e.index))}return(0,a.jsx)(tu,{block:e.content,index:e.index,blocks:t,onResize:c,conversationUuid:u,shareType:m,publishedArtifacts:p,onOpenArtifact:f,onOpenWiggleFile:h,isThisMessageStreaming:n,isLastMessage:l,updatedMessage:o,message:d,isStreaming:s},"block-".concat(e.type,"-").concat(e.index))})})});tm.displayName="MessageBlocksRenderer";let tp=(0,i.memo)(e=>{var t,s,n;let{isStreaming:i,isThisMessageStreaming:l,isLastMessage:d,updatedMessage:c,onResize:u,previousMessage:m,message:p,isInteractive:f,isFirstAssistantMessage:h,onRetry:g,isResearchPending:x,isTemporary:C,conversationSettings:v,messageWarningPropsFromParent:j,onSendContinue:b,onOpenArtifact:y,shareType:w,publishedArtifacts:_,onOpenWiggleFile:k,...N}=e;(0,r.fS)("claudeai_crabby_claws_enabled");let M=N.conversationUuid.startsWith("session_");if((!c.content||!c.content[0])&&!(null==(t=c.metadata)?void 0:t.is_resume_completion_placeholder_message))return null;let S=(0,a.jsxs)(F,{"data-is-streaming":l,...i?R:L,className:d?"pb-3":"pb-8",children:[(0,a.jsx)(D,{children:(0,a.jsx)(tm,{blocks:c.content||[],isStreaming:i,isThisMessageStreaming:l,isLastMessage:d,updatedMessage:c,message:p,onResize:u,conversationUuid:N.conversationUuid,shareType:w,onOpenWiggleFile:k,publishedArtifacts:_,onOpenArtifact:y})}),null==(s=c.content)?void 0:s.map((e,t)=>{if("bell"===e.type||"voice_note"===e.type)return(0,a.jsx)(eI,{text:e.text,title:e.title},t)}),!M&&(0,a.jsxs)(a.Fragment,{children:[!i&&d&&(0,a.jsx)(ez,{previousMessage:m}),(0,a.jsx)(ew,{message:p,previousMessage:m,isLastMessage:d,isInteractive:f,isFirstAssistantMessage:h,onRetry:g,isResearchPending:x,isTemporary:C,showArtifacts:null!=(n=null==v?void 0:v.preview_feature_uses_artifacts)&&n,isStreaming:i,...N}),(0,a.jsx)(A,{message:p,isLastMessage:d,messageWarningPropsFromParent:j,conversationSettings:v,onRetry:g,onSendContinue:b}),(0,a.jsx)(eR,{message:p,conversationUuid:N.conversationUuid})]})]});return(0,a.jsx)(o.P.div,{style:{height:"auto"},...i?U:L,children:S})});tp.displayName="AssistantMessage";var tf=s(83158),th=s(45533),tg=s(13750),tx=s(18800);let tC=(0,i.memo)(e=>{var t,s,n;let{isStreaming:l,currentEdit:r,setCurrentEdit:o,finishEdit:d,cancelEdit:c,author:u,loggedInAccount:p,message:f,selectAttachment:g,showSharedImageMissing:C=!1,showSharedFileMissing:v=!1}=e,j=(0,i.useRef)(null);(0,i.useEffect)(()=>{let e=e=>{if("Enter"!==e.key||e.shiftKey||(e.preventDefault(),d()),"Escape"===e.key&&(e.preventDefault(),c()),"a"===e.key&&(e.metaKey||e.ctrlKey)&&document.activeElement===j.current){var t;null==(t=j.current)||t.select()}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[d,c,j]);let b=null!=(n=f.files_v2)?n:f.files,y=C||v||f.attachments.length+b.length+((null==f||null==(t=f.sync_sources)?void 0:t.length)||0)>0,w=(0,q.C)(f),_=0===r.length||w===r;return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),d()},children:[y&&(0,a.jsxs)("div",{className:"mx-0.5 mb-3 flex flex-wrap gap-0.5",children:[b.map((e,t)=>(0,a.jsx)(tf.NM,{size:"lg",file:e},t)),f.attachments.map((e,t)=>(0,a.jsx)(tf.NM,{size:"lg",file:e,onClick:()=>null==g?void 0:g(e)},t)),null==f||null==(s=f.sync_sources)?void 0:s.map(e=>(0,a.jsx)(tx.V,{uuid:e.uuid,syncSource:e},e.uuid)),C&&(0,a.jsx)(tf.sv,{}),v&&!C&&(0,a.jsx)(tf.lD,{})]}),(0,a.jsx)(O,{...l?I:L,className:"w-full",children:(0,a.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,a.jsx)("div",{className:"flex shrink-0 items-center",children:(0,a.jsx)(th.e,{name:u||(null==p?void 0:p.full_name)||"",size:"sm"})}),(0,a.jsxs)("div",{className:"font-ui mr-3 grid w-full grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6",children:[(0,a.jsx)(tg.fs,{value:r,onChange:e=>o(e.target.value),autoFocus:!0,className:"w-full",ref:j}),(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsxs)("div",{className:"text-text-300 flex flex-row items-center gap-2 text-xs",children:[(0,a.jsx)(h.R,{"aria-hidden":"true",className:"shrink-0"}),(0,a.jsx)("div",{children:(0,a.jsx)(x.A,{defaultMessage:"Editing this message will create a new conversation branch. You can switch between branches using the arrow navigation buttons.",id:"zqkUZeVH+L"})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(m.$,{onClick:c,variant:"secondary",children:(0,a.jsx)(x.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,a.jsx)(m.$,{type:"submit",disabled:_,children:(0,a.jsx)(x.A,{defaultMessage:"Save",id:"jvo0vs3nF0"})})]})]})]})]})})]})});tC.displayName="EditingMessage";var tv=s(70448),tj=s(96608);tj.A.blockRegex;let tb=tj.A.defaultRules,ty=tj.A.parserFor;tj.A.defaultBlockParse;let tw=tj.A.outputFor,t_=e=>{if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(t_);if(i.isValidElement(e)){if(e.props&&"object"==typeof e.props&&"children"in e.props){let t=e.props.children,s=t_(t);if(s!==t)return i.cloneElement(e,void 0,s)}return e}if((e=>"object"==typeof e&&null!==e&&"$$typeof"in e&&"type"in e&&"props"in e)(e)){let{type:t,props:s,key:a}=e,n={};return s&&"object"==typeof s&&(Object.assign(n,s),"children"in s&&(n.children=t_(s.children))),null!=a&&(n.key=a),i.createElement(t,n)}return e};var tk=s(11727);let tN={fence:{...tb.fence,parse:(e,t,s)=>({lang:e[2]||void 0,content:e[3]}),react:e=>(0,a.jsx)(tk.I.pre,{flagShowCodeHeader:!1,children:e.content})},blockQuote:{...tb.blockQuote,react:(e,t,s)=>(0,a.jsx)(tk.I.blockQuote,{children:t(e.content,s)})},list:{...tb.list,react:(e,t,s)=>{let n=e.ordered?tk.I.ol:tk.I.ul;return(0,a.jsx)(n,{children:e.items.map((e,n)=>(0,a.jsx)(tk.I.li,{children:t(e,s)},n))},s.key)}},newline:tb.newline,paragraph:{...tb.paragraph,react:(e,t,s)=>(0,a.jsx)(tk.I.p,{children:t(e.content,s)},s.key)},del:tb.del,inlineCode:{...tb.inlineCode,react:e=>{let t=e.content;if(t&&tv.yT.test(t)){var s;if((null==(s=t.match(tv.yT))?void 0:s[0])===t)return(0,a.jsxs)(tk.I.code,{children:[(0,a.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",position:"relative",top:"-0.15em"},children:(0,a.jsx)(tv.qU,{color:t})}),t]})}return(0,a.jsx)(tk.I.code,{children:t})}},text:{...tb.text,react:e=>(0,tv.fz)(e.content)},url:tb.url,link:{...tb.link,match:(e,t)=>null,react:e=>{let t=e.target;return(0,a.jsx)("a",{href:t,target:"_blank",className:"underline",children:t})}}},tM=(0,i.memo)(e=>{let{text:t}=e,s=ty(tN)(t,{inline:!1});return((e,t,s)=>{let a=tw(e,t,s),n=(e,t)=>t_(a(e,t));return n.displayName="OutputFor_".concat(String(t)),n})(tN,"react")(s)});tM.displayName="AnthropicMarkDown";var tS=s(2e3),tA=s(56929),tE=s(22167),tz=s(40258);let tT={type:"remote"},tL=(0,i.memo)(e=>{var t,s,n,l,r;let{files:o,updatedMessage:d,message:c,isLastMessage:u,isInteractive:m,editable:p,startEdit:f,onRetry:h,isResearchPending:g,isTemporary:x,author:C,shareType:v,conversationSettings:j,messageWarningPropsFromParent:b,previousMessage:y,isStreaming:w,selectAttachment:_,showSharedImageMissing:k,showSharedFileMissing:N,...M}=e,S=k||N||d.attachments.length+o.length+((null==d||null==(t=d.sync_sources)?void 0:t.length)||0)>0,E=null==(s=d.content)?void 0:s.some(e=>"text"===e.type&&""!==e.text),z="voice"===d.input_mode||"speech_input"===d.input_mode,T=(0,i.useMemo)(()=>{var e,t;return null!=(t=null==(e=c.sync_sources)?void 0:e.filter(e=>e.type===tS.v8.GDRIVE).map(e=>e.config.uri))?t:[]},[c.sync_sources]),R=(0,tE.kO)(),U=(0,i.useMemo)(()=>{var e,t;return null!=(t=null==(e=c.sync_sources)?void 0:e.filter(e=>e.type===tS.v8.MCP_RESOURCES).map(e=>e.config.resource.uri))?t:[]},[c.sync_sources]),F=(0,eY.Uz)(tT),D=(0,i.useMemo)(()=>null==F?void 0:F.find(e=>e.url&&tE.TI[e.url]===tS.v8.GDRIVE),[F]),[P,B]=(0,i.useState)([]);(0,i.useEffect)(()=>{if(!R||!D||0===U.length)return void B([]);let e=!1;return(async()=>{try{let t=(0,eY.KU)(D.uuid),s=await Promise.all(U.map(async e=>{try{var s;let a=await t.readResource({uri:e}),n=null==a||null==(s=a.contents)?void 0:s[0];if(!(null==n?void 0:n.text))return{data:null};let i=n.text;return{data:{uri:e,title:(null==n?void 0:n.name)||"",mime_type:n.mimeType||"text/plain",owner:"",text:i,size:i.length}}}catch(t){return(0,tA.Cp)(t,{tags:{component:"HumanMessage",action:"fetch_mcp_resource",serverUuid:D.uuid},extra:{uri:e}}),{data:null}}}));e||B(s)}catch(t){(0,tA.Cp)(t,{tags:{component:"HumanMessage",action:"fetch_mcp_resources_batch",serverUuid:D.uuid}}),e||B([])}})(),()=>{e=!0}},[R,D,U]);let G=(0,eS.qL)(T),W=(0,i.useMemo)(()=>[...G,...P],[G,P]),V=(0,i.useMemo)(()=>W.some(e=>{let{data:t}=e;return t&&/\[image\d*\]/.test(t.text)}),[W]);return(0,a.jsxs)("div",{className:"mb-1 mt-1",children:[S&&(0,a.jsxs)("div",{className:"gap-2 mx-0.5 mb-3 flex flex-wrap",children:[o.map((e,t)=>(0,a.jsx)(tf.NM,{size:"lg",file:e},t)),d.attachments.map((e,t)=>(0,a.jsx)(tf.NM,{size:"lg",file:e,onClick:()=>null==_?void 0:_(e)},t)),null==d||null==(n=d.sync_sources)?void 0:n.map(e=>(0,a.jsx)(tx.V,{uuid:e.uuid,syncSource:e},e.uuid)),k&&(0,a.jsx)(tf.sv,{}),N&&!k&&(0,a.jsx)(tf.lD,{})]}),(0,a.jsxs)(O,{className:(0,H.A)({"pr-6":E,"pr-[2.5px]":!E,"!border-0.5 !bg-transparent border-border-300":c.pending}),...w?I:L,children:[(0,a.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,a.jsx)("div",{className:"shrink-0",children:v?(0,a.jsx)(th.e,{name:C||null,size:"sm"}):(0,a.jsx)(tz.J,{size:"sm"})}),(0,a.jsx)("div",{"data-testid":"user-message",className:(0,H.A)("font-large !font-user-message grid grid-cols-1 gap-2 py-0.5",{italic:z,"animate-pulse":c.pending}),children:null==(l=d.content)?void 0:l.map((e,t)=>"text"!==e.type?null:(0,a.jsx)(tM,{text:e.text},t))})]}),(0,a.jsx)(A,{message:c,isLastMessage:u,hasDriveDocWithImages:V,conversationSettings:j,messageWarningPropsFromParent:b}),(0,a.jsx)(ew,{message:c,isStreaming:w,previousMessage:y,isLastMessage:u,isInteractive:m,editMessage:f,editable:p,onRetry:h,isResearchPending:g,isTemporary:x,showArtifacts:null!=(r=null==j?void 0:j.preview_feature_uses_artifacts)&&r,...M})]})]})});tL.displayName="HumanMessage";var tR=s(69604),tI=s(49982);let tU=[],tO=(0,i.memo)(function(e){var t,s;let{lastHumanMessageRef:r,lastAssistantMessageRef:o,isLastMessage:d,isLastHumanMessage:c,selectAttachment:u,author:m,isInteractive:p=!0,onOpenArtifact:f,onOpenWiggleFile:h,onResize:x,editable:C,conversationSettings:v,publishedArtifacts:j=tU,messageWarningProps:b,showSharedImageMissing:y=!1,showSharedFileMissing:w=!1,isFirstAssistantMessage:_,shareType:k=null,isTemporary:N=!1,actionEmitter:M,onSendContinue:S,isResearchPending:A=!1,...E}=e,{account:z}=(0,n.YL)(),{messageUuid:T="",message:L,previousMessageUuid:R="",previousMessage:I,isStreaming:U}=E,O=(0,l.JX)(T),F=(0,l.JX)(R),D=L||O,P=I||(R?F:void 0),B=(e=>{let t=(0,i.useRef)(1);return(0,i.useEffect)(()=>{e||(t.current+=1)},[e]),t.current})(d),G=(e=>{let{message:t,onOpenArtifact:s,shareType:a}=e,n=(0,tI.n)(),l=(0,g.A)();return(0,i.useMemo)(()=>{let e=(e=>{var t;let s=e.content,a=null==(t=e.content)?void 0:t[0];return(null==a?void 0:a.type)==="text"&&""===a.text.trim()&&(s=null==s?void 0:s.slice(1)),s})(t),i=(null==e?void 0:e.map(e=>(e=>{let{block:t,citationsEnabled:s,shareType:a,onOpenArtifact:n,intl:i}=e;if("text"!==t.type)return t;let l=t.text;if(s&&t.citations&&t.citations.length>0&&(l=(0,tR.k0)(t.citations,l)),l=n?(0,V.Tm)(l):(0,V.it)(l),a){for(let e of(0,eQ.n)(l))if(!(0,eX.m)(e,a)){let t="public"===a?"[".concat(i.formatMessage({defaultMessage:"Files hidden in shared chats",id:"ANRUB+TiTq"}),"]"):"[".concat(i.formatMessage({defaultMessage:"Working file hidden in shared chat",id:"oqkUomHXYH"}),"]"),s=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),n=RegExp("\\[[^\\]]*\\]\\(".concat(s,"\\)"),"g");l=l.replace(n,t)}}return{...t,text:l}})({block:e,citationsEnabled:n,shareType:a,onOpenArtifact:s,intl:l})))||[];return{...t,content:i}},[n,l,t,s,a])})({message:D,onOpenArtifact:f,shareType:k}),W=(0,i.useCallback)((e,t)=>{null==M||M.emit("retry",{parent_message_uuid:e,paprika_mode:t})},[M]),q=null!=(s=D.files_v2)?s:D.files,H="human"===G.sender,Y="assistant"===G.sender,J=d&&U,{isUserEditing:K,currentEdit:X,setCurrentEdit:Z,startEdit:Q,finishEdit:$,cancelEdit:ee}=(e=>{var t;let{editable:s,updatedMessage:a,actionEmitter:n}=e,[l,r]=(0,i.useState)(!1),[o,d]=(0,i.useState)(""),c="",u=null==(t=a.content)?void 0:t.find(e=>"text"===e.type);u&&"text"in u&&(c=u.text);let m=(0,i.useCallback)(()=>{s&&(d(c),r(!0))},[s,c]),p=(0,i.useCallback)(()=>{0!==o.length&&n&&(n.emit("edit",{message:a,text:o}),r(!1),d(""))},[o,n,a]),f=(0,i.useCallback)(()=>{r(!1),d("")},[]);return{isUserEditing:l,currentEdit:o,setCurrentEdit:d,startEdit:m,finishEdit:p,cancelEdit:f}})({editable:C,actionEmitter:M,updatedMessage:G});return K?(0,a.jsx)(tC,{isStreaming:U,currentEdit:X,setCurrentEdit:Z,finishEdit:$,cancelEdit:ee,author:m,loggedInAccount:z,message:G,selectAttachment:u,showSharedImageMissing:y,showSharedFileMissing:w}):(0,a.jsxs)("div",{ref:c?r:d?o:null,"data-test-render-count":B,children:[H&&(0,a.jsx)(tL,{files:q,updatedMessage:G,message:D,isLastMessage:d,isLastHumanMessage:c,isInteractive:p,editable:C,startEdit:Q,onRetry:W,isResearchPending:A,isTemporary:N,author:m,shareType:k,conversationSettings:v,messageWarningPropsFromParent:b,previousMessage:P,selectAttachment:u,showSharedImageMissing:y,showSharedFileMissing:w,...E}),Y&&(G.content&&G.content[0]||(null==(t=G.metadata)?void 0:t.is_resume_completion_placeholder_message))&&(0,a.jsx)(tp,{isThisMessageStreaming:J,isLastMessage:d,isLastHumanMessage:!1,updatedMessage:G,onResize:x,previousMessage:P,message:D,isInteractive:p,isFirstAssistantMessage:_,onRetry:W,isResearchPending:A,isTemporary:N,conversationSettings:v,messageWarningPropsFromParent:b,onSendContinue:S,onOpenArtifact:f,publishedArtifacts:j,onOpenWiggleFile:h,shareType:k,...E})]})})},72253:(e,t,s)=>{s.d(t,{a:()=>i});var a=s(7620),n=s(20804);let i=(e,t,s)=>{let i=(0,a.useRef)(!1),l=(0,a.useRef)(null),r=(0,a.useRef)(null),[o,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(!e),{expandedItemKey:m,setExpandedItemKey:p}=(0,n.D8)(),f=t&&p&&!s,h=(0,a.useCallback)(e=>{f&&p(e?t:void 0),d(e)},[f,p,d,t]),g=!!s||(f?m===t:o);return(0,a.useEffect)(()=>(l.current&&(clearTimeout(l.current),l.current=null),r.current&&(clearTimeout(r.current),r.current=null),e?(i.current=!0,h(!0),u(!1)):i.current&&!s&&(l.current=setTimeout(()=>{h(!1),r.current=setTimeout(()=>{u(!0),i.current=!1},600)},2e3)),()=>{l.current&&(clearTimeout(l.current),l.current=null),r.current&&(clearTimeout(r.current),r.current=null)}),[e,h,s]),{isExpanded:g,setIsExpanded:h,snappyTransition:c}}},73648:(e,t,s)=>{s.d(t,{p:()=>n});var a=s(89538);function n(e){let t;try{t=JSON.parse(e)}catch(s){try{let s=(0,a.m)(e);t=JSON.parse(s)}catch(e){}}return t}},74801:(e,t,s)=>{s.d(t,{yL:()=>ep,XO:()=>em});var a=s(54568),n=s(15393),i=s(74813),l=s(44995),r=s(64328),o=s(35984),d=s(13750),c=s(89626),u=s(23812),m=s(87483),p=s(1720),f=s(3075),h=s(67453),g=s(64371),x=s(57291),C=s(68067),v=s(31779),j=s(72352),b=s(72902),y=s(39109),w=s(61295),_=s(45312),k=s(32536),N=s(7620),M=s(59666),S=s(10369),A=s(32027),E=s(45538),z=s(22167),T=s(4887),L=s(47831),R=s(8564),I=s(68616),U=s(78671),O=s(48321),F=s(78418),D=s(71196),P=s(79901),B=s(27769);function G(e){let{width:t=61,height:s=82,...n}=e;return(0,a.jsxs)("svg",{width:t,height:s,viewBox:"0 0 61 82",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n,children:[(0,a.jsx)("path",{d:"M40.2344 2.97998L41.4401 18.5435C41.4401 18.5435 60.4289 19.3192 59.1368 17.9675C57.8427 16.6158 40.2363 2.97998 40.2363 2.97998H40.2344Z",className:"fill-[#E8E6DC] dark:fill-[#3D3D3A]"}),(0,a.jsx)("path",{d:"M1.27976 14.1874C1.39304 11.3016 1.4372 9.85778 1.48328 8.41202C1.50632 7.6901 1.52128 6.96626 1.57352 6.06194C1.59656 5.60882 1.62344 5.11154 1.65224 4.54514C1.66952 4.26098 1.68872 3.95954 1.70984 3.6389C1.72136 3.47762 1.7348 3.31058 1.74632 3.1397C1.7636 2.94578 1.78088 2.7461 1.79816 2.54066C1.83464 2.18546 1.87496 1.83794 1.94408 1.6037C2.02664 1.37906 2.10344 1.25234 2.1092 1.23122C2.14184 1.18322 2.1764 1.13714 2.21672 1.09298L2.23208 1.0757C2.23208 1.0757 2.2244 1.06226 2.24552 1.08146L2.25704 1.06994L2.2916 1.0373L2.3588 0.975856C2.45096 0.902896 2.55464 0.852976 2.66792 0.812656C2.89064 0.730096 3.14792 0.705136 3.39944 0.691696C3.52616 0.684016 3.65288 0.680176 3.77768 0.680176C3.88136 0.680176 3.98312 0.680176 4.08296 0.680176C4.21928 0.682096 4.35176 0.684016 4.4804 0.685936C4.98536 0.699376 5.43656 0.710896 5.85128 0.722416C6.67304 0.745456 7.35656 0.766576 8.0516 0.785776C9.43785 0.824176 10.8682 0.862576 13.5486 0.937456C16.4247 1.01426 17.8647 1.03154 19.3028 1.05266C20.7428 1.06994 22.1809 1.08722 25.0609 1.0949C27.939 1.09874 29.379 1.11794 30.819 1.14098C32.259 1.16018 33.699 1.1813 36.5809 1.1333C37.4007 1.11986 38.1034 1.10066 38.7198 1.07954C39.0462 1.06802 39.3476 1.0565 39.6318 1.04498C40.1214 1.00274 40.5706 1.17362 40.8913 1.46354C41.0276 1.57298 41.1601 1.6805 41.2887 1.78418C41.402 1.87442 41.5134 1.96274 41.6209 2.04914C41.8378 2.22002 42.0471 2.38322 42.2526 2.5445C42.6634 2.86706 43.0628 3.18002 43.5025 3.52562C44.3799 4.22066 45.409 5.05586 46.9796 6.39602C51.3706 10.1381 51.2362 10.2975 55.6273 14.0395C56.7255 14.9746 57.5569 15.6696 58.2519 16.2418C58.6014 16.5259 58.9162 16.7832 59.2138 17.0251C59.306 17.1 59.3982 17.1749 59.4884 17.2479C59.6266 17.3573 59.7534 17.4725 59.8532 17.605C60.0567 17.8699 60.1834 18.1944 60.2007 18.5247C60.2218 18.6859 60.193 18.8683 60.1911 19.0277C60.1873 19.1179 60.1834 19.2082 60.1796 19.2984C60.1719 19.4808 60.1642 19.6651 60.1585 19.8571C60.1431 20.2392 60.1258 20.6424 60.1066 21.0917C60.0606 21.9903 60.0068 23.0674 59.9338 24.5055C59.7783 27.3778 59.6823 28.8139 59.5882 30.2482C59.4961 31.6824 59.402 33.1205 59.3444 35.9909C59.2926 38.8613 59.3079 40.2936 59.2964 41.7355C59.2964 43.1755 59.2964 44.6155 59.3482 47.4994C59.4634 53.2671 59.713 53.2613 59.857 59.029C60.0106 64.7967 59.9377 64.7986 60.1066 70.5643C60.1124 70.7506 60.1182 70.9311 60.122 71.1058C60.1239 71.2075 60.1278 71.3266 60.1278 71.4111C60.1278 71.4936 60.1239 71.5743 60.122 71.653C60.1143 71.9698 60.1086 72.2693 60.1028 72.5496C60.0874 73.1122 60.0759 73.6056 60.0644 74.0549C60.0356 74.9535 60.0106 75.6735 59.9876 76.3915C59.9626 77.1307 59.9396 77.8699 59.9089 78.7954C59.9012 79.0027 59.9089 79.2235 59.8724 79.4309C59.8359 79.6363 59.7745 79.8264 59.6631 80.0146C59.4519 80.3851 59.0602 80.6962 58.5975 80.7999C58.369 80.8594 58.0926 80.8498 57.818 80.8421C57.6394 80.8383 57.4532 80.8325 57.2631 80.8287C56.9444 80.8191 56.6046 80.8095 56.2436 80.7999C53.3617 80.7058 51.9198 80.6597 50.4778 80.6117C49.0378 80.5618 47.5978 80.5138 44.7198 80.4792C41.8398 80.4466 40.3998 80.4927 38.9617 80.5349C37.5236 80.5829 36.0836 80.629 33.2094 80.6866C31.7732 80.7231 30.6961 80.7499 29.7994 80.7883C28.9028 80.8229 28.1847 80.8479 27.4666 80.8882C26.7466 80.9247 26.0286 80.9592 25.13 81.0034C24.2142 81.0495 23.1255 81.0821 21.674 81.109C18.7748 81.1551 17.329 81.1224 15.8833 81.0975C14.4375 81.0706 12.9918 81.0399 10.1022 81.0149C8.30696 80.9957 7.07048 80.9823 6.00296 80.9707C5.4692 80.9631 4.97768 80.9573 4.4804 80.9496C3.85256 80.9381 3.21896 80.9266 2.51624 80.9131C2.3588 80.8632 2.18792 80.8075 2.00552 80.748C1.91336 80.7115 1.81352 80.7077 1.73672 80.6213C1.65608 80.5483 1.5908 80.4677 1.53128 80.3736C1.41224 80.1874 1.32584 79.9416 1.274 79.6555C1.24712 79.5135 1.226 79.3618 1.20872 79.2043C1.20104 79.1256 1.19336 79.045 1.18568 78.9643C1.17992 78.901 1.17608 78.8376 1.17032 78.7723C1.11656 78.0101 1.09736 77.1096 1.09928 75.9979C1.06856 70.2379 1.17416 70.2283 1.14152 64.4587C1.10696 58.6853 0.863124 58.6853 0.826644 52.9119C0.801044 49.0655 0.774804 45.2184 0.747924 41.3707C0.713364 35.5954 0.847764 35.5954 0.811284 29.82C0.801684 26.9304 0.795924 25.4847 0.792084 24.0408C0.792084 23.6799 0.792084 23.3189 0.792084 22.9349C0.792084 22.7371 0.792084 22.5336 0.792084 22.3205C0.805524 22.0959 0.817044 21.8635 0.830484 21.6178C0.880404 20.7173 0.939924 19.6363 1.02056 18.1944C1.3316 12.4287 1.39112 12.4325 1.70216 6.66674C1.94216 2.21618 2.3396 2.08754 2.93672 2.12018C3.53384 2.15282 4.10216 2.33138 3.86216 6.79154C3.55112 12.5592 3.46856 12.5535 3.1556 18.3211C3.07688 19.7631 3.00968 20.8421 2.94632 21.7426C2.93864 21.8559 2.93096 21.9653 2.92328 22.0728C2.91944 22.1266 2.9156 22.1803 2.91176 22.2322L2.906 22.3109V22.3493L2.90216 22.3685C2.98856 22.3762 2.1476 22.3147 2.5028 22.3416V22.3493C2.68136 22.3493 2.10536 22.3493 2.90216 22.3493V22.4626C2.90216 22.5125 2.90024 22.5624 2.89832 22.6123C2.89832 22.7122 2.89448 22.8082 2.89448 22.9042C2.8868 23.2863 2.88104 23.6472 2.87336 24.0082C2.84456 25.4501 2.81576 26.892 2.83304 29.7759C2.8676 35.5474 2.98856 35.5455 3.02504 41.317C3.0596 47.0866 3.12488 47.0866 3.15944 52.8543C3.17736 56.7007 3.19528 60.5477 3.2132 64.3954C3.23112 68.2431 3.24264 72.092 3.24776 75.9423C3.24392 76.9599 3.25736 77.7931 3.29 78.4728C3.29384 78.5477 3.29768 78.6187 3.30152 78.6898V78.7186C3.30152 78.7378 3.30152 78.757 3.30152 78.7762C3.30344 78.7915 3.30152 78.8223 3.32072 78.8223C3.33608 78.8261 3.35144 78.828 3.3668 78.8319C3.38408 78.8357 3.39944 78.8376 3.4148 78.8395H3.43592L3.52808 78.8453C3.58952 78.8472 3.64904 78.8511 3.71048 78.853C3.95048 78.8626 4.18664 78.8722 4.4228 78.8818C4.89512 78.8991 5.36936 78.9163 5.89544 78.9355C6.9476 78.9701 8.20328 79.0008 10.0522 79.0181C12.9342 79.0431 14.3742 79.0258 15.8142 79.0047C17.2522 78.9835 18.6903 78.9643 21.5665 78.9221C23.0007 78.8933 24.0759 78.8568 24.963 78.7992C25.8519 78.7474 26.5854 78.6917 27.3054 78.6399C28.0292 78.5842 28.7511 78.54 29.6554 78.4939C30.5598 78.444 31.6465 78.4075 33.0942 78.3711C35.9914 78.3115 37.441 78.3634 38.8887 78.4114C40.3364 78.4671 41.7841 78.517 44.6775 78.5496C47.569 78.5842 49.0167 78.5592 50.4625 78.5343C51.9082 78.5074 53.3578 78.492 56.2398 78.5746C56.5988 78.5861 56.9367 78.5957 57.2535 78.6053C57.3994 78.6091 57.5396 78.613 57.6778 78.6187L57.6817 78.6226C57.6817 78.6226 57.7047 78.6303 57.7143 78.6168C57.7604 77.7682 57.7988 77.0885 57.8353 76.4088C57.8775 75.6869 57.9198 74.9631 57.9601 74.0607C57.9754 73.6095 57.9946 73.1122 58.0138 72.5477C58.0215 72.2655 58.0292 71.9659 58.0388 71.6472C58.0522 71.292 58.0388 71.0904 58.0273 70.693C57.8564 64.9215 57.7566 64.9234 57.603 59.1499C57.459 53.3746 57.3303 53.3784 57.2151 47.6011C57.1614 44.7135 57.2074 43.2658 57.2516 41.82C57.3092 40.3743 57.338 38.9227 57.3879 36.0235C57.4436 33.1282 57.4705 31.6786 57.4993 30.2309C57.5281 28.7832 57.555 27.3355 57.7124 24.4459C57.8602 21.6485 57.9351 20.2488 58.01 18.8511C58.01 18.8376 58.0023 18.8261 57.9927 18.8165C57.987 18.8127 57.9812 18.8088 57.9754 18.8069L57.9678 18.8031L57.8602 18.7147C57.5665 18.469 57.2535 18.2098 56.9079 17.9218C56.2186 17.34 55.393 16.6411 54.291 15.7099C49.898 11.9659 49.9767 11.8738 45.5838 8.12978C44.0036 6.78194 42.9994 5.91026 42.1527 5.16914C41.3233 4.43954 40.6455 3.84434 39.7182 3.02834C39.6874 2.98994 39.6375 2.9669 39.5818 2.97266C39.3342 2.9765 39.0692 2.97842 38.785 2.98226C38.1745 2.99186 37.4775 3.00338 36.6673 3.01682C33.7796 3.06482 32.3338 3.1397 30.89 3.2165C29.4462 3.28946 28.0004 3.36434 25.1089 3.36242C22.2154 3.35666 20.7678 3.32786 19.3201 3.29714C17.8724 3.26258 16.4247 3.22802 13.5294 3.1589C10.8241 3.08402 9.38216 3.01298 7.98824 2.94386C7.2932 2.9093 6.60776 2.87474 5.78216 2.83442C5.37128 2.81522 4.92584 2.79602 4.43432 2.78066C4.28072 2.77682 4.11944 2.77298 3.94664 2.76914C3.9332 2.76914 3.91976 2.76914 3.90632 2.76914C3.89288 2.76914 3.87368 2.76914 3.87368 2.78834C3.87368 2.78834 3.866 2.82482 3.86408 2.8613C3.8372 3.18194 3.81416 3.48338 3.79112 3.76754C3.77 4.08242 3.74888 4.3781 3.72968 4.6565C3.6932 5.21714 3.66248 5.70866 3.63368 6.15602C3.578 7.05458 3.53192 7.77266 3.48776 8.49266C3.39944 9.93266 3.31496 11.3727 3.20168 14.2565C3.03272 18.7109 2.63336 18.9951 2.0324 18.9759C1.4372 18.9567 1.1108 18.6456 1.27976 14.1835V14.1874Z",className:"fill-[#141413] dark:fill-[#FAF9F5]"}),(0,a.jsx)("path",{d:"M57.9159 19.4885C56.1246 19.5269 56.1226 19.3771 54.3313 19.4155C52.5399 19.4539 52.538 19.4021 50.7466 19.4405C48.9553 19.4789 48.9591 19.6325 47.1678 19.6709C45.3764 19.7093 45.3783 19.7727 43.587 19.8111C42.6903 19.8303 42.241 19.7823 41.7918 19.7323L41.7495 19.7285C41.7342 19.7285 41.7265 19.7247 41.6958 19.7247C41.642 19.7227 41.5902 19.7189 41.5364 19.717C41.4308 19.7112 41.3233 19.7112 41.2158 19.6997C40.9988 19.6805 40.7953 19.6287 40.5822 19.525C40.1674 19.3176 39.699 18.8607 39.6721 18.0715C39.6606 17.7797 39.6529 17.5263 39.6433 17.2978C39.6337 17.1231 39.626 16.9695 39.6202 16.8293C39.601 16.549 39.5857 16.3263 39.5722 16.1035C39.5396 15.6562 39.507 15.2088 39.4782 14.3141C39.4308 13.1199 39.3834 11.9256 39.3361 10.7314C39.2785 8.9381 39.3706 8.93426 39.313 7.1429C39.2554 5.35154 39.1575 5.35346 39.0999 3.56018C39.0577 2.23538 39.4839 2.04338 40.0446 2.0261C40.6052 2.00882 40.9662 2.17394 41.0103 3.49874C41.0679 5.28818 41.2599 5.28242 41.3175 7.07186C41.3751 8.86322 41.1601 8.86898 41.2196 10.6603C41.2791 12.4517 41.2388 12.4517 41.2983 14.2431C41.3271 15.1378 41.4001 15.5851 41.473 16.0306C41.5095 16.2533 41.546 16.476 41.5767 16.7563C41.5921 16.8965 41.6055 17.0501 41.619 17.2248C41.6305 17.3746 41.6439 17.6914 41.642 17.6127C41.642 17.628 41.6362 17.6491 41.642 17.6703C41.6458 17.6818 41.6516 17.6895 41.6593 17.701C41.6631 17.7067 41.667 17.7106 41.6727 17.7163C41.6823 17.7221 41.665 17.7279 41.7418 17.7317C42.1911 17.7663 42.6404 17.8008 43.5351 17.7816C44.7294 17.7624 45.9236 17.7426 47.1178 17.7221C48.3121 17.7016 49.507 17.6677 50.7025 17.6203C52.4958 17.5819 52.4919 17.4187 54.2871 17.3803C56.0804 17.3419 56.0804 17.2959 57.8737 17.2555C59.1985 17.2267 59.1294 17.7989 59.1409 18.3576C59.1524 18.9163 59.2446 19.4635 57.9217 19.4923L57.9159 19.4885Z",className:"fill-[#141413] dark:fill-[#FAF9F5]"})]})}var W=s(85239),V=s(87017),q=s(78458),H=s(4262),Y=s(46879),J=s(90732),K=s(11727),X=s(78334),Z=s(57820),Q=s(80870),$=s(49953),ee=s(29820);let et=e=>{let{artifactType:t}=e;return t===x.qK.Excel||t===x.qK.ExcelLegacy?(0,a.jsxs)("div",{className:"absolute inset-0 z-20 text-xs p-2 inline-flex items-center gap-2 bg-accent-secondary-900 text-accent-secondary-200 max-h-12 w-full",children:[(0,a.jsx)(c.R2D,{className:"inline flex-shrink-0 mx-2"}),(0,a.jsx)("span",{className:"line-clamp-2",children:(0,a.jsx)(M.A,{defaultMessage:"Some formatting is not supported by the preview and may not be displayed. Download the file to view all formatting.",id:"pkwiJU5tFY"})})]}):null},es=e=>{let{content:t,language:s,type:n,showRaw:i=!1,richSandboxRef:l,onSandboxConfirmation:r,richSandboxCapabilities:o,fileName:d,onRefresh:c,mimeType:u}=e,[m,f]=(0,N.useState)(null),[h,g]=(0,N.useState)(!0),[C,v]=(0,N.useState)(!1);N.useEffect(()=>{t&&"rich"===n&&!C&&g(!0)},[t,n,C]);let j=(0,N.useCallback)((e,t)=>{if("json"===t&&e)try{let t=JSON.parse(e);return JSON.stringify(t,null,2)}catch(e){}return e},[]),b=(0,N.useCallback)(e=>{f({error:e,artifactId:d||"file",artifactVersion:0})},[d]),y=(0,N.useCallback)(()=>{f(null)},[]),w=(0,N.useCallback)(()=>{f(null),null==c||c()},[c]),_=(0,N.useRef)(null),k=u||("rich"===n?x.vU.Html:void 0),M="rich"===n&&!i&&void 0!==t&&void 0!==k;return(0,a.jsxs)(a.Fragment,{children:[M&&(0,a.jsxs)("div",{className:"h-full w-full relative border-none",children:[h&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-bg-100 z-20",children:(0,a.jsx)(p.Loading,{size:"md"})}),(0,a.jsx)(Y.A,{ref:l,className:"h-full w-full border-none bg-bg-100",content:t,type:k,onSandboxConfirmation:()=>{g(!1),v(!0),null==r||r()},capabilities:o,onReportError:b,onSetContent:y,onRefresh:w,externalLinkBehavior:"ask"}),!h&&(0,a.jsx)(et,{artifactType:k}),m&&(0,a.jsx)(H.i,{error:m,handleClose:()=>f(null),isStreaming:!1})]}),void 0!==t&&"string"==typeof t&&("code"===n||i)&&(0,a.jsx)($.Z,{ref:_,className:"relative flex w-full flex-1 overflow-x-auto overflow-y-scroll min-h-full",children:(0,a.jsx)("div",{tabIndex:0,id:"wiggle-file-content",className:"markdown"!==s&&"plaintext"!==s||i?"":"mx-auto w-full max-w-3xl leading-[1.65rem] px-6 py-4 md:py-6 md:px-11",children:"markdown"!==s||i?(0,a.jsx)(en,{content:j(t,s),language:s,showLineNumbers:"plaintext"!==s,wrapLongLines:"plaintext"===s}):(0,a.jsx)(X.fP,{text:t,className:"font-claude-response",normalizationMode:"markdown-document"})})})]})},ea="code-block__code !my-0 flex-1 w-fit min-w-full !rounded-none !text-sm !leading-relaxed [&_.linenumber]:!not-italic",en=e=>{let{content:t,language:s,showLineNumbers:n,wrapLongLines:i}=e,{codeStyle:l}=(0,Z.V)(),{exceedsSizeLimit:r}=(0,Q.y)(t);return r?(0,a.jsx)(J.R,{code:t,codeClassName:(0,b.A)(ea,"p-4")}):(0,a.jsx)(ee.A,{className:ea,language:s,PreTag:"div",style:l,renderer:K.G,showLineNumbers:n,wrapLongLines:i,lineNumberStyle:{opacity:.667,minWidth:"2.5rem"},children:t})};var ei=s(10304);let el=(0,N.memo)(e=>{let{node:t,depth:s,selectedPath:n,onSelectFile:i,expandedPaths:l,onToggleExpand:r}=e,o=l.has(t.path),d=n===t.path;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:()=>{"directory"===t.type?r(t.path):void 0!==t.content&&i(t.path,t.content)},className:(0,b.A)("flex items-center gap-1.5 w-full text-left py-1 px-2 hover:bg-bg-100 rounded text-sm transition-colors",d&&"bg-bg-200"),style:{paddingLeft:"".concat(12*s+8,"px")},children:["directory"===t.type?(0,a.jsxs)(a.Fragment,{children:[o?(0,a.jsx)(c.aYp,{size:16,className:"text-text-300 flex-shrink-0"}):(0,a.jsx)(c.K3R,{size:16,className:"text-text-300 flex-shrink-0"}),(0,a.jsx)(c.vdG,{size:16,className:"text-text-300 flex-shrink-0"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4"}),(0,a.jsx)(c.ZHH,{size:16,className:"text-text-300 flex-shrink-0"})]}),(0,a.jsx)("span",{className:"text-text-200 truncate",children:t.name})]}),"directory"===t.type&&o&&t.children&&s<10&&(0,a.jsx)("div",{children:t.children.map(e=>(0,a.jsx)(el,{node:e,depth:s+1,selectedPath:n,onSelectFile:i,expandedPaths:l,onToggleExpand:r},e.path))})]})});el.displayName="FileTreeNode";let er=(0,N.memo)(e=>{var t;let{files:s}=e,n=(0,N.useMemo)(()=>(function(e){let t={name:"",path:"",type:"directory",children:[]};for(let s of e){let e=s.path.split("/").filter(Boolean),a=t;for(let t=0;t<e.length;t++){let n=e[t],i=t===e.length-1,l=e.slice(0,t+1).join("/");a.children||(a.children=[]);let r=a.children.find(e=>e.name===n);r||(r={name:n,path:l,type:i?"file":"directory",children:i?void 0:[],content:i?s.content:void 0},a.children.push(r)),a=r}}let s=e=>{if(e.children)for(let t of(e.children.sort((e,t)=>"SKILL.md"===e.name?-1:"SKILL.md"===t.name?1:e.type!==t.type?"directory"===e.type?-1:1:e.name.localeCompare(t.name)),e.children))s(t)};return s(t),t})(s),[s]),i=(0,N.useMemo)(()=>{var e;return(null==(e=n.children)?void 0:e.length)===1&&"directory"===n.children[0].type?n.children[0].children||[]:n.children||[]},[n]),l=(0,N.useMemo)(()=>s.find(e=>e.path.endsWith("SKILL.md"))||s[0],[s]),[r,o]=(0,N.useState)((null==l?void 0:l.path)||null),[d,c]=(0,N.useState)((null==l?void 0:l.content)||""),[u,m]=(0,N.useState)(()=>{let e=new Set,t=s=>{if("directory"===s.type&&s.path&&e.add(s.path),s.children)for(let e of s.children)t(e)};return t(n),e}),p=(e,t)=>{o(e),c(t)},f=e=>{m(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})};return(0,a.jsxs)("div",{className:"flex h-full",children:[(0,a.jsx)("div",{className:"w-64 border-r border-border-100 bg-bg-000 overflow-y-auto flex-shrink-0",children:(0,a.jsx)("div",{className:"p-2",children:i.map(e=>(0,a.jsx)(el,{node:e,depth:0,selectedPath:r,onSelectFile:p,expandedPaths:u,onToggleExpand:f},e.path))})}),(0,a.jsx)("div",{className:"flex-1 min-w-0 overflow-y-auto overflow-x-hidden",children:d?(0,a.jsx)("div",{className:"h-full overflow-y-auto overflow-x-hidden",children:(0,a.jsx)(es,{content:d,type:"code",language:"plaintext",showRaw:!0,fileName:null!=(t=null==r?void 0:r.split("/").pop())?t:"file",mimeType:void 0})}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-text-300",children:(0,a.jsx)(M.A,{defaultMessage:"Select a file to view its content",id:"Cag1YO8/Qh"})})})]})});er.displayName="SkillFileViewer";let eo=()=>(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsx)(p.Loading,{size:"md"})}),ed=e=>{let{error:t,onRetry:s}=e;return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-text-300 gap-4",children:[(0,a.jsx)("div",{children:t}),(0,a.jsx)(u.$,{variant:"secondary",size:"sm",onClick:s,children:(0,a.jsx)(M.A,{defaultMessage:"Try again",id:"FazwRldA7z"})})]})},ec=e=>{let{onLoad:t}=e;return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-text-300 gap-4",children:[(0,a.jsx)(M.A,{defaultMessage:"No file content available",id:"H8DU08sy24"}),(0,a.jsx)(u.$,{variant:"secondary",size:"sm",onClick:t,children:(0,a.jsx)(M.A,{defaultMessage:"Load file",id:"xvpw6mFG1S"})})]})},eu=e=>{let{imageUrl:t,fileName:s}=e;return(0,a.jsx)("div",{className:"h-full p-5",children:(0,a.jsx)("div",{className:"flex items-center justify-center h-full relative w-full",children:(0,a.jsx)(k.default,{src:t,alt:s,fill:!0,className:"object-contain"})})})},em=2500,ep=e=>{var t,p,k,G,H,Y;let{file:J,goBack:K,onClose:X,isShared:Z,projectUuid:Q,isTemporary:$,isStreaming:ee,showBackButton:et,streamingFile:ea,artifactVersions:en,cacheBuster:el}=e,ep=Z?e.snapshotUuid:e.conversationUuid,[eh,eg]=(0,N.useState)(""),[ex,eC]=(0,N.useState)(!1),[ev,ej]=(0,N.useState)(!1),[eb,ey]=(0,N.useState)(null),[ew,e_]=(0,N.useState)(!1),[ek,eN]=(0,N.useState)(!1),[eM,eS]=(0,N.useState)(null),[eA,eE]=(0,N.useState)(null),[ez,eT]=(0,N.useState)("normal"),[eL,eR]=(0,N.useState)([]),{activeOrganization:eI}=(0,r.YL)(),{copyToClipboard:eU}=(0,g.C)(),{addSuccess:eO,addError:eF}=(0,o.Y)(),eD=(0,i.st)(),eP=(0,N.useRef)(null),eB=(0,S.A)(),eG=J.path.split("/").pop()||J.path,eW=(null==ea?void 0:ea.renderAs)===x.vU.Markdown?"markdown":(0,P.S)(J.path),eV=(0,n.f)(),eq=(0,N.useMemo)(()=>({claudeComplete:eV,storage:{}}),[eV]),[eH,eY]=(0,N.useState)(!1),[eJ,eK]=(0,N.useState)(!1),[eX,eZ]=(0,N.useState)(!1),eQ=(0,r.mV)(),e$=(0,E.fo)(Q),e1=(0,N.useMemo)(()=>ex?new Blob([eh]).size<1e6:null,[ex,eh]),e0=(0,N.useMemo)(()=>{if(eh&&ex&&"string"==typeof eh)return null==en?void 0:en.find(e=>e.result_state===eh)},[en,eh,ex]),e2=!$&&"conversationUuid"in e&&e.conversationUuid&&eh&&!ee&&ex&&e1,e3=(0,A.O)({conversationUuid:"conversationUuid"in e?e.conversationUuid:void 0}),e4=$||Z?null:eQ?"share":"publish",{publishedArtifactsBaseUrl:e8,publishedArtifactsEmbedBaseUrl:e9}=(0,l._r)(),e5=(null==(t=e3.data)?void 0:t.published_artifact_uuid)?"".concat(e9,"/public/artifacts/").concat(null==(p=e3.data)?void 0:p.published_artifact_uuid,"/embed"):null,e7=(null==(k=e3.data)?void 0:k.published_artifact_uuid)||(null==e0||null==(G=e0.published_artifact_uuid)?void 0:G.toString()),e6=(0,N.useMemo)(()=>e4?e3.data?(0,ei.x)(e4,e3.data,e8):e0?(0,ei.x)(e4,{artifact_uuid:e0.artifact_uuid,artifact_version_uuid:e0.uuid,message_uuid:e0.message_uuid,published_artifact_uuid:e0.published_artifact_uuid},e8):void 0:null,[e4,e3.data,e8,e0]),{handleProjectFileUpload:te}=(0,L.IE)({projectUuid:Q,onError:()=>{eF(eB.formatMessage({defaultMessage:"Error adding file to project",id:"807qgLdlHv"}),{messageForLogging:"Error adding file to project"})},onSuccess:()=>{eO(eB.formatMessage({defaultMessage:"File added to project",id:"aXguBORPUO"}))}}),tt=(0,L.ED)(Q),{maxKbTokens:ts}=(0,L.AO)(),ta=(0,x.mL)(J.path,eW),tn=/\.(png|jpg|jpeg|gif|bmp|webp)$/i.test(J.path),ti=ta===x.vU.Svg,tl=ta===x.vU.Html,tr=ta===x.vU.React,to=ta===x.vU.Mermaid,td=ta===x.qK.Pdf,tc=ta===x.vU.Markdown,tu=ta===x.qK.Csv,tm=ta===x.qK.Tsv,tp=!!ta&&(0,x.EJ)(ta),tf=!!ta&&(0,x.$1)(ta),th=(0,N.useMemo)(()=>null!==eA&&!ex&&!eb&&!(0,x.IO)(J.path),[eA,ex,eb,J.path]),tg=tl||ti||tr||to||td||tp||tf||tu||tm,tx=ex&&(tc||tl||ti||tr||to||tu||tm),tC=(0,z.kO)(),tv=(0,C.fS)("claudeai_skill_artifact_integration"),tj=ta===x.qK.Skill&&tv,tb=(0,W.z)(J.path,tC),ty=("markdown"===eW||"plaintext"===eW)&&ex,tw=eh&&ex,t_=(0,x.Ys)(J.path,ta)&&ex,tk=(e=>{let[t,s]=(0,N.useState)("");return(0,N.useEffect)(()=>{if(!e)return void s("");let t=()=>{let t=_.c9.fromJSDate(e).toISO();if(!t)return void s("");s((0,v.d)(t)||"")};t();let a=setInterval(t,6e4);return()=>clearInterval(a)},[e]),t})(eA),tN=(0,N.useMemo)(()=>(0,q.k)({filePath:J.path,isShared:Z,conversationUuid:Z?void 0:ep,snapshotUuid:Z?ep:void 0,source:"file_detail_view"}),[J.path,Z,ep]),tM=(0,N.useCallback)(async()=>{if(!(null==eI?void 0:eI.uuid))return void eS(eB.formatMessage({defaultMessage:"Unable to load file content",id:"0IswH+G61x"}));if(!(0,x.IO)(J.path)){eg(""),eC(!1),ey(null),eR([]),eN(!1),ej(!1),eS(null),eE(new Date);return}eN(!0),eS(null),eR([]);try{let e=J.path.replace("computer://",""),t=await (0,T.e)(Z?{organizationUuid:eI.uuid,snapshotUuid:ep,filePath:e,isShared:!0}:{organizationUuid:eI.uuid,conversationUuid:ep,filePath:e,isShared:!1});if(tn){let e=await t.blob(),s=URL.createObjectURL(e);ey(s),eg(""),eC(!1),eR([])}else if(tj){let e=await t.blob(),a=await e.arrayBuffer(),n=(await s.e(2313).then(s.t.bind(s,52313,23))).default,i=await n.loadAsync(a),l=[],r=[];i.forEach((e,t)=>{if(t.dir)return;let s=t.async("text").then(t=>{l.push({path:e,content:t})});r.push(s)}),await Promise.all(r),l.sort((e,t)=>e.path.localeCompare(t.path)),eR(l),eg(""),eC(!1),ey(null)}else if(td||tp||tf){let e=await t.blob(),s=await e.arrayBuffer();eg(s),eC(!1),ey(null),eR([])}else{let e=await t.text();eg(e),eC(!0),ey(null),eR([])}eS(null),eE(new Date)}catch(e){eS(eB.formatMessage({defaultMessage:"Failed to load file content",id:"6u3/Jh2Vzp"}))}finally{ej(!1),eN(!1)}},[null==eI?void 0:eI.uuid,J.path,eB,tn,tj,td,tp,tf,Z,ep]);(0,N.useEffect)(()=>{eT("normal"),eR([])},[J.path]),(0,N.useEffect)(()=>{(null==ea?void 0:ea.content)!==void 0?(eg(ea.content),eC(!0),eN(!1),eS(null),eE(new Date),eR([])):tM()},[tM,null==ea?void 0:ea.content,J.path]);let tS=(0,j.Y)(tM,{leading:!1,delay:em});(0,N.useEffect)(()=>{(0,x.IO)(J.path)&&ej(!0),tS()},[tS,el,null==ea?void 0:ea.content,J.path]),(0,N.useEffect)(()=>()=>{eb&&URL.revokeObjectURL(eb)},[eb]);let tA=()=>{(null==eI?void 0:eI.uuid)&&(0,O.J)(Z?{filepath:J.path,orgUuid:eI.uuid,snapshotUuid:ep,isShared:!0,source:"file_detail_view_header_button"}:{filepath:J.path,orgUuid:eI.uuid,conversationUuid:ep,isShared:!1,source:"file_detail_view_header_button"},eD)},tE=async()=>{if(!tn&&"string"==typeof eh){if(eD.track({event_key:"wiggle.file.copy_to_clipboard",...tN}),tc)try{let e=(0,V.u)(eh);await eU({text:eh,html:e})}catch(e){await eU(eh)}else await eU(eh);e_(!0),setTimeout(()=>e_(!1),2e3)}},tz=async t=>{let{operation:s}=t;if(e.isShared)return;let a=await e3.mutateAsync({path:J.path,operation:s}),n=(0,ei.x)(s,a,e8);n&&await eU(n)},tT=(0,N.useCallback)(async()=>{eD.track({event_key:"wiggle.file.add_to_project",...tN}),eZ(!0);try{let e=new File([eh],eG);await te([e],ts-(null!=tt?tt:0))}finally{eZ(!1)}},[eh,eG,te,ts,tt,eD,tN]),{displayName:tL,displayExt:tR}=(0,B.FT)(J);return(0,a.jsxs)("div",{className:"flex h-full flex-col relative",children:[(0,a.jsx)(a.Fragment,{children:"share"===e4?(0,a.jsx)(R.ke,{isOpen:eH,isProjectArtifact:!!(null==(H=e$.data)?void 0:H.is_private),isLoading:e3.isPending,sharedLink:e6||"",isShared:!!e3.data||(null==e0?void 0:e0.visibility)==="shared",onClose:()=>eY(!1),handleClickShareButton:()=>void tz({operation:"share"}),updateSharedState:()=>void 0}):"publish"===e4?(0,a.jsxs)(f.aF,{hasCloseButton:!0,modalSize:"lg",isOpen:eH,onClose:()=>{eY(!1),eK(!1)},title:(0,a.jsx)("span",{className:"text-text-200 font-claude-response text-xl font-medium",children:(0,a.jsx)(M.A,{defaultMessage:"Publish artifact",id:"D1fyBhklj/"})}),children:[(0,a.jsx)("div",{className:"mt-2 flex flex-col gap-2.5",children:eJ&&e7&&e5?(0,a.jsx)(I.Hz,{artifactUuid:e7,closeEmbedSettings:()=>eK(!1),embedLink:e5}):e7?(0,a.jsx)(I.L_,{artifactUuid:e7,publishedLink:e6||"",onClose:()=>eY(!1)}):(0,a.jsx)(I._L,{title:eG,isLoading:e3.isPending,fetchScreenshot:()=>Promise.resolve(),setScreenshot:()=>void 0,handlePublishArtifact:()=>{tz({operation:"publish"})}})}),(0,a.jsx)(I.gy,{isPublished:!!(null==(Y=e3.data)?void 0:Y.published_artifact_uuid),isEmbedSettingsOpen:eJ,onOpen:()=>eK(!0)})]}):null}),(0,a.jsxs)("div",{className:"flex items-center justify-between px-2 py-2 bg-bg-000 gap-2",children:[et?(0,a.jsx)(u.$,{variant:"ghost",size:"icon",onClick:K,disabled:!!ea,"aria-label":eB.formatMessage({defaultMessage:"Go back",id:"orvpWhO3rI"}),className:"!rounded-lg",children:(0,a.jsx)(c.ZK0,{})}):(0,a.jsx)("div",{className:"w-2",children:"\xa0"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-1 overflow-hidden",children:[tx&&(0,a.jsx)(d.Iz,{options:[{key:"normal",label:(0,a.jsx)(c.kU3,{size:20}),ariaLabel:eB.formatMessage({defaultMessage:"Preview",id:"TJo5E6JuIN"})},{key:"raw",label:(0,a.jsx)(c.CyN,{size:20}),ariaLabel:eB.formatMessage({defaultMessage:"Code",id:"h2vipunVVd"})}],initialKey:ez,onSelect:e=>{eT("normal"===e?"normal":"raw")},itemClassName:"!px-1"},ez),(0,a.jsxs)("h2",{className:(0,b.A)("text-sm font-normal text-text-200 truncate flex-1 min-w-0"),title:tL,children:[tL,tR?(0,a.jsx)("span",{className:"text-text-400 opacity-50",children:" \xb7 "}):"",tR&&(0,a.jsx)("span",{className:"text-text-400",children:tR})]}),(0,a.jsx)(y.N,{children:ew&&(0,a.jsxs)(w.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{enter:{duration:.4,ease:"easeOut"},exit:{duration:.3,ease:"easeIn"}},className:"flex items-center gap-1 text-sm text-success-200 ml-2 mr-3 flex-shrink-0",children:[(0,a.jsx)(c.rAV,{size:16,className:"text-success-200"}),(0,a.jsx)("span",{className:"text-success-200",children:(0,a.jsx)(M.A,{defaultMessage:"Copied",id:"p556q3uvbn"})})]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 flex-shrink-0",children:[tb&&!Z&&e.conversationUuid&&(0,a.jsx)(F.M,{file:J,conversationUuid:e.conversationUuid,source:"file_detail_view",variant:"secondary",size:"icon_sm",className:"!rounded-lg"}),!Z&&e.conversationUuid&&tv&&(0,a.jsx)(D.a,{file:J,conversationUuid:e.conversationUuid,source:"file_detail_view",variant:"secondary",size:"sm",className:"!rounded-lg"}),ex||Q||ty||tw?(0,a.jsx)("div",{className:"[&_button]:!text-xs [&>div]:!rounded-lg",children:(0,a.jsxs)(m.AM,{mainButtonText:t_?(0,a.jsx)(M.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"}):(0,a.jsx)(M.A,{defaultMessage:"Download",id:"5q3qC0sC3r"}),onClickMainButton:t_?tE:tA,children:[ex&&(0,a.jsx)(m.tJ,{onSelect:t_?tA:tE,children:t_?(0,a.jsx)(M.A,{defaultMessage:"Download",id:"5q3qC0sC3r"}):(0,a.jsx)(M.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"})},t_?"download":"copy"),Q&&(0,a.jsx)(m.tJ,{onSelect:tT,disabled:eX||!eh,children:(0,a.jsx)(M.A,{defaultMessage:"Add to project",id:"+mqxxzVczn"})},"addToProject"),ty&&(0,a.jsx)(m.tJ,{onSelect:async()=>{eD.track({event_key:"wiggle.file.download_as_pdf",...tN});try{await (0,U.NX)(J)}catch(e){eS(eB.formatMessage({defaultMessage:"Error downloading PDF",id:"fes7nfwp3b"}))}},children:(0,a.jsx)(M.A,{defaultMessage:"Download as PDF",id:"camH0DLf91"})},"downloadAsPdf"),tw&&(0,a.jsx)(m.tJ,{disabled:!e2,onSelect:()=>{eD.track({event_key:"share"===e4?"wiggle.file.share_artifact":"wiggle.file.publish_artifact",...tN}),eY(!0)},children:(0,a.jsxs)("div",{className:"flex flex-col",children:["share"===e4?(0,a.jsx)(M.A,{defaultMessage:"Share artifact",id:"FeSSOL+/49"}):(0,a.jsx)(M.A,{defaultMessage:"Publish artifact",id:"D1fyBhklj/"}),(0,a.jsxs)("span",{className:"text-text-300 text-xs",children:[e0&&e4&&("share"===e4?(0,a.jsx)(M.A,{defaultMessage:"Content already shared",id:"nTW7eXdjH7"}):(0,a.jsx)(M.A,{defaultMessage:"Content already published",id:"h9MXOgEjET"})),!(e0&&e4)&&!e1&&(0,a.jsx)(M.A,{defaultMessage:"File is too large",id:"uFwMw7Ndmt"})]})]})},(null!=e4?e4:"")+"-"+J.path)]})}):(0,a.jsx)(u.$,{variant:"secondary",onClick:tA,size:"sm",className:"!rounded-lg",children:(0,a.jsx)(M.A,{defaultMessage:"Download",id:"5q3qC0sC3r"})}),(0,a.jsx)(h.Tooltip,{tooltipContent:ev||ek?eB.formatMessage({defaultMessage:"Refreshing",id:"crQQNCV/SV"}):tk?eB.formatMessage({defaultMessage:"Last refreshed {time}",id:"qVxqSOlF4R"},{time:tk}):void 0,delayDuration:50,children:(0,a.jsx)(u.$,{variant:"ghost",size:"icon",onClick:tM,disabled:ek||th,children:(0,a.jsx)(c.MvQ,{size:20,className:(0,b.A)((ev||ek)&&"animate-spin")})})}),(0,a.jsx)(u.$,{variant:"ghost",size:"icon",onClick:X,children:(0,a.jsx)(c.X,{size:20})})]})]}),(0,a.jsx)("div",{className:"flex-1 min-h-0 bg-bg-000 overflow-auto",children:!ek||eh||eb||0!==eL.length?eM?(0,a.jsx)(ed,{error:eM,onRetry:tM}):th?(0,a.jsx)(ef,{file:J}):eL.length>0?(0,a.jsx)(er,{files:eL}):eh||eb?tn&&eb?(0,a.jsx)(eu,{imageUrl:eb,fileName:eG}):(0,a.jsx)("div",{className:"h-full",children:(0,a.jsx)(es,{content:eh,type:tg?"rich":"code",language:eW,showRaw:"raw"===ez,richSandboxRef:eP,richSandboxCapabilities:eq,fileName:eG,onRefresh:tM,mimeType:ta})}):(0,a.jsx)(ec,{onLoad:tM}):(0,a.jsx)(eo,{})})]})},ef=e=>{let{file:t}=e,{displayName:s}=(0,B.FT)(t),n=(0,B.Xp)(t);return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(G,{})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-text-100 font-medium text-lg",children:s}),(0,a.jsx)("div",{className:"text-text-300 text-sm",children:n})]}),(0,a.jsx)("div",{className:"text-text-300",children:(0,a.jsx)(M.A,{defaultMessage:"No preview available",id:"vYALkaFo+6"})})]})}},75103:(e,t,s)=>{s.d(t,{t:()=>r});var a=s(54568),n=s(64328),i=s(59666),l=s(45538);function r(e){let t,{project:s,className:r}=e,{account:o}=(0,n.YL)();if(s.is_starter_project)t=(0,a.jsx)(i.A,{defaultMessage:"Created by Anthropic",id:"qWDgsCW3nw"});else if(s.type===l.gM.Haystack)t=(0,a.jsx)(i.A,{defaultMessage:"Created by your admin",id:"QV1CaRw5pU"});else{var d;t=(null==(d=s.creator)?void 0:d.full_name)?s.creator.uuid===(null==o?void 0:o.uuid)?(0,a.jsx)(i.A,{defaultMessage:"Created by you",id:"WEhuQZAqE6"}):(0,a.jsx)(i.A,{defaultMessage:"Created by {author}",id:"7POMfMfi+y",values:{author:s.creator.full_name}}):(0,a.jsx)(i.A,{defaultMessage:"Created by unknown",id:"QEI1plMxfE"})}return(0,a.jsx)("span",{className:r,children:t})}},78418:(e,t,s)=>{s.d(t,{M:()=>u});var a=s(54568),n=s(9398),i=s(23812),l=s(67453),r=s(59666),o=s(22167),d=s(82342),c=s(85239);function u(e){let{file:t,conversationUuid:s,source:u,variant:m="ghost",size:p="icon_lg",className:f}=e,h=(0,o.kO)(),{handleOpenInGoogleDrive:g,showConnectionModal:x,setShowConnectionModal:C,connectionError:v,isExporting:j}=(0,c.N)({conversationUuid:s,source:u});return(0,c.z)(t.path,h)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Tooltip,{tooltipContent:(0,a.jsx)(r.A,{defaultMessage:"Open in Drive",id:"r80/2fFyeU"}),side:"bottom",children:(0,a.jsx)(i.$,{variant:j?"secondary":m,size:p,loading:j,onClick:e=>{e.preventDefault(),e.stopPropagation(),g(t.path)},className:f,children:!j&&(0,a.jsx)(n.ft,{size:"icon_sm"===p?16:"icon"===p?20:24})})}),(0,a.jsx)(d.h,{isOpen:x,onClose:()=>{C(!1)},errorType:v,callerIdentifier:"google-drive-export-button",pathname:"/chat/".concat(s)})]}):null}},78458:(e,t,s)=>{s.d(t,{k:()=>n});var a=s(57291);function n(e){let{filePath:t,isShared:s,conversationUuid:n,snapshotUuid:i,source:l}=e,r=t.replace("computer://",""),o=t.split(".").pop()||"";return{file_id:function(e){let t=e.replace("computer://",""),s=5381;for(let e=0;e<t.length;e++)s=(s<<5)+s+t.charCodeAt(e);return Math.abs(s).toString(16)}(t),file_extension:o,is_snapshot:s,is_viewable_file:(0,a.IO)(t),is_output_file:r.startsWith("/mnt/user-data/outputs/"),conversation_uuid:s?null:n||null,snapshot_uuid:s&&i||null,source:l}}},78671:(e,t,s)=>{s.d(t,{M9:()=>i,NX:()=>l});var a=s(57291);async function n(e){let{title:t,element:s}=e;return new Promise((e,a)=>{try{var n;let i=document.head.innerHTML,l=document.createElement("iframe");l.style.position="fixed",l.style.right="0",l.style.bottom="0",l.style.width="0",l.style.height="0",l.style.border="0",l.setAttribute("sandbox","allow-same-origin allow-modals"),l.setAttribute("csp","");let r=!1;l.onload=()=>{r=!0},document.body.appendChild(l);let o=l.contentDocument||(null==(n=l.contentWindow)?void 0:n.document);if(!o){document.body.removeChild(l),a(Error("Could not access iframe document"));return}o.write("\n        <!DOCTYPE html>\n        <html>\n          <head>\n            <title>".concat(t,"</title>\n            ").concat(i,"\n            <style>\n              /* Remove browser-added headers and footers */\n              @page {\n                size: auto;\n                margin: 0; /* Keep at 0 to remove datetime, page count, website, etc */\n                padding: 25px 0; /* top and bottom page padding */\n              }\n              @media print {\n                html, body, pre, code {\n                  -webkit-print-color-adjust: exact !important;\n                  color-adjust: exact !important;\n                  print-color-adjust: exact !important;\n                }\n              \n                /* Smart page breaks */\n                h1, h2, h3 {\n                  page-break-after: avoid !important;\n                }\n                img, pre, table {\n                  page-break-inside: avoid !important;\n                }\n              }\n            </style>\n          </head>\n          <body>\n            ").concat(s.outerHTML,"\n          </body>\n        </html>\n      ")),o.close();let d=document.title,c=()=>{try{var s,n;document.title=t;try{null==(s=l.contentWindow)||s.print()}catch(e){null==(n=l.contentDocument)||n.execCommand("print")}setTimeout(()=>{u(),e()},100)}catch(e){u(),a(e)}},u=()=>{try{document.title=d,document.body.removeChild(l)}catch(e){}};r?c():(l.onload=c,l.onerror=e=>{u(),a(e)})}catch(e){a(e)}})}async function i(e){if(e.type!==a.vU.Markdown)throw Error("Only markdown artifacts can be saved as PDF");let t=document.getElementById("markdown-artifact");if(!t)throw Error("Markdown artifact element not found");return n({title:(null==e?void 0:e.title)||"Artifact",element:t})}async function l(e){let t=document.getElementById("wiggle-file-content");if(!t)throw Error("File content element not found");return n({title:e.path.split("/").pop()||e.path,element:t})}},79372:(e,t,s)=>{s.d(t,{b:()=>T});var a=s(54568),n=s(72902),i=s(7620);function l(e){let{ref:t,children:s,parentClassName:l,innerClassName:r,pinToBottomConfig:o={disabled:!1,initialValue:!1}}=e,d=(0,i.useRef)(null),c=(0,i.useRef)(null),u=(0,i.useRef)(o.initialValue),m=(0,i.useRef)(!1),p=(0,i.useRef)(!1),f=(0,i.useRef)(null),h=(0,i.useCallback)(()=>d.current,[]),g=(0,i.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto",t=arguments.length>1?arguments[1]:void 0;if(!d.current||(null==t?void 0:t.onlyIfPinned)&&!u.current)return;let{scrollHeight:s,scrollTop:a,clientHeight:n}=d.current;a>s-n||(p.current=!0,d.current.scrollTo({top:d.current.scrollHeight,behavior:e}),f.current&&clearTimeout(f.current),f.current=window.setTimeout(()=>{p.current=!1},0))},[]),x=(0,i.useCallback)(e=>{u.current=e},[]);return(0,i.useImperativeHandle)(t,()=>({getScrollContainer:h,scrollToBottom:g,setPinToBottom:x,innerRef:c}),[h,g,x]),(0,i.useLayoutEffect)(()=>{let e=d.current,t=c.current;if(!e||!t||o.disabled)return;let s=()=>{if(p.current)return;let{scrollHeight:t,scrollTop:s,clientHeight:a}=e,n=8>Math.floor(t-s-a);m.current=n,n||(u.current=!1)},a=new ResizeObserver(()=>{u.current&&g()});return e.addEventListener("scroll",s),a.observe(t),()=>{e.removeEventListener("scroll",s),a.disconnect(),f.current&&clearTimeout(f.current)}},[c,o.disabled,g]),(0,a.jsx)("div",{className:(0,n.A)("overflow-y-scroll overflow-x-hidden",l),ref:d,children:(0,a.jsx)("div",{className:(0,n.A)("relative w-full min-h-full",r),ref:c,children:s})})}var r=s(44e3),o=s(18727),d=s(59093),c=s(29493),u=s(19736),m=s(34003),p=s(89626),f=s(2297),h=s(23812),g=s(47592),x=s(37541),C=s(68067),v=s(28044),j=s(19664),b=s.n(j),y=s(59666),w=s(45538),_=s(22624),k=s(15912),N=s(19455),M=s(45318),S=s(19150);let A=(0,i.memo)(function(e){var t;let{conversationUuid:s,name:l,isInteractive:r=!0,sharedBy:o,project:d,controlsSidebarIsOpen:c,openControlsSidebar:j,closeControlsSidebar:A,isStreaming:E,isLoading:z}=e,T=!!o,{data:L}=(0,u.Bq)(s,{enabled:!T}),R=(0,m.u9)(),I=!!d&&!d.is_harmony_project,U=(0,v.V)(x.E_),[O,F]=(0,i.useState)(!1),[D,P]=(0,i.useState)(""),[B,G]=(0,i.useState)(null),W=(0,i.useRef)(null),{mutate:V}=(0,u.HI)(s),[q,H]=(0,i.useState)(!1),Y=(0,i.useRef)(null),J=(0,_.K)(),K=(0,C.fS)("move_conversation_to_projects"),{data:X}=(0,w.PL)(),Z=!!(J&&K&&L&&!L.is_temporary&&!L.project_uuid&&!T&&(null!=(t=null==X?void 0:X.count)?t:0)>=2&&l.length>0),Q=e=>{L&&!L.is_temporary&&((0,g.fJ)()||(e.preventDefault(),e.stopPropagation(),F(!0),P(l||""),G(null)))},$=()=>{if(D.trim()&&L){let e=D.trim();e!==l&&(G(e),V({name:e},{onSettled:()=>{G(null)}}))}F(!1)},ee=e=>{"Enter"===e.key?(e.preventDefault(),$()):"Escape"===e.key&&(e.preventDefault(),F(!1),P(l||""))};return((0,i.useEffect)(()=>{O&&W.current&&(W.current.focus(),W.current.select())},[O]),r&&L&&L.is_temporary)?null:(0,a.jsxs)(M.z,{className:(0,n.A)("h-12",!U&&"-mb-3"),contentClassName:(0,n.A)("gap-6",U?"pl-0":"p-3 lg:pl-4 lg:pr-3"),"data-testid":"chat-header",sticky:!0,children:[(0,a.jsxs)("div",{className:"flex min-w-0 flex-1 shrink md:items-center font-base-bold pr-[100px]",children:[I&&(0,a.jsxs)("div",{className:"text-text-300 hover:text-text-100 inline-flex min-w-0 shrink-[4] items-center max-md:pl-1 gap-1",children:[(0,a.jsx)(b(),{href:"/project/".concat(d.uuid),className:"truncate",children:d.name}),(0,a.jsx)("span",{className:"opacity-50 px-0.5",children:"/"})]}),(0,a.jsx)("div",{className:"flex min-w-0 shrink-1 items-center group",children:z?(0,a.jsx)("div",{className:"animate-pulse h-5 w-32 rounded-lg bg-bg-300"}):r&&L?L.is_temporary?(0,a.jsxs)("div",{className:"flex flex-row items-center text-text-300 gap-2 cursor-default",children:[(0,a.jsx)(f.X3,{}),(0,a.jsx)(y.A,{defaultMessage:"Incognito chat",id:"MZWV60Fq3N"})]}):(0,a.jsxs)(a.Fragment,{children:[O?(0,a.jsx)("div",{className:"flex items-center bg-bg-000 border border-accent-secondary-100 rounded-md h-7 w-48 px-1.5",onClick:e=>e.stopPropagation(),children:(0,a.jsx)("input",{ref:W,type:"text",value:D,onChange:e=>P(e.target.value),onKeyDown:ee,onBlur:$,className:"bg-transparent border-none outline-none focus:outline-none focus:ring-0 focus:border-transparent font-base-bold text-text-000 w-full overflow-x-auto",style:{outline:"none",boxShadow:"none"},"data-testid":"name-chat",autoFocus:!0})}):(0,a.jsxs)("div",{className:"flex items-center group [&:hover>button]:!bg-bg-300 [&>button:hover]:!bg-bg-500",children:[(0,a.jsx)(h.$,{ref:Y,variant:"ghost",size:"default",className:(0,n.A)(0===l.length?"!text-text-500":"!text-text-300 hover:!text-text-100","!shrink !min-w-0 !px-2 !py-0 !scale-100 !h-7 !rounded-r-none","active:!bg-bg-500",q&&"!bg-bg-300"),onClick:Q,"data-testid":"chat-title-button",children:(0,a.jsx)("div",{className:"min-w-0 flex-1",children:(0,a.jsx)("div",{className:"truncate font-base-bold",children:B||(l.length>0?l:(0,a.jsx)(y.A,{defaultMessage:"Untitled",id:"3kbIhS7KZS"}))})})}),(0,a.jsx)("div",{className:"w-[1.5px] h-7"}),(0,a.jsx)(N.p,{conversation:L,initialName:l,open:q,onOpenChange:H,trigger:(0,a.jsx)(h.$,{variant:"ghost",size:"icon_sm",className:(0,n.A)("!h-7 !w-7 !rounded-l-none !text-text-300 hover:!text-text-100","active:!bg-bg-500",q&&"!bg-bg-500"),"data-testid":"chat-menu-trigger",children:(0,a.jsx)(p.biH,{size:16})})})]}),(0,a.jsx)(k.V,{anchorRef:Y,canShowNux:Z,text:(0,a.jsx)(y.A,{defaultMessage:"You can now add existing conversations to projects",id:"7aTXzVESIs"}),id:"move-chat-to-project-nux",nuxItem:{dateAdded:"2025-09-15"},side:"bottom",align:"start"})]}):(0,a.jsx)("div",{className:"truncate text-text-300 cursor-pointer hover:text-text-100",onClick:Q,children:O?(0,a.jsx)("input",{ref:W,type:"text",value:D,onChange:e=>P(e.target.value),onKeyDown:ee,onBlur:$,className:"bg-transparent border-0 outline-none focus:outline-none focus:ring-0 font-base-bold text-text-300 w-full","data-testid":"name-chat",onClick:e=>e.stopPropagation()}):(0,a.jsx)(a.Fragment,{children:B||(l.length>0?l:(0,a.jsx)(y.A,{defaultMessage:"Untitled",id:"3kbIhS7KZS"}))})})})]}),(0,a.jsxs)("div",{className:"right-3 flex gap-2",children:[T&&(0,a.jsx)("div",{className:"bg-bg-300 text-text-300 rounded-full px-3 py-1.5 font-base-bold",children:(0,a.jsx)(y.A,{defaultMessage:"Shared by {sharedBy}",id:"UMLOHo6H9c",values:{sharedBy:o}})}),s&&!T&&!R&&(0,a.jsx)(S.O,{conversationUuid:s,controlsSidebarIsOpen:c,openControlsSidebar:j,closeControlsSidebar:A,isStreaming:E,isTemporary:null==L?void 0:L.is_temporary})]})]})});var E=s(55188),z=s(18849);function T(e){let{headerProps:t,mainElement:s,drawerElement:u,auxilaryElement:m,isDrawerOpen:p,autoscrollRef:f,rightSidebarElement:h,autoScrollInnerClassName:g}=e,[x,C]=(0,i.useState)(!1),v=(0,i.useRef)(null),j=(0,i.useRef)(null),b=(0,i.useRef)(null),y=(0,i.useRef)({interacted:!1}),{setIsDrawerExpanded:w}=(0,z.x)(),{incognitoModeEnabled:_}=(0,E.S)(),k=(0,r.F)("md");(0,i.useEffect)(function(){let e=!0;if(!j.current||!v.current||!N.current||!b.current)return;let t=v.current,s=j.current,a=b.current;if(k){let e=p?window.innerWidth/2-d.r:s.getBoundingClientRect().width;a.style.width="".concat(e,"px")}let n=k&&!!h,i=N.current.getBoundingClientRect().width,l=n?384/i*100:0,r=Date.now(),o=p?l:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=parseFloat(e);return isNaN(s)?t:s}(s.style.flexGrow,50);return p&&(requestAnimationFrame(function n(){if(!e)return;let i=(Date.now()-r)/220,o=l+i*(50-l);if(i>=1||!k){t.style.flex=String(50),s.style.flex=String(50),a.style.width="auto";return}t.style.flex=String(100-o),s.style.flex=String(o),requestAnimationFrame(n)}),y.current.interacted=!0),!p&&y.current.interacted&&requestAnimationFrame(function n(){if(!e)return;let i=(Date.now()-r)/220,l=o-i*o;if(i>=1||!k){t.style.flex=String(100),s.style.flex=String(0),a.style.width="auto";return}t.style.flex=String(100-l),s.style.flex=String(l),requestAnimationFrame(n)}),()=>{e=!1}},[p]);let[N,M]=(0,o.w)();return(0,i.useEffect)(()=>{if(!j.current||!v.current||!N.current)return;let e=N.current.getBoundingClientRect(),t=v.current.getBoundingClientRect();if(window.innerWidth<c.gU||t.width>c.Db)return;let s=c.Db/e.width*100;v.current.style.flex=String(s),j.current.style.flex=String(100-s)},[M.width,M.height,N]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:(0,n.A)("flex flex-1 h-full w-full overflow-hidden relative",x&&"select-none"),ref:N,onMouseUp:function(){C(!1),document.body.style.removeProperty("cursor")},onMouseMove:e=>{var t,s;if(!x||!j.current||!v.current||!N.current)return;let a=N.current.getBoundingClientRect(),n=v.current.getBoundingClientRect(),i=(t=e.clientX-n.left,s=c.Db,Math.min(Math.max(t,s),a.width-240)/a.width*100);v.current.style.flex=String(i),j.current.style.flex=String(100-i)},children:[(0,a.jsxs)("div",{ref:v,className:"h-full flex flex-col overflow-hidden",style:{flex:"".concat(100," 0")},children:[(0,a.jsx)(A,{...t}),(0,a.jsx)(l,{ref:f,parentClassName:"pt-6 flex-1",innerClassName:g,children:s})]}),(0,a.jsxs)("div",{className:(0,n.A)("max-md:hidden group w-2 relative h-full cursor-col-resize -mr-1 z-30 grid place-items-center",!p&&"hidden"),onMouseDown:function(){C(!0),document.body.style.setProperty("cursor","col-resize")},children:[(0,a.jsx)("div",{className:(0,n.A)("absolute top-0 bottom-0 right-1 w-[0.5px] bg-border-300","transition-all group-hover:delay-75 group-hover:bg-accent-secondary-100 group-hover:w-px group-hover:translate-x-[0.5px]",x&&"!bg-accent-secondary-000")}),(0,a.jsx)("div",{className:(0,n.A)("h-6 w-2 relative","rounded-full border-0.5 bg-bg-100 shadow border-border-300","transition duration-200 group-hover:delay-75 group-hover:border-accent-secondary-900 group-hover:bg-accent-secondary-900","cursor-col-resize",x&&"!bg-accent-secondary-000 !border-accent-secondary-000")})]}),(0,a.jsx)("div",{ref:j,className:(0,n.A)("max-md:absolute top-0 right-0 bottom-0 left-0 z-20","md:flex-grow-0 md:flex-shrink-0 md:basis-0","overflow-hidden h-full",p?"max-md:flex-1":"max-md:hidden",x&&"pointer-events-none"),style:{flex:"0 0"},children:(0,a.jsxs)("div",{ref:b,className:"flex flex-col h-full overflow-hidden",children:[!_&&(0,a.jsx)("div",{className:"h-12 md:hidden bg-bg-000/30 backdrop-blur border-b-0.5 border-border-300",onClick:()=>{w(!1)}}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden h-full bg-bg-100",children:u})]})}),h]}),null!=m?m:null]})}},79901:(e,t,s)=>{s.d(t,{S:()=>L,o:()=>R});var a=s(54568),n=s(89626),i=s(38080),l=s(25391),r=s(81783),o=s(65607),d=s(4694),c=s(9412),u=s(34863),m=s(19148),p=s(29586),f=s(69911),h=s(34191),g=s(92774),x=s(80817),C=s(29780),v=s(9010),j=s(49275),b=s(4226),y=s(28591),w=s(46491),_=s(76432),k=s(47471),N=s(23044),M=s(17055),S=s(90449),A=s(69841),E=s(45184);let z={html:"html",htm:"html",xhtml:"html",css:"css",scss:"scss",sass:"sass",less:"less",js:"javascript",jsx:"jsx",ts:"typescript",tsx:"tsx",json:"json",yaml:"yaml",yml:"yaml",xml:"xml",svg:"svg",py:"python",rb:"ruby",php:"php",java:"java",c:"c",h:"c",cpp:"cpp",cc:"cpp",cxx:"cpp",hpp:"cpp",cs:"csharp",go:"go",rs:"rust",swift:"swift",kt:"kotlin",scala:"scala",dart:"dart",lua:"lua",pl:"perl",r:"r",sh:"bash",bash:"bash",zsh:"bash",fish:"fish",bat:"batch",cmd:"batch",ps1:"powershell",md:"markdown",markdown:"markdown",skill:"skill",mermaid:"mermaid",mmd:"mermaid",tex:"latex",rst:"restructuredtext",asciidoc:"asciidoc",adoc:"asciidoc",csv:"csv",tsv:"tsv",toml:"toml",ini:"ini",conf:"ini",cfg:"ini",sql:"sql",graphql:"graphql",gql:"graphql",dockerfile:"dockerfile",dockerignore:"docker",gitignore:"git",gitattributes:"git",editorconfig:"editorconfig",diff:"diff",patch:"diff",nginx:"nginx",htaccess:"apacheconf"};function T(e){var t;return(null==(t=e.split(".").pop())?void 0:t.toLowerCase())||""}function L(e){return z[T(e).toLowerCase()]||"plaintext"}function R(e){let{path:t,size:s=16}=e,z=T(t);if(t.includes("SKILL.md"))return(0,a.jsx)(n.xPp,{size:s});switch(z){case"pdf":return(0,a.jsx)(i.T,{size:s});case"c":return(0,a.jsx)(l.s,{size:s});case"cs":return(0,a.jsx)(r.e,{size:s});case"cpp":return(0,a.jsx)(E.y,{size:s});case"css":return(0,a.jsx)(o.y,{size:s});case"csv":return(0,a.jsx)(d.F,{size:s});case"doc":case"docx":return(0,a.jsx)(c.j,{size:s});case"html":case"htm":case"xhtml":return(0,a.jsx)(u._,{size:s});case"jpg":case"jpeg":return(0,a.jsx)(m.a,{size:s});case"js":return(0,a.jsx)(p.u,{size:s});case"jsx":return(0,a.jsx)(f.m,{size:s});case"md":return(0,a.jsx)(h.C,{size:s});case"skill":return(0,a.jsx)(n.xPp,{size:s});case"png":return(0,a.jsx)(g.K,{size:s});case"ppt":case"pptx":return(0,a.jsx)(x.z,{size:s});case"py":return(0,a.jsx)(C.I,{size:s});case"rs":return(0,a.jsx)(v.q,{size:s});case"sql":return(0,a.jsx)(j.b,{size:s});case"svg":return(0,a.jsx)(b.V,{size:s});case"ts":return(0,a.jsx)(y.G,{size:s});case"tsx":return(0,a.jsx)(w.M,{size:s});case"txt":return(0,a.jsx)(_.r,{size:s});case"vue":return(0,a.jsx)(k.x,{size:s});case"xls":case"xlsx":return(0,a.jsx)(N.K,{size:s});case"zip":return(0,a.jsx)(M.g,{size:s});case"gif":case"bmp":case"webp":case"ico":return(0,a.jsx)(S.C,{size:s});default:return(0,a.jsx)(A.i,{size:s})}}},82342:(e,t,s)=>{s.d(t,{K:()=>x,h:()=>C});var a=s(54568),n=s(74813),i=s(64328),l=s(89626),r=s(9398),o=s(94470),d=s(23812),c=s(3075),u=s(2e3),m=s(7620),p=s(59666),f=s(79052),h=s(12142),g=s(22167),x=function(e){return e.NOT_CONNECTED="not_connected",e.MISSING_SCOPE="missing_scope",e.UNKNOWN="unknown",e}({});let C=e=>{let{isOpen:t,onClose:s,errorType:x,onConnectionSuccess:C,callerIdentifier:v,pathname:j}=e,b=(0,n.st)(),{activeOrganization:y}=(0,i.YL)(),[w,_]=(0,m.useState)(!1),k=(0,g.kO)(),{serverId:N}=(0,f.cj)(),M=(0,h.Q)({pathname:j,queryString:"gdrive_export_success=".concat(v||"gdrive-export-modal")}),{initDriveAuth:S}=(0,f.cI)({callerIdentifier:v||"gdrive-export-modal",pathname:j,handleAuthSuccess:()=>{_(!1),b.track({event_key:"wiggle.gdrive.connection.success",organization_id:null==y?void 0:y.uuid,error_type:x,caller_identifier:v}),s(),setTimeout(()=>{null==C||C()},100)}});if((0,g.FZ)({callerIdentifier:v||"gdrive-export-modal",successParam:"gdrive_export_success",handleOpen:()=>{_(!1),b.track({event_key:"wiggle.gdrive.connection.success",organization_id:null==y?void 0:y.uuid,error_type:x,caller_identifier:v}),s(),setTimeout(()=>{null==C||C()},100)}}),(0,m.useEffect)(()=>{t&&b.track({event_key:"wiggle.gdrive.connection.modal_shown",organization_id:null==y?void 0:y.uuid,error_type:x,caller_identifier:v})},[t,x,v,null==y?void 0:y.uuid,b]),"unknown"===x)return null;let{title:A,description:E,buttonText:z}=(()=>{switch(x){case"not_connected":return{title:"Connect Claude to Google Drive",description:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{children:(0,a.jsx)(p.A,{defaultMessage:"This will allow Claude to:",id:"Fh77iGv4CM"})}),(0,a.jsxs)("ul",{className:"list-disc pl-5 text-sm text-text-300 space-y-1",children:[(0,a.jsx)("li",{children:(0,a.jsx)(p.A,{defaultMessage:"Add DOCX, XLSX, and PPTX files that it creates directly to Google Drive",id:"H4PCn1IJGu"})}),(0,a.jsx)("li",{children:(0,a.jsx)(p.A,{defaultMessage:"Search and summarize Google Drive files",id:"o+UM/Lfa+u"})})]})]}),buttonText:"Connect"};case"missing_scope":return{title:"Reconnect Claude to Google Drive",description:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{children:(0,a.jsx)(p.A,{defaultMessage:"This will give Claude permission to see, edit, create, and delete files that it creates in Google Drive.",id:"vHppAPeTNV"})}),(0,a.jsx)(o.l,{variant:"secondary",icon:l.R2D,message:(0,a.jsx)(p.A,{defaultMessage:"Youâ€™ll only need to do this once. Any existing Google Drive capabilities in Claude will still work.",id:"v8YR2us4Y6"})})]}),buttonText:"Reconnect"}}})();return(0,a.jsx)(c.aF,{modalSize:"lg",isOpen:t,onClose:s,hasCloseButton:!0,title:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(r.A9,{type:u.v8.GDRIVE,size:20}),(0,a.jsx)("span",{children:A})]}),children:(0,a.jsxs)("div",{className:"mt-5 space-y-6",children:[E,(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(d.$,{onClick:s,variant:"secondary",children:(0,a.jsx)(p.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,a.jsx)(d.$,{onClick:()=>{_(!0),b.track({event_key:"wiggle.gdrive.connection.initiated",organization_id:null==y?void 0:y.uuid,error_type:x,caller_identifier:v}),k&&N?M({uuid:N,url:"https://api.anthropic.com/mcp/gdrive/sse"}):S()},loading:w,disabled:w,children:z})]})]})})}},82508:(e,t,s)=>{s.d(t,{w:()=>o,y:()=>d});var a=s(1613),n=s(71462),i=s(7620);function l(e,t){let s=new Map;return t.forEach(e=>{var t;let a=null!=(t=s.get(e.file_name))?t:[];a.push(e),s.set(e.file_name,a)}),s.get(e)}function r(e,t){let s=l(e,t);if(!s||0===s.length)return null;let a=s.filter(e=>e.file_kind===n.M.Blob);return 0===a.length?null:a[a.length-1]}function o(){let e=function(){let e=(0,a.mn)();return(0,i.useCallback)(async(t,s,a,n,i)=>{let l=r(t,s);if(!l&&n){let s=await e("/api/organizations/".concat(a,"/projects/").concat(n,"/docs")),i=(await s.json()).find(e=>e.file_name===t);if(i)return new TextEncoder().encode(i.content);let o=await e("/api/organizations/".concat(a,"/projects/").concat(n,"/files"));l=r(t,await o.json())}if(!l)return null;try{let e=i?"/api/organizations/".concat(a,"/shared_artifact/").concat(i,"/files/").concat(l.file_uuid,"/contents"):"/api/organizations/".concat(a,"/files/").concat(l.file_uuid,"/contents"),t=await fetch(e);if(!t.ok)return null;let s=await t.arrayBuffer();if(s.byteLength>0x80000000-1)return null;return new Uint8Array(s)}catch(e){return null}},[e])}();return(0,i.useCallback)(async(t,s,a,n,i,r)=>{if(!n)return null;let o=function(e,t){let s=l(e,t);if(!s||0===s.length)return null;let a=s[s.length-1];if(a){let e=a.extracted_content;return new TextEncoder().encode(e)}return null}(t,s);return o||await e(t,a,n,i,r)},[e])}function d(e,t,s,a,n){let l=o();return(0,i.useCallback)(async i=>l(i,e,t,s,a,n),[e,t,s,a,l,n])}},84656:(e,t,s)=>{s.d(t,{W:()=>n});var a=s(7620);function n(e,t,s){let n=(0,a.useRef)(void 0),i=(0,a.useCallback)(e,t),l=(0,a.useCallback)(()=>{n.current&&window.clearTimeout(n.current),n.current=window.setTimeout(i,s)},[i,s]);return(0,a.useEffect)(()=>(l(),()=>{n.current&&window.clearTimeout(n.current)}),[...t,i,s]),l}},85239:(e,t,s)=>{s.d(t,{N:()=>p,z:()=>f});var a=s(74813),n=s(1613),i=s(64328),l=s(35984),r=s(16178),o=s(7620),d=s(12142),c=s(22167),u=s(82342),m=s(78458);function p(e){let{conversationUuid:t,source:s}=e,{activeOrganization:p}=(0,i.YL)(),{addError:f}=(0,l.Y)(),h=(0,a.st)(),[g,x]=(0,o.useState)(!1),[C,v]=(0,o.useState)(u.K.NOT_CONNECTED),j=(0,c.kO)(),b=(0,d.Q)({queryString:"gdrive_export_success=export-direct"}),y=null==p?void 0:p.uuid,w=(0,n.L2)("/api/organizations/".concat(y,"/conversations/").concat(t,"/wiggle/export-to-google-drive"),"POST",{enabled:!!y&&!!t,meta:{noToast:!0}});return{handleOpenInGoogleDrive:(0,o.useCallback)(async e=>{if(!y||!t)return;let a=e.replace("computer://",""),n=(0,m.k)({filePath:e,isShared:!1,conversationUuid:t,source:s});h.track({event_key:"wiggle.file.gdrive_export.attempted",...n});try{let e=await w.mutateAsync({file_path:a});e.drive_url&&(window.open(e.drive_url,"_blank"),h.track({event_key:"wiggle.file.gdrive_export.success",...n}))}catch(d){let e,t,s,a;if(d instanceof r.LG){var i,l;if(!(e=null!=(l=d.errorCode)?l:void 0)&&(null==(i=d.extra)?void 0:i.details)){let t=d.extra.details;e=t.error_code,s=t.server_id,a=t.server_url}t=d.message}else t="Export failed. Please try again.";let o=(e=>{switch(e){case"google_drive_not_connected":return u.K.NOT_CONNECTED;case"google_drive_insufficient_scopes":return u.K.MISSING_SCOPE;default:return u.K.UNKNOWN}})(e);if(h.track({event_key:"wiggle.file.gdrive_export.failed",error_code:e,error_type:o,error_message:t,...n}),j&&(o===u.K.NOT_CONNECTED||o===u.K.MISSING_SCOPE)&&s)return void b({uuid:s,url:a});if(o===u.K.NOT_CONNECTED||o===u.K.MISSING_SCOPE){v(o),x(!0);return}f(t,{error:d,errorContext:{tags:{source:"google_drive_export"}}})}},[y,t,s,h,w,f,j,b]),showConnectionModal:g,setShowConnectionModal:x,connectionError:C,isExporting:w.isPending}}function f(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=/\.docx$/i.test(e),a=/\.xlsx$/i.test(e),n=/\.pptx$/i.test(e);if(t){let t=/\.md$/i.test(e),i=/\.csv$/i.test(e),l=/\.tsv$/i.test(e),r=/\.gif$/i.test(e),o=/\.(jpg|jpeg)$/i.test(e),d=/\.pdf$/i.test(e),c=/\.png$/i.test(e),u=/\.txt$/i.test(e),m=/\.json$/i.test(e);return s||a||n||t||i||l||r||o||d||c||u||m}return s||a||n}},87017:(e,t,s)=>{s.d(t,{u:()=>l});var a=s(93734),n=s(3444),i=s(48060);function l(e){let t=e.trim();return(0,a.yt)(t,{extensions:[(0,n.x)()],htmlExtensions:[(0,i.k)()]})}},88123:(e,t,s)=>{s.d(t,{g:()=>sa,v:()=>ss});var a=s(2348),n=s(54568),i=s(19736),l=s(6542),r=s(65018),o=s(40925),d=s(79412),c=s(45607),u=s(37380),m=s(96614),p=s(86545),f=s(55146),h=s(34003),g=s(64328),x=s(98944),C=s(60687),v=s(59922),j=s(41284),b=s(67453),y=s(7620),w=s(68067),_=s(95617),k=s(28044),N=s(11583),M=s(72902),S=s(39109),A=s(45312),E=s(16689),z=s(19664),T=s.n(z),L=s(27541),R=s(59666),I=s(10369),U=s(24407),O=s(24443),F=s(60516),D=s(13644),P=s(45538),B=s(72581),G=s(47831),W=s(22624),V=s(26924),q=s(72098);let H=()=>(0,n.jsxs)("div",{className:"animate-pulse flex flex-col gap-8 fade-out-bottom h-[calc(100vh-12.5rem)]",children:[(0,n.jsx)("div",{className:"group relative inline-flex gap-2 bg-bg-300 rounded-xl pl-2.5 py-2.5 break-words text-text-100 transition-all max-w-[75ch] flex-col",children:(0,n.jsx)("div",{className:(0,M.A)("rounded-full h-7 w-7 bg-text-200 opacity-40")})}),(0,n.jsxs)("div",{className:"flex flex-col gap-2 px-2",children:[(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-11/12"}),(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-10/12"}),(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-11/12"}),(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-4/12"})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2 px-2",children:[(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-10/12"}),(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-9/12"}),(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-11/12"}),(0,n.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-4/12"})]})]}),Y=e=>{let{notificationPermission:t,enableNotifications:s,isFeatureEnabled:a=!0,visible:i=!0}=e,[l,r]=(0,y.useState)(!1);return(0,y.useEffect)(()=>{i?requestAnimationFrame(()=>{r(!0)}):r(!1)},[i]),(0,n.jsx)("div",{className:(0,M.A)("inline-block select-none text-text-300 transition-opacity relative -top-4",l?"opacity-100 delay-300 duration-700":"opacity-0 duration-0"),children:"granted"===t&&a?(0,n.jsx)(R.A,{defaultMessage:"Claude is working on your request. Check back later or start a new conversation.",id:"oiMwdVTmaV"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{children:(0,n.jsx)(R.A,{defaultMessage:"Get notified when Claude finishes longer tasks like this one.",id:"mBieR/vcEO"})}),(0,n.jsx)("button",{onClick:s,className:"text-text-300 hover:text-text-200 underline",children:(0,n.jsx)(R.A,{defaultMessage:"Turn on notifications",id:"IXF/1bytWQ"})})]})})};Y.displayName="ChatNotification";let J=(0,y.memo)(Y);var K=s(37080),X=s(91786),Z=s(29493),Q=s(24423),$=s(26761),ee=s(90458),et=s(82508),es=s(15393),ea=s(78540),en=s(4869),ei=s(85028),el=s(32027),er=s(8564),eo=s(58841),ed=s(71700),ec=s(23812),eu=s(48252),em=s(64371),ep=s(16256),ef=s(35262),eh=s(37467),eg=s(98304),ex=s(19820),eC=s(785),ev=s(23132),ej=s(61295),eb=s(99969),ey=s.n(eb),ew=s(99411),e_=s(9317);let ek=e=>{let{onClose:t,onBack:s,onDebug:a,title:i,isHidden:l,className:r}=e;return(0,n.jsxs)("div",{className:"shrink-0 flex items-center justify-between gap-4 w-full min-w-0 px-5 h-[3.25rem]",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1 min-w-0",children:[!!s&&(0,n.jsx)(ec.$,{variant:"ghost",size:"icon_sm",onClick:s,className:"-ml-1",disabled:l,children:(0,n.jsx)(ef.Z,{size:16})}),(0,n.jsx)("h2",{className:(0,M.A)("text-text-200 truncate text-sm min-w-0 text-ellipsis break-words text-nowrap",r),children:i}),!!a&&(0,n.jsx)(ec.$,{variant:"ghost",size:"icon_sm",onClick:a,disabled:l,children:(0,n.jsx)(eh.z,{size:16})})]}),(0,n.jsx)(ec.$,{variant:"ghost",size:"icon_sm",onClick:t,className:"-mr-1",disabled:l,children:(0,n.jsx)(eg.X,{size:16})})]})};function eN(e){let{compassStatus:t,onOpenSources:s}=e;if(!t.total_sources)return null;let a=(e=>{let t=new Map,s=new Map;for(let a of e)for(let e of a.annotated_snippets)for(let a of e.tool_calls)if("web_search"===a.tool_name||"web_fetch"===a.tool_name){let e=[];if("web_search"===a.tool_name){if(!a.output||"rich_content"!==a.output.type||!a.output.content)continue;e=a.output.content.map(e=>{let{url:t}=e;return t}).filter(Boolean)}if("web_fetch"===a.tool_name){if(!a.output||"rich_link"!==a.output.type||!a.output.link.url)continue;e=[a.output.link.url]}for(let t of e)if("string"==typeof t)try{let e=new URL(t),a="https://".concat(e.hostname),i=e.hostname.replace(/^www\./,""),l=s.get(i);s.set(i,{count:((null==l?void 0:l.count)||0)+1,icon:(null==l?void 0:l.icon)||(0,n.jsx)(ed.d,{url:a,size:14})})}catch(e){}}else if(a.output){let e=a.integration_name||a.tool_name,s="rich_content"===a.output.type?a.output.content.length:1,i=t.get(e);t.set(e,{count:((null==i?void 0:i.count)||0)+s,icon:(null==i?void 0:i.icon)||(0,n.jsx)(e_.r,{canShowLetterIcon:!0,size:14,iconUrl:a.server_icon_url||void 0,integrationName:a.integration_name||void 0,toolName:a.tool_name})})}let a=Array.from(t.entries()).sort((e,t)=>t[1].count-e[1].count).slice(0,4),i=Array.from(s.entries()).sort((e,t)=>t[1].count-e[1].count).slice(0,4);return a.concat(i).slice(0,4-a.length)})(t.agents),i=a.length>0?a[0][1].count:0,l=t.total_sources-a.reduce((e,t)=>t[1].count+e,0);return 0===a.length?null:(0,n.jsx)("button",{className:"transition-all w-full flex flex-col gap-3 px-4 py-3.5 border-0.5 border-border-300 rounded-xl hover:border-border-100  max-w-[456px]",onClick:s,children:(0,n.jsxs)("div",{className:"flex flex-col gap-2.5 my-1 w-full",children:[a.map((e,t)=>{let[s,{count:a,icon:l}]=e;return(0,n.jsxs)("div",{className:"flex items-center text-xs",children:[(0,n.jsx)("div",{className:"h-4 w-4 flex items-center justify-center mr-2",children:l}),(0,n.jsx)("p",{className:"text-left font-medium w-32 truncate text-text-100 pr-2",title:s,children:s}),(0,n.jsx)("p",{className:"w-24 text-right text-xs text-text-300 pr-2",children:(0,n.jsx)(R.A,{id:"WrpI57Uej/",defaultMessage:"{count, plural, one {# source} other {# sources}}",values:{count:a}})}),(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(ej.P.div,{className:"h-2 rounded-full bg-bg-400",initial:{width:0},animate:{width:"".concat(a/i*100,"%")},transition:{delay:.1*t,duration:.5}})})]},s)}),l>0&&(0,n.jsxs)("div",{className:"flex items-center text-xs text-text-300",children:[(0,n.jsx)(ex.H,{size:16,className:"text-text-300 mr-2"}),(0,n.jsx)("p",{children:(0,n.jsx)(R.A,{id:"QX3cxMJ9Tc",defaultMessage:"{totalSources, plural, one {# other source} other {# other sources}}",values:{totalSources:l}})})]})]})})}let eM=e=>{let{title:t,complete:s,className:a}=e;return(0,n.jsx)(ej.P.h3,{className:(0,M.A)("text-base text-text-100 font-claude-response",a),initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:s?t:(0,n.jsx)(eu.N,{children:t})},t)};function eS(e){let{title:t,description:s,numSources:a,onClick:i,complete:l}=e;return(0,n.jsxs)(ej.P.button,{variants:{initial:{opacity:0},animate:{opacity:1}},className:"text-left flex flex-col gap-1.5 transition-all duration-500 group/snippet cursor-pointer",onClick:i,children:[(0,n.jsx)(eM,{title:null!=s?s:t,complete:l}),(0,n.jsx)("div",{className:"transition-all flex flex-row items-center gap-1 text-xs text-text-500 group-hover/snippet:text-text-200",children:0===a?(0,n.jsx)(R.A,{id:"NmCRHK7Fm4",defaultMessage:"No sources yet"}):(0,n.jsx)(R.A,{id:"8NMeuJNj8z",defaultMessage:"{totalSources, plural, one {# source} other {# sources}}",values:{totalSources:a}})})]})}function eA(e){let{status:t,allSnippets:s,onOpenSources:a}=e,[i,l]=(0,y.useState)([]);return(0,y.useEffect)(()=>{!(t.agents.length<1)&&(i.length>=3||l((0,K.mk)({agents:t.agents,n:3})))},[null==t?void 0:t.agents,i.length,l]),(0,n.jsxs)("div",{className:"flex flex-col pt-4 pb-6 gap-4 w-full h-full text-sm text-text-200",children:[(0,n.jsx)(eN,{compassStatus:t,onOpenSources:()=>a(!0)}),s&&s.length>0&&(0,n.jsx)("div",{className:"flex flex-col gap-3",children:(0,n.jsx)(ej.P.div,{variants:{initial:{},animate:{transition:{staggerChildren:.08,delayChildren:.05}}},initial:"initial",animate:"animate",className:"flex flex-col gap-4 w-full",children:s.map((e,t)=>(0,n.jsx)(eS,{...e,onClick:()=>a(!0,e.globalAgentIndex)},t))})})]})}function eE(e){let{data:t,onClose:s}=e,[a,i]=(0,y.useState)(!1),[l,r]=(0,y.useState)({sourcesOpen:!1}),{conversationUuid:o,organizationUuid:d,isShared:c,taskId:u}=t,{compassStatus:m}=(0,K.CH)({organizationUuid:d,conversationUuid:o,taskId:u,isShared:c});if(!m)return null;let p=(e,t)=>{r({sourcesOpen:e,index:t})},f=void 0,h=l.sourcesOpen||a;return(0,n.jsxs)("div",{className:"relative h-full w-full bg-bg-000",children:[(0,n.jsx)(ej.P.div,{className:"w-full h-full",animate:h?"minimized":"full",variants:{minimized:{scale:.95},full:{scale:1}},children:(0,n.jsx)(ez,{compassStatus:m,onClose:s,onDebug:f,handleOpenSources:p})}),(0,n.jsx)("div",{className:(0,M.A)("absolute top-0 left-0 right-0 bottom-0 h-full w-full pointer-events-none bg-always-black/[5%]",h?"opacity-100":"opacity-0")}),(0,n.jsx)(ej.P.div,{animate:h?"visible":"hidden",variants:{visible:{opacity:1,translateX:0},hidden:{opacity:0,translateX:"100%"}},transition:{ease:ep.A.snappyOut},className:(0,M.A)("absolute top-0 left-0 right-0 bottom-0"),children:(0,n.jsx)(eR,{isHidden:!h,compassStatus:m,onBack:a?()=>i(!1):()=>p(!1),onClose:s,onDebug:f,isDebug:a,agentIndex:l.index})})]})}function ez(e){let{compassStatus:t,onClose:s,onDebug:a,handleOpenSources:i}=e,l=(0,I.A)(),r=(0,K.OQ)(t),o=t.status,d=(0,K.Nw)(t),c=t.total_sources||0,u=t.agents.slice(1).flatMap((e,t)=>e.annotated_snippets.flat().filter(e=>e.tool_calls.length>0).map(s=>({...s,total_sources:e.total_sources,description:e.description||e.name,complete:!!(s.complete||e.completed_at),globalAgentIndex:t+1,numSources:e.total_sources}))),m=_.P5.indexOf(o),p=[{title:o===_.zu.Starting||o===_.zu.Planning?l.formatMessage({defaultMessage:"Creating my research plan...",id:"4eRg5buC9J"}):l.formatMessage({defaultMessage:"Research plan created",id:"MIzjwRDSc0"}),children:d?(0,n.jsx)(K.GT,{thought:d,className:"pt-4 pb-6"}):void 0,shown:!0,expandable:!!d},{title:o===_.zu.InitiatingAgents||o===_.zu.Searching?0===c?l.formatMessage({defaultMessage:"Searching for sources...",id:"+4r/aaeR9v"}):l.formatMessage({defaultMessage:"Gathering {count, plural, one {# source} other {# sources}} and counting...",id:"kQHn/iXQmy"},{count:c}):l.formatMessage({defaultMessage:"Gathered {count, plural, one {# source} other {# sources}}",id:"DU/dbPu5mV"},{count:c}),titleIcons:(0,n.jsx)(K.mq,{hrefs:(0,K.mk)({agents:t.agents,n:3})}),children:(0,n.jsx)(eA,{allSnippets:u,status:t,onOpenSources:i}),shown:m>=2||t.agents.length>1,expandable:u.length>0},{title:o===_.zu.Completed?l.formatMessage({defaultMessage:"Boom! Research report is ready",id:"8CCPGtuLnt"}):l.formatMessage({defaultMessage:"Writing and citing report...",id:"2b/CKxnAiJ"}),shown:m>=4,expandable:!1}],f=p.filter(e=>e.expandable).length,h=p.findLastIndex(e=>!!e.expandable),g=(0,y.useRef)(h),[x,C]=(0,y.useState)(h),[v,j]=(0,y.useState)(!0),b=(0,y.useCallback)((e,t,s)=>{j(s),t?C(e):C(+(0===e))},[j,C]);(0,y.useEffect)(()=>{h!==g.current&&b(h,!0,!1)},[b,h]);let w=[_.zu.Cancelled,_.zu.Failed,_.zu.TimedOut].includes(t.status),k=p.filter(e=>e.shown).length;return(0,n.jsxs)("div",{className:"flex flex-col h-full bg-bg-000 overflow-hidden",children:[(0,n.jsx)(ek,{onClose:s,onDebug:a,title:r,className:"font-medium"}),(0,n.jsxs)("div",{className:"flex flex-col overflow-y-auto px-5 pb-5 pt-1 -mt-1",children:[p.map((e,s)=>{let{expandable:a,shown:i,title:l,titleIcons:r,children:o}=e,d=w||s<k-1||t.status===_.zu.Completed;return(0,n.jsx)(eT,{title:l,titleIcons:r,noShimmer:d||w,complete:d,isExpanded:a&&x===s,snappyTransition:v,showLine:s<k-1||w||x===s,handleExpand:e=>b(s,e,!0),expandable:a,collapsible:f>1,shown:i,children:o},s)}),w&&(0,n.jsx)(eT,{title:t.status===_.zu.Cancelled?l.formatMessage({defaultMessage:"Interrupted",id:"rJQDmlVOoX"}):l.formatMessage({defaultMessage:"Something went wrong",id:"JqiqNj0Ooi"}),snappyTransition:!0,noShimmer:!0,isError:!0,handleExpand:ey(),shown:w})]})]})}function eT(e){let{title:t,titleIcons:s,complete:a,expandable:i,collapsible:l,shown:r,isExpanded:o,handleExpand:d,snappyTransition:c,noShimmer:u,isError:m,showLine:p,children:f}=e;return!!r&&(0,n.jsxs)("div",{className:"flex flex-row gap-3 min-h-[2.125rem] shrink-0",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center mt-[5px]",children:[(0,n.jsx)("div",{className:(0,M.A)("transition-all w-2.5 h-2.5 rounded-full shrink-0",m?"bg-danger-200":a?"bg-text-500":"bg-accent-main-200")}),p&&(0,n.jsx)("div",{className:(0,M.A)("transition-all h-full -mb-1 w-[1px]",a?"bg-border-300":"bg-gradient-to-b from-accent-main-200/50 to-accent-main-200/0")})]}),(0,n.jsxs)("div",{className:"w-full flex flex-col",children:[(0,n.jsx)("button",{className:"inline-flex items-center gap-1",onClick:()=>d(!o),disabled:!i||o&&!l,children:(0,n.jsxs)("h4",{className:(0,M.A)("flex flex-row items-center gap-2 transition-colors text-start text-text-100 hover:text-text-000 text-sm h-5 user-select-none",m&&"!text-danger-200"),children:[u?t:(0,n.jsx)(eu.N,{children:t}),(0,n.jsx)(S.N,{children:!!s&&!o&&(0,n.jsx)(ej.P.div,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},children:s})}),!!i&&l&&(0,n.jsx)(eC.a,{className:(0,M.A)("bottom-[0.5px] transform transition-transform duration-400 ease-snappy-out text-text-300",o?"rotate-0":"-rotate-90"),size:12})]})}),(0,n.jsx)(ew.NG,{isExpanded:!!i&&!!o,isScrollable:!1,snappyTransition:c,className:"!max-h-none w-full",setIsExpanded:d,children:f})]})]})}function eL(e){var t,s;let{toolCall:a,isHidden:i}=e;if("web_fetch"===a.tool_name&&(null==(t=a.output)?void 0:t.type)==="rich_link"&&a.output.link.url){let{url:e,icon_url:t,title:s,subtitles:l}=a.output.link;return(0,n.jsx)(ew.aX,{isDisabled:i,isStreaming:!1,icon:(0,n.jsx)(ed.d,{fadeInOnLoad:!0,url:t,size:16}),text:(0,n.jsx)(R.A,{defaultMessage:"Fetched <b>{title}</b>",id:"BWNvvK6PhH",values:{title:s,b:e=>(0,n.jsx)("span",{className:"text-text-400",children:e})}}),handleClick:()=>{window.open(e,"_blank")},secondaryText:null==l?void 0:l[0],secondaryIcon:(0,n.jsx)(ev.B,{size:16,className:"text-text-300"}),isFirstBlockOfMessage:!1,isLastBlockOfMessage:!1,wrapperClassName:"!my-0"})}return a.output?(0,n.jsx)(e_.K,{integrationName:a.integration_name||void 0,integrationIcon:a.server_icon_url||void 0,message:a.message,isExpandingDisabled:i,result:a.output,isStreaming:!1,isError:a.is_error,isFirstBlockOfMessage:!1,isLastBlockOfMessage:!1,wrapperClassName:"!my-0",contentClassName:(null==(s=a.output)?void 0:s.type)==="json_block"?"":"!max-h-none",defaultExpanded:!0}):null}function eR(e){var t;let{isHidden:s,compassStatus:a,onClose:i,onDebug:l,onBack:r,isDebug:o,agentIndex:d}=e,c=(0,y.useRef)(null),u=(0,I.A)(),m=d?!!(null==(t=a.agents[d])?void 0:t.completed_at):a.status===_.zu.Completed,p=void 0===d?null:a.agents[d].description||a.agents[d].name,f=function(e,t){let s=[];for(let a of t?[e.agents[t]]:e.agents)for(let e of a.annotated_snippets)for(let t of e.tool_calls)t.output&&s.push({toolCall:t,timestamp:e.complete&&a.completed_at||a.started_at});return s.sort((e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime()),s.map(e=>{let{toolCall:t}=e;return t})}(a,d),h=void 0===d?a.total_sources:a.agents[d].total_sources;return(0,n.jsxs)("div",{className:(0,M.A)("text-sm bg-bg-000 h-full overflow-hidden flex flex-col",s&&"pointer-events-none user-select-none"),children:[(0,n.jsx)(ek,{onDebug:o?void 0:l,isHidden:s,title:o?"Ant only debug panel":u.formatMessage({defaultMessage:"{totalSources, plural, one {# source} other {# sources}} {status}",id:"8cAP0ZJRie"},{totalSources:h,status:m?"":(0,n.jsx)(R.A,{id:"um9oac7M9y",defaultMessage:"and counting..."})}),onClose:i,onBack:()=>{setTimeout(()=>{c.current&&(c.current.scrollTop=0)},500),r()}}),(0,n.jsxs)("div",{ref:c,className:"relative flex-1 overflow-auto px-5 pt-1 pb-5",children:[!!p&&(0,n.jsx)(eM,{title:p,complete:m,className:"pt-1 pb-5"}),f.length>0?(0,n.jsx)("div",{className:"flex flex-col gap-4",children:f.map((e,t)=>(0,n.jsx)(eL,{toolCall:e,isHidden:s},t))}):(0,n.jsx)("div",{className:"text-text-500 text-center px-8 py-16",children:(0,n.jsx)(R.A,{id:"yWSiuEkfbY",defaultMessage:"No sources found"})})]})]})}var eI=s(26786),eU=s(71462),eO=s(34385);let eF=e=>{let{docUuid:t,projectUuid:s,goBack:a,onClose:i}=e,{data:l}=(0,eO.Rn)({projectUuid:s,docUuid:t});if(!l)return null;let r={file_name:l.file_name,file_size:l.content.length,file_type:"text/plain",extracted_content:l.content,origin:eU.R.UserUpload};return(0,n.jsx)(eI.f,{attachment:r,goBack:a,onClose:i})};var eD=s(74801);let eP=(0,y.memo)(function(e){var t;let{conversationUuid:s,onClose:a,isStreaming:i,projectUuid:l,sendMessage:r,isOpen:o,isTemporary:d=!1}=e,c=(0,Q.so)(s),{activeOrganization:u}=(0,g.YL)(),{chatResourceState:{selectedItem:m,activeMessageUuid:p,attachments:f,files:h,streamingFiles:x},dispatchChatResource:C}=(0,eo.i)(),v=null==u?void 0:u.uuid,j=(0,Q.HF)(),b=null==(t=(0,el.f)({conversationUuid:s,source:"w"}).data)?void 0:t.artifact_versions,w=(0,y.useMemo)(()=>{if(!m||"artifact"!==m.type||!b)return;let e=b.find(e=>e.uuid===(null==m?void 0:m.versionUuid));if(e)return{id:e.artifact_uuid,title:e.title,language:e.code_language,type:e.artifact_type,version_uuid:e.uuid,versions:[{command:"create",uuid:e.uuid,resultState:e.result_state,content:e.result_state,message:e.message_uuid,created_at:e.created_at,source:e.source,isClosed:!0}]}},[b,m]),_=(null==m?void 0:m.type)==="artifact"&&m.versionUuid?{uuid:m.versionUuid,type:"artifact_version"}:void 0,k=(0,es.f)({artifactContext:_}),N=(0,en.useQueryClient)(),M=(0,ea.j)({artifactContext:_,chatConversationUuid:s,onStorageChange:()=>{N.invalidateQueries({queryKey:[ei.r$]})}}),S=(0,et.y)(f,h,v,l),A=(0,y.useMemo)(()=>({claudeComplete:k,getFile:S,storage:M}),[k,S,M]),E=(0,y.useCallback)(e=>{(null==m?void 0:m.type)==="artifact"&&C({type:"SELECT_ARTIFACT",id:m.id,versionUuid:e})},[m,C]),z=(0,y.useCallback)(e=>C({type:"SELECT_DOC",id:e}),[C]),T=(0,y.useCallback)(()=>C({type:"CLEAR_SELECTED"}),[C]),L=(null==m?void 0:m.type)==="artifact"&&j[m.id]?j[m.id]:w;return(0,n.jsx)(n.Fragment,{children:(null==m?void 0:m.type)==="artifact"&&L?(0,n.jsx)("div",{className:"relative h-full",children:(0,n.jsx)(er.CV,{isStreaming:i,artifact:L,selectedArtifactMessageUuid:p,selectedArtifactVersionUuid:m.versionUuid,setSelectedArtifactVersionUuid:E,onClose:a,projectUuid:l,selectDoc:z,sendMessage:r,richSandboxCapabilities:A,isOpen:o,isTemporary:d})}):(null==m?void 0:m.type)!=="artifact"||j[m.id]?(null==m?void 0:m.type)==="attachment"?(0,n.jsx)(eI.f,{goBack:()=>C({type:"CLEAR_SELECTED"}),attachment:m.attachment,onClose:a}):(null==m?void 0:m.type)==="compass"?(0,n.jsx)(eE,{data:m.data,onClose:a,goBack:T}):l&&(null==m?void 0:m.type)==="doc"?(0,n.jsx)(eF,{docUuid:m.id,projectUuid:l,onClose:a,goBack:()=>C({type:"CLEAR_SELECTED"})}):(null==m?void 0:m.type)==="file"?(0,n.jsx)(eD.yL,{file:{path:m.path,name:m.path.split("/").pop()||m.path},showBackButton:m.path.startsWith("/mnt/user-data/outputs/"),goBack:()=>C({type:"CLEAR_SELECTED"}),onClose:a,conversationUuid:s,projectUuid:l,isTemporary:d,isShared:!1,isStreaming:i,streamingFile:x.get(m.path),artifactVersions:null!=b?b:[],cacheBuster:c},m.path):null:(0,n.jsx)(er.CV,{isStreaming:i,artifact:void 0,selectedArtifactMessageUuid:p,selectedArtifactVersionUuid:(null==m?void 0:m.type)==="artifact"?m.versionUuid:void 0,setSelectedArtifactVersionUuid:E,onClose:a,projectUuid:l,selectDoc:z,sendMessage:r,richSandboxCapabilities:A,isOpen:o,isTemporary:d})})});var eB=s(47479),eG=s(74813),eW=s(44995),eV=s(89626),eq=s(87483),eH=s(31779),eY=s(20680),eJ=s(85524),eK=s(19977),eX=s(41135),eZ=s(96442),eQ=s(19150),e$=s(48321),e1=s(18849),e0=s(79901),e2=s(53270),e3=s(46868),e4=s(34793),e8=s(61987),e9=s(75103);let e5=e=>{let{projectUuid:t}=e,{data:s}=(0,P.fo)(t);return s?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("h3",{className:"text-text-300 mb-2 mt-4 text-sm font-medium",children:(0,n.jsx)(R.A,{defaultMessage:"Project content",id:"/IJPT7JRFn"})}),(0,n.jsxs)("div",{className:"border-border-400 rounded-lg border px-3 py-4",children:[(0,n.jsxs)(T(),{href:"/project/".concat(t),className:"hover:text-text-000 flex items-center gap-1.5 hover:underline",children:[(0,n.jsx)(e4.D,{size:16,className:"text-text-300 shrink-0"}),(0,n.jsx)("div",{className:"font-claude-response text-text-200 leading-tight",children:s.name})]}),(0,n.jsx)("div",{children:(0,n.jsx)(e9.t,{project:s,className:"text-text-400 text-xs"})}),(0,n.jsx)("ul",{className:"mt-2 flex flex-col",children:(0,n.jsx)(e8.b,{isEditable:!1,project:s,maxItems:3,onViewAll:()=>{window.location.href="/project/".concat(t)}})})]})]})}):null};var e7=s(10304),e6=s(72352);async function te(e,t,s){try{let a=new URL("/api/organizations/".concat(e,"/conversations/").concat(t,"/wiggle/list-files"),window.location.origin);void 0!==s&&a.searchParams.append("prefix",s);let n=await fetch(a.toString(),{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok)return[];let i=await n.json();if(i.files_metadata)return i.files_metadata;if(i.files)return i.files.map(e=>({path:e,size:0,content_type:"application/octet-stream"}));return[]}catch(e){return[]}}let tt=(0,eZ.default)(()=>Promise.all([s.e(9883),s.e(3510),s.e(8059),s.e(2103)]).then(s.bind(s,44484)).then(e=>e.ShareModal),{loadableGenerated:{webpack:()=>[44484]},ssr:!1}),ts=(0,eZ.default)(()=>s.e(5457).then(s.bind(s,55457)).then(e=>e.WiggleSharingModals),{loadableGenerated:{webpack:()=>[55457]},ssr:!1});function ta(e){let{conversationUuid:t,projectUuid:s,isStreaming:a,todos:i,isTemporary:l=!1,messagesLength:r=0}=e,o=(0,h.u9)(),{refetchAll:d,selectWiggleFile:c,wiggleFiles:u,wiggleSharedArtifacts:m}=function(e){let{conversationUuid:t,messagesLength:s=0,isStreaming:a}=e,n=(0,Q.so)(t),i=(0,h.Yl)(),{isDrawerExpanded:l}=(0,e1.x)(),{chatResourceState:{selectedItem:r},dispatchChatResource:o}=(0,eo.i)(),d=(0,el.f)({conversationUuid:t,source:"w"}),c=(0,y.useMemo)(()=>{var e,t;return null!=(t=null==(e=d.data)?void 0:e.artifact_versions)?t:[]},[d.data]),u=i&&l&&!r,m=function(e,t,s){let[a,n]=(0,y.useState)([]),[i,l]=(0,y.useState)(!1),[r,o]=(0,y.useState)(null),{activeOrganization:d}=(0,g.YL)(),c=(0,h.u9)(),u=(0,y.useCallback)(async()=>{if(c&&t&&(null==d?void 0:d.uuid)){l(!0),o(null);try{let e=(await te(d.uuid,t,"")).map(e=>{let t=e.path.split("/").pop()||e.path;return{path:e.path,name:t,content_type:e.content_type||"application/octet-stream"}});n(e)}catch(e){o("Failed to load files")}finally{l(!1)}}},[c,t,null==d?void 0:d.uuid,""]);return(0,y.useEffect)(()=>{c&&s&&u()},[c,s,u]),{files:a,isLoading:i,error:r,refetch:u}}("",t,u),p=(0,y.useMemo)(()=>{var e;let t=[],s=[];return null==(e=m.files)||e.forEach(e=>{"/mnt/user-data/README.md"!==e.path&&(e.path.startsWith("/mnt/user-data/uploads/")||(e.path.startsWith("/mnt/user-data/outputs/")?t.push(e):s.push(e)))}),{output:t,scratchpad:s}},[m.files]),f=p.output.length+p.scratchpad.length,x=(0,y.useCallback)((e,t)=>{o({type:"SELECT_FILE",path:e.replace("computer://",""),toolType:"create_file",messageId:t})},[o]),C=(0,y.useCallback)(async()=>{i&&await Promise.all([m.refetch(),d.refetch()])},[i,m,d]),v=(0,y.useCallback)(async()=>{i&&await m.refetch()},[i,m]),j=(0,e6.Y)(C,{leading:!1,delay:eD.XO});(0,y.useEffect)(()=>{r||j()},[l,n]);let b=(0,y.useRef)(!1);return(0,y.useEffect)(()=>{if(s){if(b.current&&!a){let e=Q.oz.getState(),s=e.pathUuidsByConversation[t]||[],a=s[s.length-1],n=a?e.messageByUuid[a]:void 0;if(n&&"assistant"===n.sender&&Array.isArray(n.content)&&n.content.some(e=>(null==e?void 0:e.type)==="tool_use"&&(e.input?JSON.stringify(e.input):"").includes("outputs"))){let e=setTimeout(()=>{v()},2e3);return()=>clearTimeout(e)}}b.current=a}},[a,t,v,s]),{wiggleGate:i,showWiggleControls:u,refetchAll:C,refetchWiggleRoot:v,selectWiggleFile:x,wiggleFiles:p,wiggleFilesCount:f,wiggleSharedArtifacts:c}}({conversationUuid:t,messagesLength:r,isStreaming:a}),{isDrawerExpanded:p}=(0,e1.x)(),{chatResourceState:{selectedItem:f,activeMessageUuid:x,files:C,syncSources:v},dispatchChatResource:j}=(0,eo.i)(),{activeOrganization:w}=(0,g.YL)(),_=(0,eG.st)(),[N,S]=(0,y.useState)(null),A=(0,I.A)(),E=(0,eQ._)({conversationUuid:t,isStreaming:a}),[z,T]=(0,y.useState)(!1),L=0===u.output.length&&0===m.length&&0===u.scratchpad.length&&0===C.length&&0===v.length&&!i,U=(0,k.V)();return o?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:(0,M.A)("flex flex-col relative","max-md:absolute max-md:inset-x-0 max-md:top-0",f&&"max-md:hidden",!f&&p&&"max-md:z-header",f&&p&&"md:z-0",!p&&"max-md:pointer-events-none max-md:absolute max-md:inset-0"),inert:!!f&&!!p||void 0,children:[(0,n.jsx)(tn,{wiggleFiles:u,isTemporary:l,shareState:E,todos:i}),!L&&(0,n.jsx)("div",{className:(0,M.A)("overflow-x-hidden overflow-y-auto md:h-[calc(100%-56px)]","max-md:h-full max-md:border-t max-md:border-border-300 max-md:bg-bg-100","md:transition-[width] md:duration-300 md:ease-in-out",p?"w-full md:mt-12 md:m-2 md:w-[384px] p-5 border-0.5 border-border-300 md:rounded-2xl max-md:border-0":"w-0 p-0 m-0 border-0 overflow-hidden",f&&"md:absolute",U&&p&&"md:mt-[62px]",l&&p&&"md:mt-14"),children:(0,n.jsx)("div",{className:(0,M.A)(p?"md:w-[342px]":"w-0"),children:(0,n.jsxs)("div",{className:(0,M.A)("flex flex-col gap-5 md:transition-opacity md:duration-300",p?"md:animate-[fade_0.3s_ease-in-out_0.1s_forwards]":"opacity-0 pointer-events-none"),children:[u.output.length?(0,n.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h3",{className:"font-medium text-sm",children:(0,n.jsx)(R.A,{defaultMessage:"Artifacts",id:"eW5eoWkxy3"})}),(0,n.jsx)(ec.$,{variant:"ghost",prepend:(0,n.jsx)(eY.e,{size:14}),className:(0,M.A)("text-sm font-medium opacity-0",u.output.length>1&&"opacity-100"),size:"sm",onClick:()=>{(null==w?void 0:w.uuid)&&(0,e$.y)({filepaths:u.output.map(e=>e.path),orgUuid:w.uuid,conversationUuid:t,isShared:!1,source:"chat_controls_download_all_button"},_)},children:(0,n.jsx)(R.A,{defaultMessage:"Download all",id:"V1UrPNM96z"})})]}),(0,n.jsx)("div",{className:"flex flex-col gap-2",children:u.output.map(e=>(0,n.jsx)(b.Tooltip,{align:"end",tooltipContent:e.name,side:"bottom",children:(0,n.jsx)("div",{children:(0,n.jsx)(e2._,{file:e,conversationUuid:t,onOpen:()=>c(e.path,x||""),isInSidebar:!0,isShared:!1},e.path)})},e.path))})]}):null,m.length?(0,n.jsx)(ti,{artifactVersions:m,onSelectArtifactVersion:e=>{j({type:"SELECT_ARTIFACT",id:"",versionUuid:e})},onComplete:e=>S(e)}):null,u.scratchpad.length?(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsxs)("button",{className:"flex font-medium items-center justify-between p-1 hover:bg-bg-300 rounded-md",onClick:()=>T(e=>!e),children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(R.A,{defaultMessage:"Scratchpad",id:"Qb4YubxAW2"}),(0,n.jsx)(b.Tooltip,{tooltipContent:A.formatMessage({defaultMessage:"Files used to create artifacts",id:"T2w69cOLhV"}),side:"right",children:(0,n.jsx)(eJ.m,{})})]}),(0,n.jsx)(eK.J,{className:(0,M.A)("transition",z?"rotate-90":"")})]}),(0,n.jsx)(tl,{isExpanded:z,children:(0,n.jsx)("div",{className:"flex flex-col gap-2",children:u.scratchpad.map(e=>(0,n.jsx)(ec.$,{variant:"ghost",prepend:(0,n.jsx)(e0.o,{path:e.path}),className:"!justify-start",onClick:()=>{c(e.path,x||"")},children:e.name},e.path))})})]}):null,s&&(0,n.jsx)(e5,{projectUuid:s}),(0,n.jsx)(tr,{}),i.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{className:"font-medium text-sm",children:"TODOs"}),(0,n.jsx)("ul",{className:"list-disc pl-4",children:i.map((e,t)=>(0,n.jsx)(to,{todo:e},t))})]})]})})})]}),N&&(0,n.jsx)(ts,{artifactVersion:N,onClose:()=>S(null),onUpdate:async()=>{await d(),S(null)},projectUuid:s}),E.showShareFlow&&(0,n.jsx)(tt,{...E})]}):null}function tn(e){var t;let{wiggleFiles:s,isTemporary:a,shareState:i,todos:l}=e,r=(0,I.A)(),o=(0,k.V)(),{isDrawerExpanded:d,setIsDrawerExpanded:c}=(0,e1.x)(),{chatResourceState:{selectedItem:u,files:m,syncSources:p},dispatchChatResource:f}=(0,eo.i)(),h=m.length+p.length,g=s.output.length+s.scratchpad.length+h+l.length,x=(0,y.useMemo)(()=>d?r.formatMessage({defaultMessage:"Close",id:"rbrahOGMC3"}):r.formatMessage({defaultMessage:"Open sidebar",id:"+G35mRWa75"}),[r,d]);return(0,n.jsxs)("div",{className:(0,M.A)("md:absolute md:right-0 md:top-0 z-20","max-md:w-fit max-md:self-end max-md:pointer-events-auto","flex justify-end shrink-0 min-w-0 pr-3 items-center gap-1",o?"!h-[52px] draggable":"!h-12","transition-opacity duration-150 ease-in-out",u&&d?"md:opacity-0 md:pointer-events-none":"md:opacity-100 delay-300",o&&d&&!u&&["md:shadow-[0px_1px_0px_0px_theme(colors.border-300)]","w-full"],a&&"pt-3"),"data-testid":"wiggle-controls-actions",children:[g>0&&(0,n.jsx)(ec.$,{"aria-label":x,tooltip:x,variant:"ghost",size:"icon_sm",onClick:()=>{f({type:"CLEAR_SELECTED"}),c(!d)},"data-testid":"wiggle-controls-actions-toggle",className:d?"!bg-bg-400":void 0,children:(0,n.jsx)(eV.ZHH,{})}),i.showShareFlow&&!a&&(0,n.jsx)(ec.$,{tooltip:null!=(t=i.disabled_reason)?t:o&&(0,n.jsx)(R.A,{defaultMessage:"Share chat",id:"bXa+lJhlYV"}),variant:o?"ghost":"secondary",size:o?"icon_sm":"sm",onClick:i.openShareModal,disabled:i.disabled,prepend:o&&(0,n.jsx)(eV.SYj,{}),"data-testid":"wiggle-controls-actions-share",children:!o&&(0,n.jsx)(R.A,{defaultMessage:"Share",id:"OKhRC6eWRw"})})]})}function ti(e){let{artifactVersions:t,onSelectArtifactVersion:s,onComplete:a}=e,{publishedArtifactsBaseUrl:i}=(0,eW._r)(),{copyToClipboard:l}=(0,em.C)();return(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsx)("h3",{className:"text-text-500 text-xs",children:(0,n.jsx)(R.A,{defaultMessage:"Shared",id:"kWI6zXRaHY"})})}),(0,n.jsx)("div",{className:"flex flex-col gap-2",children:t.map(e=>{let t=e.published_artifact_uuid?"publish":"share",r=e.published_artifact_uuid?e.published_artifact_deleted_at?(0,n.jsx)(R.A,{defaultMessage:"Unpublished",id:"wbU4tD+0G+"}):(0,eH.d)(e.created_at):"shared"===e.visibility?(0,eH.d)(e.created_at):"private"===e.visibility?(0,n.jsx)(R.A,{defaultMessage:"Unshared",id:"0r/9ANkloS"}):null;return(0,n.jsxs)("div",{className:"flex-1 flex items-center",children:[(0,n.jsxs)(ec.$,{variant:"ghost",className:"flex-1 !justify-start !px-2 text-sm gap-1.5",onClick:()=>{s(e.uuid)},children:[(0,n.jsx)(eV.Xq1,{size:20,className:"shrink-0"}),(0,n.jsxs)("span",{className:"flex items-center min-w-0 overflow-hidden",children:[(0,n.jsx)("span",{className:"truncate",children:e.title}),(0,n.jsx)(eX.c,{size:16,className:"shrink-0"}),(0,n.jsx)("span",{className:"text-xs text-text-500",children:r})]})]}),(0,n.jsxs)(eq.ms,{align:"end",trigger:(0,n.jsx)(ec.$,{variant:"ghost",size:"icon_sm",children:(0,n.jsx)(eV.qwz,{size:20})}),children:[(0,n.jsx)(eq.tJ,{onClick:()=>{l((0,e7.x)(t,{artifact_uuid:e.artifact_uuid,artifact_version_uuid:e.uuid,message_uuid:e.message_uuid,published_artifact_uuid:e.published_artifact_uuid},i))},children:(0,n.jsx)(R.A,{defaultMessage:"Copy link",id:"lbr3Lq2Lnm"})}),e.published_artifact_deleted_at?null:(0,n.jsx)(eq.tJ,{onClick:()=>a(e),children:"publish"===t?(0,n.jsx)(R.A,{defaultMessage:"Unpublish",id:"VjZ6FKc+ZZ"}):"shared"===e.visibility?(0,n.jsx)(R.A,{defaultMessage:"Unshare",id:"bEq+NWNIXF"}):(0,n.jsx)(R.A,{defaultMessage:"Share",id:"OKhRC6eWRw"})})]})]},e.uuid)})})]})}function tl(e){let{children:t,isExpanded:s}=e;return(0,n.jsx)(ej.P.div,{className:"overflow-hidden shrink-0",tabIndex:-1,initial:{opacity:0,height:s?"auto":0},animate:s?"expanded":"collapsed",transition:{ease:"easeInOut",duration:.4},variants:{expanded:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},children:t})}function tr(){let{chatResourceState:{files:e,attachments:t,syncSources:s},dispatchChatResource:a}=(0,eo.i)();return e.length+s.length>0?(0,n.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsx)("h3",{className:"font-medium text-sm",children:(0,n.jsx)(R.A,{defaultMessage:"Content",id:"Jq3FDzj0/T"})})}),(0,n.jsx)("div",{className:"flex flex-col gap-2",children:(0,n.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(120px,1fr))] gap-3",children:[e.map((e,t)=>(0,n.jsx)(eB.NM,{size:"stretch",file:e},"".concat(e.file_kind,"-").concat(t))),t.map((e,t)=>(0,n.jsx)(eB.NM,{size:"stretch",file:e,handleClick:()=>a({type:"SELECT_ATTACHMENT",attachment:e})},"attachment-".concat(t))),s.map(e=>(0,n.jsx)(e3.br,{size:"stretch",syncSource:e,isEditable:!1,location:"chat"},e.uuid))]})})]}):null}function to(e){let{todo:t}=e;return"completed"===t.status?(0,n.jsxs)("li",{className:"line-through",children:[t.content," âœ…"]}):"in_progress"===t.status?(0,n.jsxs)("li",{children:[t.activeForm," \uD83D\uDD04"]}):(0,n.jsx)("li",{className:"italic",children:t.content})}var td=s(35984),tc=s(69524);function tu(e){let{conversationUuid:t}=e,s=(0,L.useRouter)(),a=(0,td.Y)(),[i,l]=(0,y.useState)(!1),r=(0,Q.xJ)(t);return(0,n.jsxs)("div",{className:" flex flex-col gap-1.5 border-0.5 border-border-300 bg-bg-100 rounded-t-xl text-text-300 font-ui z-10 p-6 ",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row items-center sm:justify-between font-medium",children:[(0,n.jsx)("div",{className:"text-lg",children:(0,n.jsx)(R.A,{defaultMessage:"Chat ended by Claude",id:"dHdfbAOK+j"})}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(ec.$,{onClick:()=>s.push("/new"),children:(0,n.jsx)(R.A,{defaultMessage:"Start new chat",id:"KcA+xo4hhh"})}),(0,n.jsx)(ec.$,{variant:"secondary",onClick:()=>l(!0),children:(0,n.jsx)(R.A,{defaultMessage:"Give feedback",id:"bCmvTYWKoj"})})]})]}),(0,n.jsx)(tc.B,{conversationUuid:t,requestedFeedbackType:_.kj.CHAT_ENDED,setRequestedFeedbackType:()=>{},message:r,isOpen:i,onClose:()=>{l(!1)},onSuccess:()=>a.addSuccess("Feedback submitted successfully"),showOptions:!1})]})}var tm=s(90370),tp=s(28483),tf=s(1613),th=s(41473),tg=s(79372),tx=s(7881),tC=s(84617),tv=s(39613);function tj(){let e=(0,a._)(["\n  w-full\n  flex\n  gap-2\n  bg-warning-orange\n  px-3\n  py-2\n  ","\n"]);return tj=function(){return e},e}let tb=["consumer_restricted_mode","consumer_second_warning","consumer_first_warning","recent_election_discussion"],ty=e=>{let{long:t}=e;return(0,n.jsx)(tC.Y,{href:tv.Z1,target:"_blank",rel:"noreferrer",children:t?(0,n.jsx)(R.A,{defaultMessage:"Learn more about the types of prompts to avoid {arrow}",id:"6DZ92vAY0j",values:{arrow:"\xbb"}}):(0,n.jsx)(R.A,{defaultMessage:"Learn more {arrow}",id:"ZeACTbo6DM",values:{arrow:"\xbb"}})})},tw={consumer_restricted_mode:[{isDismissible:!1,content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(R.A,{defaultMessage:"Because a large number of your prompts have violated our Acceptable Use Policy, we have temporarily applied enhanced safety filters to your chats.",id:"PzePYdPNe4"})," ",(0,n.jsx)(ty,{})]})}],consumer_second_warning:[{isDismissible:!0,content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(R.A,{defaultMessage:"It appears your recent prompts continue to violate our Acceptable Use Policy. If we continue seeing this pattern, weâ€™ll apply enhanced safety filters to your chats.",id:"BjivfV2YY6"})," ",(0,n.jsx)(ty,{})]})}],consumer_first_warning:[{isDismissible:!0,content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(R.A,{defaultMessage:"It looks like a few of your recent prompts donâ€™t meet our Usage Policy.",id:"Aup/Kzn3Eq"})," ",(0,n.jsx)(ty,{long:!0})]})}],recent_election_discussion:[{isDismissible:!0,content:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(R.A,{defaultMessage:"Claude may not be able to provide accurate, real time information on elections. Please visit <link>TurboVote</link> or check the Secretary of State site for your state to get reliable, up-to-date, non partisan guidance on how and where to vote in elections across the US.",id:"X4J/f3yO08",values:{link:e=>(0,n.jsx)(tC.Y,{href:"http://claude.turbovote.org",target:"_blank",rel:"noopener noreferrer",children:e})}})}),applicable_country:"US"},{isDismissible:!0,content:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(R.A,{defaultMessage:"The United Kingdomâ€™s general elections will be held on 4 July, 2024. Please visit the <link>UK Election Commissionâ€™s website</link> to get reliable, up-to-date, impartial guidance on how and where to vote in the United Kingdomâ€™s general elections.",id:"VUvO/yD1Iw",values:{link:e=>(0,n.jsx)(tC.Y,{href:"https://www.electoralcommission.org.uk/",target:"_blank",rel:"noopener noreferrer",children:e})}})}),applicable_country:"GB"},{isDismissible:!0,content:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(R.A,{defaultMessage:"The French legislative elections will be held in two rounds of voting on June 30 and July 7, 2024. Please consult <link>the French Public Administration website</link> for reliable and up-to-date guidance on where and how to vote in the legislative elections in France.",id:"ZzEMOJWfNz",values:{link:e=>(0,n.jsx)(tC.Y,{href:"https://www.service-public.fr/particuliers/vosdroits/N47",target:"_blank",rel:"noopener noreferrer",children:e})}})}),applicable_country:"FR"}]};function t_(e){let{isClaudeDot:t,content:s,isDismissible:a,handleDismiss:i}=e;return(0,n.jsx)("div",{className:t?"fixed top-8 z-10 p-4":"",children:(0,n.jsx)(tN,{$isFloating:t,children:(0,n.jsxs)("div",{className:"items-top flex justify-between",children:[(0,n.jsx)("p",{className:"text-sm font-medium",children:s}),a&&i&&(0,n.jsx)("button",{className:"h-5 cursor-pointer",onClick:()=>void i(),children:(0,n.jsx)(eg.X,{size:24})})]})})})}function tk(e){let{conversationUuid:t}=e,s=(0,eG.st)(),a=(0,eW.fZ)(),{account:i,activeOrganization:l}=(0,g.YL)(),r=null==i?void 0:i.uuid,o=null==l?void 0:l.uuid,{mutateAsync:d}=(0,D.iD)(),{data:c}=(0,D.Nj)(null==l?void 0:l.uuid),u=(0,eW._r)().ipCountry,m=(null==c?void 0:c.active_flags)&&(null==c?void 0:c.active_flags.map(e=>e.type)),{shownFlagType:p,shownFlagDetails:f}=function(e,t){let s=tb.findIndex(e=>null==t?void 0:t.includes(e)),a=tb[s];if(!a)return{shownFlagType:null,shownFlagDetails:null};let n=tw[a].filter(t=>!t.applicable_country||t.applicable_country===e);return 0===n.length?{shownFlagType:null,shownFlagDetails:null}:{shownFlagType:a,shownFlagDetails:n[0]}}(u,m);if((0,y.useEffect)(()=>{r&&o&&p&&s.track({event_key:"ts.banner.shown",flag_type:p,conversation_uuid:t,account_uuid:r,organization_uuid:o,ipCountry:null!=u?u:"unknown"})},[s,p,t,r,o,u]),!p||!f)return;let{isDismissible:h,content:x}=f,C=async()=>{if(!h)return;let e=[p];"consumer_second_warning"===p&&(null==m?void 0:m.includes("consumer_first_warning"))&&e.push("consumer_first_warning"),await Promise.all(e.map(e=>d({flagType:e})))};return(0,n.jsx)(t_,{isClaudeDot:a,content:x,isDismissible:h,handleDismiss:C})}let tN=v.J.div(tj(),e=>e.$isFloating&&"max-w-3xl\n    mx-auto\n    rounded-md\n    shadow-element\n    z-toast");var tM=s(53095),tS=s(69841),tA=s(49734),tE=s(62640),tz=s(72424),tT=s(78434),tL=s(60368);let tR=["apps_and_websites","documents_and_templates","games","productivity_tools","creative_projects","quiz_or_survey","start_from_scratch"],tI=e=>{var t;let{selectedLabel:s,disabled:a}=e,l=(0,I.A)(),{track:r}=(0,eG.st)(),o=new Map([["apps_and_websites",l.formatMessage({defaultMessage:"Apps and websites",id:"HC16Tj5QBT"})],["documents_and_templates",l.formatMessage({defaultMessage:"Documents and templates",id:"mLy6zrc3XL"})],["games",l.formatMessage({defaultMessage:"Games",id:"DUyJmj7sj9"})],["productivity_tools",l.formatMessage({defaultMessage:"Productivity tools",id:"t/RMra2cqp"})],["creative_projects",l.formatMessage({defaultMessage:"Creative projects",id:"gZSnjM59XP"})],["quiz_or_survey",l.formatMessage({defaultMessage:"Quiz or survey",id:"yyPDfhkUT7"})],["start_from_scratch",l.formatMessage({defaultMessage:"Start from scratch",id:"fGhwMpK3XG"})]]),d=new Map(Array.from(o,e=>e.reverse())),c=new Map([["apps_and_websites",tM.E],["documents_and_templates",tS.i],["games",tA.H],["productivity_tools",tE.l],["creative_projects",tz.e],["quiz_or_survey",tT.S],["start_from_scratch",tL.f]]),{sendTransparentMessage:u,conversation:m}=(0,tm.oM)(),{mutate:p}=(0,i.HF)(null==m?void 0:m.id),f=null!=(t=d.get(null!=s?s:""))?t:"default",h=async e=>{o.has(e)&&(r({event_key:"artifact.studio.create_mode_selected",create_mode:e}),(null==m?void 0:m.id)&&p({settings:{enabled_monkeys_in_a_barrel:!1}}),await u(o.get(e)))};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"font-claude-response-body pl-2 mt-1",children:(0,n.jsx)(R.A,{defaultMessage:"Letâ€™s get cooking! Pick an artifact category or start building your idea from scratch.",id:"HKJSK13xqN"})}),(0,n.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 max-w-xl justify-center items-stretch w-full",children:tR.map(e=>{let t=c.get(e);return(0,n.jsx)("div",{className:(0,M.A)("relative w-full h-full min-h-[3.5rem] sm:h-28 p-3 sm:p-3.5 font-base bg-bg-000 rounded-lg transition-colors group",f===e&&"border-0.5 text-text-100 bg-bg-000 shadow-sm",("default"!==f&&f!==e||"default"===f&&a)&&"text-text-500 bg-bg-000/50 border-0.5 border-border-300","default"===f&&!a&&"border-0.5 border-border-300 text-text-300 hover:border-text-200 hover:bg-bg-000 hover:text-text-100 cursor-pointer shadow-sm"),onClick:async()=>{"default"!==f||a||await h(e)},children:(0,n.jsxs)("div",{className:"flex flex-row sm:flex-col items-center sm:items-start justify-center sm:justify-start h-full w-full gap-3 sm:gap-0",children:[t&&(0,n.jsx)(t,{size:20,weight:"light",className:(0,M.A)("transition-transform duration-300 ease-out shrink-0 sm:absolute sm:bottom-4 sm:right-4","default"===f&&!a&&"group-hover:-rotate-2 sm:group-hover:rotate-2 group-hover:scale-105")}),(0,n.jsx)("span",{className:"flex-1 text-left",children:o.get(e)})]})},e)})})]})};var tU=s(98966);let tO=e=>{let{scrollRefs:t,autoScrollRef:s,messageCount:a}=e,i=(0,y.useRef)(a),l=(0,tU.Q)(),r=(0,y.useCallback)(()=>{var e,s,a,n;let i=(null==(e=t.lastAssistantMessage.current)?void 0:e.clientHeight)||0,r=(null==(s=t.lastHumanMessage.current)?void 0:s.clientHeight)||0,o=(null==(a=t.chatInput.current)?void 0:a.clientHeight)||0,d=(null==(n=t.extras.current)?void 0:n.clientHeight)||0,c=l?parseFloat(Z.Ih)*parseFloat(getComputedStyle(document.documentElement).fontSize):0,u=Math.max(window.innerHeight-r-i-d-o-c-112,0);t.extraSpace.current&&(t.extraSpace.current.style.height="".concat(u,"px"))},[t,l]);return(0,y.useLayoutEffect)(()=>{if(i.current!==a){var e;r();let t=null==(e=s.current)?void 0:e.getScrollContainer();t&&t.scrollTo({top:t.scrollHeight-t.clientHeight,behavior:"smooth"})}i.current=a},[a,r,s]),(0,y.useLayoutEffect)(()=>{let e=new ResizeObserver(()=>{r()});return[t.lastAssistantMessage,t.lastHumanMessage,t.chatInput,t.extras].forEach(t=>{t.current&&e.observe(t.current)}),window.addEventListener("resize",r),()=>{e.disconnect(),window.removeEventListener("resize",r)}},[t,r,a]),(0,y.useLayoutEffect)(()=>{var e;null==(e=s.current)||e.scrollToBottom("instant")},[s]),(0,n.jsx)("div",{ref:t.extraSpace,"aria-hidden":"true"})};function tF(){return(0,n.jsx)(ej.P.figure,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"text-text-100 flex flex-col gap-8 text-center","data-testid":"empty-chat-screen",children:(0,n.jsxs)("h2",{className:"font-title flex flex-col items-center justify-center gap-2 sm:flex-row",children:[(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsx)(j.a,{state:"waiting"})}),(0,n.jsx)(R.A,{defaultMessage:"What can I help you with today?",id:"1PnN/uP0zv"})]})})}var tD=s(22047);let tP="/Spark/",tB=[19,17,16,15,14,13,12,11,1,11,12,13,14,15,16,17,19],tG="".concat(tP,"/Check.svg"),tW=U.z.object({changeTitle:U.z.boolean().optional(),titleDelayMs:U.z.number().optional(),changeFavicon:U.z.boolean().optional(),faviconDelayMs:U.z.number().optional(),playSound:U.z.boolean().optional()}),tV={};var tq=s(34898);let tH=(0,y.forwardRef)((e,t)=>(0,n.jsx)("div",{ref:t,"aria-hidden":"true",className:"h-px w-full pointer-events-none"}));tH.displayName="LastMessageSentinel";var tY=s(56782);function tJ(e){let{autoscrollRef:t,sentinelElement:s,isStreaming:a=!1,avatarState:i="static"}=e,l=(0,I.A)(),[r,o]=(0,y.useState)(!1),d=(0,y.useCallback)(()=>{let e=t.current;e&&(e.scrollToBottom("instant"),a&&e.setPinToBottom(!0))},[t,a]);return(0,y.useEffect)(()=>{if(!a){var e;null==(e=t.current)||e.setPinToBottom(!1)}},[a,t]),(0,y.useEffect)(()=>{var e;if(!s)return;let a=null==(e=t.current)?void 0:e.getScrollContainer();if(!a)return;let n=new IntersectionObserver(e=>{let[t]=e;o(!t.isIntersecting)},{root:a,threshold:.01,rootMargin:"0px 0px ".concat(150,"px 0px")});return n.observe(s),()=>{n.disconnect()}},[s,t]),(0,n.jsxs)("button",{onClick:d,"aria-label":l.formatMessage({defaultMessage:"Scroll to bottom",id:"p4l9m92DsT"}),className:(0,M.A)("z-[1] size-9 inline-flex items-center justify-center","absolute -top-8 left-1/2 -translate-x-1/2","border-0.5 overflow-hidden !rounded-full p-1","shadow-md hover:shadow-lg","bg-bg-000/80 hover:bg-bg-000","backdrop-blur transition-opacity duration-200",a?"border-accent-brand/30":"border-border-300",r?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"),children:[(0,n.jsx)(j.a,{state:i,className:(0,M.A)("absolute blur-md transition duration-300 pointer-events-none",a?"opacity-50":"opacity-0")}),(0,n.jsx)(tY.y,{className:"mix-blend-luminosity"})]})}s(50571),s(23910),s(1958);var tK=s(57291);s(72062);let tX=new Set(["md","markdown","mdown","mkdn","mkd","mdwn","mdtxt","mdtext"]),tZ=new Set(["py","pyx","pxd","pxi","pyi","js","jsx","ts","tsx","mjs","cjs","java","scala","kt","kts","groovy","gradle","c","h","cpp","cc","cxx","hpp","hxx","cs","csx","go","rs","rb","rbw","rake","gemspec","php","phtml","php4","php5","php7","phps","swift","kt","kts","ktm","dart","lua","pl","pm","t","pod","r","R","Rmd","Rnw","sh","bash","zsh","fish","bat","cmd","ps1","sql","graphql","gql","json","xml","yaml","yml","toml","ini","cfg","conf"]),tQ=[{pattern:/^#{1,6}\s+/gm,weight:.15,name:"headers"},{pattern:/\[([^\]]+)\]\(([^)]+)\)/g,weight:.1,name:"links"},{pattern:/!\[([^\]]*)\]\(([^)]+)\)/g,weight:.1,name:"images"},{pattern:/^```[\s\S]*?```$/gm,weight:.1,name:"fenced-code"},{pattern:/^(?: {4}|\t)[^\n]+$/gm,weight:.05,name:"indented-code"},{pattern:/`[^`]+`/g,weight:.05,name:"inline-code"},{pattern:/^[\s]*[-*+]\s+/gm,weight:.08,name:"unordered-list"},{pattern:/^[\s]*\d+\.\s+/gm,weight:.08,name:"ordered-list"},{pattern:/\*\*[^*]+\*\*/g,weight:.04,name:"bold"},{pattern:/\*[^*\n]+\*/g,weight:.03,name:"italic"},{pattern:/__[^_]+__/g,weight:.04,name:"bold-underscore"},{pattern:/_[^_\n]+_/g,weight:.03,name:"italic-underscore"},{pattern:/^>\s+/gm,weight:.07,name:"blockquote"},{pattern:/^---+$|^===+$/gm,weight:.05,name:"horizontal-rule"},{pattern:/^\|[^\n]+\|$/gm,weight:.08,name:"table"}];function t$(e,t){var s;let a=e?null==(s=e.split(".").pop())?void 0:s.toLowerCase():void 0;if(a&&tX.has(a))return{isMarkdown:!0,confidence:1,method:"extension"};if(a&&tZ.has(a))return{isMarkdown:!1,confidence:0,method:"extension"};if(t){let e=function(e){if(!e||e.length<10)return 0;let t=0,s=[],a={};for(let{pattern:n,weight:i,name:l}of tQ){let r=e.match(n);if(r&&r.length>0){let e=r.length,n=i*(.7+.3*(["headers","fenced-code","links","images"].includes(l)?Math.min(e,1):Math.min(e/5,1)));t+=n,s.push(l),a[l]=n}}return Math.min(t+.1*(s.length/tQ.length),1)}(t),s=e>=.15;return{isMarkdown:s,confidence:e,method:s?"content":"none"}}return{isMarkdown:!1,confidence:0,method:"none"}}class t1{update(e){if(this.hasLatched)return this.lastResult;let t=t$(this.filename,e);return t.isMarkdown&&(this.hasLatched=!0),this.lastResult=t,t}reset(){this.hasLatched=!1,this.lastResult=t$(this.filename),this.hasLatched=this.lastResult.isMarkdown}isLatched(){return this.hasLatched}constructor(e){this.hasLatched=!1,this.filename=e,this.lastResult=t$(e),this.hasLatched=this.lastResult.isMarkdown}}var t0=s(57965),t2=s.n(t0),t3=s(96091),t4=s(78458);function t8(e){var t;let s=new Set;return null==(t=e.content)||t.filter(e=>"text"===e.type).forEach(e=>{(0,t3.n)(e.text).forEach(e=>s.add(e))}),s}let t9=(0,y.memo)(e=>{let{isStreaming:t,conversationUuid:s,dispatchChatResource:a,openControlsSidebar:n,isDrawerExpanded:i,maxTrackedFiles:l,selectComputerFile:r,lastMessageUuid:o}=e,d=(0,Q.xJ)(s),c=(0,Q.ot)(s),m=(0,N.l)(),p=(0,eG.st)(),f=(0,y.useRef)({lastOpenedId:null});!function(e){let{isStreaming:t,lastMessage:s,conversationUuid:a,dispatchChatResource:n,openControlsSidebar:i,isDrawerExpanded:l,maxTrackedFiles:r}=e,o=(0,y.useRef)(new Map),d=(0,y.useRef)(void 0),c=(0,y.useMemo)(()=>{if(!t||!s||!s.content)return d.current;let e=s.content[s.content.length-1];return d.current=e,e},[t,s]),u=(0,y.useMemo)(()=>null,[c,r]),{detectMarkdown:m,clearDetectors:p}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=(0,y.useRef)(new Map),s=(0,y.useCallback)(s=>{if(t.current.has(s))return t.current.get(s);if(t.current.size>=e){let e=t.current.keys().next().value;e&&t.current.delete(e)}let a=new t1(s);return t.current.set(s,a),a},[e]),a=(0,y.useCallback)(e=>{if(!e||!e.path)return null;if(e.path.includes(".")){let s=e.path,a=[];t.current.forEach((e,t)=>{s.startsWith(t)&&t!==s&&!t.includes(".")&&a.push(t)}),a.forEach(e=>{t.current.delete(e)})}let a=s(e.path);return{isMarkdown:a.update(e.content).isMarkdown,isLatched:a.isLatched(),detector:a}},[s]),n=(0,y.useCallback)(()=>{t.current.clear()},[]);return{detectMarkdown:a,clearDetectors:n,removeDetector:(0,y.useCallback)(e=>{t.current.delete(e)},[]),getDetectorsMap:(0,y.useCallback)(()=>t.current,[]),getOrCreateDetector:s}}(r),{handleMarkdownFileDetected:f,updateStreamingContent:h,clearOpenedFiles:g}=function(e){let{dispatchChatResource:t,openControlsSidebar:s,isDrawerExpanded:a,maxTrackedFiles:n=100,throttleMs:i=100}=e,l=(0,y.useRef)(new Set),r=(0,y.useCallback)(e=>{let t=l.current,s=!t.has(e);if(t.has(e))t.delete(e);else if(t.size>=n){let e=t.values().next().value;e&&t.delete(e)}return t.add(e),s},[n]),o=(0,y.useCallback)(e=>l.current.has(e),[]),d=(0,y.useCallback)(function(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"create_file";r(e)&&(a||s(),t({type:"SELECT_FILE",path:e,toolType:i,messageId:n}))},[t,s,a,r]),c=(0,y.useCallback)(e=>{},[]),u=(0,y.useCallback)(e=>{let{path:s,content:a,renderAs:n,showingInRightPane:i}=e;t({type:"UPDATE_STREAMING_FILE",path:s,content:a,renderAs:n,showingInRightPane:i})},[t]),m=(0,y.useMemo)(()=>t2()(e=>{u(e)},i,{leading:!0,trailing:!0}),[u,i]);(0,y.useEffect)(()=>()=>{m.cancel()},[m]);let p=(0,y.useCallback)(e=>{m(e)},[m]),f=(0,y.useCallback)(e=>{m.cancel(),u(e)},[u,m]),h=(0,y.useCallback)((e,t,s)=>{d(e,s),p({path:e,content:t,renderAs:tK.vU.Markdown,showingInRightPane:!0})},[d,p]);return{trackOpenedFile:r,hasBeenOpened:o,openFileInRightPane:d,registerMarkdownFile:c,updateStreamingContent:p,updateStreamingContentImmediate:f,handleMarkdownFileDetected:h,clearOpenedFiles:(0,y.useCallback)(()=>{l.current.clear()},[]),getOpenedFilesSet:(0,y.useCallback)(()=>l.current,[])}}({dispatchChatResource:n,openControlsSidebar:i,isDrawerExpanded:l,maxTrackedFiles:r});(0,y.useEffect)(()=>{if(!u)return;let{path:e,content:t}=u,a=m(u);if(!a)return;let{isMarkdown:n,isLatched:i}=a,l=(null==s?void 0:s.uuid)||"";n?f(e,t,l):i&&h({path:e,content:t,renderAs:tK.vU.Markdown})},[u,m,f,h,null==s?void 0:s.uuid]);let x=(0,y.useCallback)(()=>{o.current.clear()},[]);(0,y.useEffect)(()=>()=>{a&&(p(),g(),x(),d.current=void 0)},[a,p,g,x])}({isStreaming:t,lastMessage:d,conversationUuid:s,dispatchChatResource:a,openControlsSidebar:n,isDrawerExpanded:i,maxTrackedFiles:l});let h=(0,y.useRef)(!1),g=(0,y.useRef)(!1);return(0,y.useEffect)(()=>{if(!d)return;if(t){h.current=!1,g.current=!0;return}if(h.current||!g.current||!o||!(0,u.GN)(o))return;let e=c.slice(0,-1),a=new Set;e.forEach(e=>{t8(e).forEach(e=>a.add(e))}),Array.from(t8(d)).filter(e=>!a.has(e)).forEach(e=>{p.track({event_key:"wiggle.file.created",chat_message_uuid:o,...(0,t4.k)({filePath:e,isShared:!1,conversationUuid:s,source:"completion"})})}),h.current=!0},[t,d,o,p,s,c]),(0,y.useEffect)(()=>{if(!(m.width<Z.gU)&&d&&!t){let e=function(e){var t;for(let s of null!=(t=e.content)?t:[])if("text"===s.type){for(let e of(0,t3.n)(s.text))if((0,tK.IO)(e))return e}return null}(d),t=f.current.lastOpenedId===e;e&&!t&&o&&(f.current.lastOpenedId=e,r(e,o))}},[t,d,r,o,m.width]),null});t9.displayName="StreamingFileManager";var t5=s(29257);let t7=e=>{let{conversationUuid:t,retryCount:s}=e,[a,i]=(0,y.useState)(""),l=(0,I.A)(),r=(0,Q.uO)(t),o=(0,y.useMemo)(()=>[l.formatMessage({defaultMessage:"Gathering my thoughts, be right there...",id:"C6UYRcZHCt"}),l.formatMessage({defaultMessage:"Contemplating, stand by...",id:"r6P7kLapjf"}),l.formatMessage({defaultMessage:"Pondering, stand by...",id:"l0/dX2gLlN"}),l.formatMessage({defaultMessage:"Ruminating on it, stand by...",id:"wt2OTGsj0k"}),l.formatMessage({defaultMessage:"Pondering, stand by...",id:"l0/dX2gLlN"})],[l]),d=(0,y.useMemo)(()=>l.formatMessage({defaultMessage:"Still working on it, stand by...",id:"R9hnARYgER"}),[l]),c=(0,y.useMemo)(()=>l.formatMessage({defaultMessage:"A bit longer, thanks for your patience...",id:"MCt5e8xpx8"}),[l]);(0,y.useEffect)(()=>{if(r||s&&s>0)return;let e=[];return e.push(setTimeout(()=>{i(o[Math.floor(Math.random()*o.length)])},5e3)),e.push(setTimeout(()=>{i(d)},15e3)),e.push(setTimeout(()=>{i(c)},3e4)),()=>{e.forEach(e=>clearTimeout(e))}},[o,d,c,r,s]);let u=(0,y.useMemo)(()=>s&&s>0?l.formatMessage({defaultMessage:"Taking longer than usual. Trying again shortly (attempt {attemptNumber} of 10)",id:"1OhR91Iznh"},{attemptNumber:s+1}):a,[s,a,l]);return(!r||s&&0!==s)&&u?(0,n.jsx)(ej.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.1},className:"font-claude-response text-text-300 ml-2 pb-1.5 text-sm italic",children:u}):null};function t6(){let e=(0,a._)(["\n  flex-1\n  flex\n  flex-col\n  gap-3\n  px-4\n  max-w-3xl\n  mx-auto\n  w-full\n"]);return t6=function(){return e},e}function se(e){let{isStreaming:t,hasWebSearchResponse:s,retryCount:a,conversationUuid:i,shouldShowWaitingText:l,currentAvatarState:r,isTemporary:o,scrollRef:d,incognitoString:c,isResearchPending:u,enableCompassNotificationsUI:m,tooltipContent:p,notificationPermission:f,enableCompassNotifications:h,enableCompletionNotifications:g,isCompassNotificationEnabled:x,isCompletionNotificationEnabled:C,isSession:v,enableCompletionNotificationsUI:w,isRunningToolOrThinking:_,sessionStatusMessage:k}=e,[N,S]=(0,y.useState)(!1),[A,E]=(0,y.useState)(!1),z=(0,y.useRef)(null),L=(0,y.useRef)(null);return(0,y.useEffect)(()=>{if(w)return _?(L.current&&(clearTimeout(L.current),L.current=null),z.current||(z.current=setTimeout(()=>{S(!0),E(!0)},2e3))):(z.current&&(clearTimeout(z.current),z.current=null),N&&!L.current&&(E(!1),L.current=setTimeout(()=>{S(!1),L.current=null},500))),!t&&(E(!1),L.current&&(clearTimeout(L.current),L.current=null),setTimeout(()=>{S(!1)},500),z.current&&(clearTimeout(z.current),z.current=null)),()=>{z.current&&clearTimeout(z.current),L.current&&clearTimeout(L.current)}},[_,t,w,N]),(0,n.jsx)("div",{ref:d,children:(0,n.jsxs)("div",{className:(0,M.A)("ml-1 mt-0.5 flex items-center transition-transform duration-300 ease-out",t&&"-translate-y-2.5"),children:[(0,n.jsx)("div",{className:"p-1 -translate-x-px",children:(0,n.jsx)(j.a,{state:r})}),k?(0,n.jsx)("div",{className:"font-claude-response text-text-300 ml-2 pb-1.5 text-sm italic",children:k}):null,l?(0,n.jsx)(t7,{conversationUuid:i,retryCount:a}):null,(0,n.jsx)("div",{className:(0,M.A)("text-text-500 px-2 mt-6 flex-1 text-right text-[0.65rem] leading-[0.85rem] sm:text-[0.75rem]",t&&!N&&"pointer-events-none",v&&"hidden"),children:o?(0,n.jsx)("div",{className:(0,M.A)("inline-block select-none transition-opacity mt-1",!t&&"opacity-90 delay-300 duration-700",t&&"opacity-0 duration-0"),children:c}):u&&m?(0,n.jsx)(J,{notificationPermission:f,enableNotifications:h,isFeatureEnabled:x,visible:u}):w&&N&&("granted"!==f||!C)?(0,n.jsx)(J,{notificationPermission:f,enableNotifications:g,isFeatureEnabled:C,visible:A}):(0,n.jsx)(b.Tooltip,{tooltipContent:p,side:"bottom",disableHoverableContent:!0,className:"max-w-full",delayDuration:50,children:(0,n.jsx)(T(),{href:"https://support.anthropic.com/en/articles/8525154-claude-is-providing-incorrect-or-misleading-responses-what-s-going-on",target:"_blank",className:(0,M.A)("inline-block select-none",!t&&"opacity-90 delay-300 duration-700",t&&"opacity-0 duration-0"),children:(0,n.jsx)("span",{className:"hover:text-text-300 transition",children:s?(0,n.jsx)(R.A,{defaultMessage:"Claude can make mistakes. {lineBreak}Please double-check cited sources.",id:"Al7GtlU74g",values:{lineBreak:(0,n.jsx)("br",{className:"block sm:hidden"})}}):(0,n.jsx)(R.A,{defaultMessage:"Claude can make mistakes. {lineBreak}Please double-check responses.",id:"EY1nHGV6e9",values:{lineBreak:(0,n.jsx)("br",{className:"block sm:hidden"})}})})})})})]})})}let st=o.XA.maxFilesPerConversation;function ss(e){var t,s,a,o,v,j,b,M;let{changeDisplayedConversationPath:z,chatInputDefaultMessage:T,conversationTitle:R,conversationUuid:Y,editMessage:J,isStreaming:et,isTemporary:es=!1,isLoading:ea,messageUuids:en,name:ei,onRetry:el,onSend:er,projectUuid:ed,setPersonalizedStyleCallback:ec,retryCount:eu,todos:em,onStopSampling:ep,sessionStatusMessage:ef,onTrailingToolUseDecision:eh}=e,eg=(0,ee.Z)(Y),ex=(0,k.V)(),{isCmdKOpen:eC}=(0,B.l)(),ev=(0,Q.n5)(Y),ej=(0,Q.U4)(Y),eb=(0,Q.Ci)(Y,et),ey=(0,Q.zg)(Y),ew=en[en.length-1]||null,{account:e_,activeOrganization:ek}=(0,g.YL)(),{selectedTier:eN}=(0,C.t)(),eM=(0,x.B)(),eS=(0,I.A)(),eA=(0,O.P2)(),eE=(0,y.useRef)(null),ez=(0,y.useRef)(et);(0,y.useLayoutEffect)(()=>{var e,t,s,a;let n=ez.current;!n&&et&&(null==(t=eE.current)||null==(e=t.getScrollContainer())||e.style.setProperty("overflow-anchor","none")),n&&!et&&(null==(a=eE.current)||null==(s=a.getScrollContainer())||s.style.setProperty("overflow-anchor","auto")),ez.current=et},[et,eE]);let[eT,eL]=(0,y.useState)(null),eR=(0,y.useRef)(null);eR.current=en[en.length-1]||null;let{chatResourceState:eI,dispatchChatResource:eU}=(0,eo.i)(),{serverLastChatMessageWarningProps:eO,updateServerLastChatMessageWarningPropsForNewMessage:eF}=function(e){let[t,s]=(0,y.useState)(null),a=function(e){let{activeOrganization:t}=(0,g.YL)(),s="/api/organizations/".concat((null==t?void 0:t.uuid)||"","/chat_conversations/").concat(e,"/chat_message_warning"),{mutateAsync:a}=(0,tf.L2)(s,"POST",{meta:{noToast:!0}});return(0,y.useCallback)(async e=>{let t=await a(e);return t.warning_props?{contentMarkdown:t.warning_props.content_markdown,style:t.warning_props.style}:null},[a])}(e),n=(0,ee.Z)(e),i=(0,y.useCallback)(e=>{async function t(){if(!n)try{s(await a(e))}catch(e){}}s(null),t()},[a,n]),l=(0,y.useCallback)(e=>{let{messageText:t,parentMessageUuid:s}=e;i({message_text:t,analytics_data:{type:"message_send",prev_message_uuid:s&&s!==u.gF?s:null}})},[i]);return function(e){let{onLastMessageLoaded:t,conversationUuid:s}=e,a=(0,Q.Q3)(s),n=(0,y.useRef)(a);(0,y.useEffect)(()=>{if(!n.current)return;let e=(0,th.C)(n.current);e&&t({uuid:n.current.uuid,messageText:e})},[t])}({onLastMessageLoaded:(0,y.useCallback)(e=>{let{uuid:t,messageText:s}=e;i({message_text:s,analytics_data:{type:"conversation_load",message_uuid:t}})},[i]),conversationUuid:e}),{serverLastChatMessageWarningProps:t,updateServerLastChatMessageWarningPropsForNewMessage:l}}(Y),{setSandboxState:eD}=(0,r.q)(),eB=(0,L.useSearchParams)(),eG=(0,y.useRef)({lastAssistantMessage:(0,y.useRef)(null),lastHumanMessage:(0,y.useRef)(null),chatInput:(0,y.useRef)(null),extras:(0,y.useRef)(null),extraSpace:(0,y.useRef)(null)}).current,eW=(0,y.useCallback)(()=>{let e=eG.lastAssistantMessage.current;if(!e)return!0;let t=e.getBoundingClientRect(),s=window.innerHeight;return t.bottom<s+50},[eG.lastAssistantMessage]);(0,y.useEffect)(()=>(et?c.Z.setVisibilityCheck(eW):c.Z.clearVisibilityCheck(),()=>{c.Z.clearVisibilityCheck()}),[et,eW]);let eV=(0,y.useRef)(null),eq=(0,y.useCallback)(async e=>{let{prompt:t,attachments:s,files:a,syncSources:n,personalized_style:i,compass_mode:l}=e;if(et&&!eg)return;eU({type:"SET_ACTIVE_MESSAGE_UUID",uuid:void 0}),eF({messageText:t,parentMessageUuid:eR.current}),eD(Y,{conversationFiles:[...eI.files,...a],allAttachments:[...eI.attachments,...s],projectUuid:ed});let r={prompt:t,attachments:s,files:a,syncSources:n,rethrowErrors:!0,parent_message_uuid:eR.current||u.gF,personalized_style:i,org_type_override:null!=eN?eN:void 0,compass_mode:l};await er(r)},[eg,et,eU,eF,eD,Y,eI.files,eI.attachments,er,ed,eN]),eH=(0,y.useCallback)((e,t)=>{eU({type:"SET_ACTIVE_MESSAGE_UUID",uuid:void 0}),eD(Y,{conversationFiles:eI.files,allAttachments:eI.attachments,projectUuid:ed}),el(e,t)},[eU,eD,Y,eI.files,eI.attachments,ed,el]),eY=(0,y.useCallback)(async()=>{if(et)return;let e=eS.formatMessage({defaultMessage:"Continue",id:"acrOozm08x"});await er({prompt:e,attachments:[],files:[],syncSources:[],rethrowErrors:!0,parent_message_uuid:eR.current||u.gF})},[eS,et,eR,er]),eJ=(0,y.useCallback)((e,t)=>{if(J){var s;eU({type:"CLEAR_SELECTED"}),J(e,t),eF({messageText:t,parentMessageUuid:null!=(s=e.parent_message_uuid)?s:null})}},[eU,J,eF]),eK=(0,y.useMemo)(()=>(0,E.A)(),[]);(0,y.useEffect)(()=>(eK.on("retry",e=>{let{parent_message_uuid:t,paprika_mode:s}=e;eH(t,s)}),eK.on("edit",e=>{let{message:t,text:s}=e;eJ(t,s)}),()=>{eK.off("retry"),eK.off("edit")}),[eK,eH,eJ]);let{files:eX,attachments:eZ,selectedItem:eQ}=eI,{isDrawerExpanded:e$,setIsDrawerExpanded:e0}=(0,e1.x)(),e2=(0,y.useCallback)(()=>{eU({type:"CLEAR_SELECTED"}),e0(!0)},[eU,e0]),e3=(0,y.useCallback)(()=>{e0(!1)},[e0]),e4=(0,Q.QS)(),e8=(0,Q.P8)(),e9=(0,Q.w0)();(0,y.useEffect)(()=>{eU({type:"UPDATE_FILES",files:e4})},[e4,eU]),(0,y.useEffect)(()=>{eU({type:"UPDATE_ATTACHMENTS",attachments:e8})},[eU,e8]),(0,y.useEffect)(()=>{eU({type:"UPDATE_SYNC_SOURCES",syncSources:e9})},[eU,e9]);let e5=(0,y.useCallback)(e=>{e2(),eU({type:"SELECT_ATTACHMENT",attachment:e})},[eU,e2]),e7=(0,y.useMemo)(()=>!!((null==eM?void 0:eM.preview_feature_uses_artifacts)||ey),[eM,ey]),e6=(0,D.QY)(),te=(0,y.useCallback)((e,t,s)=>{e2(),eU({type:"SELECT_ARTIFACT",id:e,versionUuid:s}),eU({type:"SET_ACTIVE_MESSAGE_UUID",uuid:t||""})},[eU,e2]),tt=(0,y.useCallback)((e,t)=>{e2(),eU({type:"SELECT_FILE",path:e.replace("computer://",""),toolType:"create_file",messageId:t})},[eU,e2]),ts=(0,Q.SY)(),tn=(0,y.useRef)({lastOpenedId:null}),ti=(0,N.l)();(0,y.useEffect)(()=>{if(ti.width<Z.gU)return;let e=tn.current.lastOpenedId===ts;et&&ts&&!e&&(tn.current.lastOpenedId=ts,te(ts))},[et,ts,te,ti.width]),(0,y.useEffect)(()=>{let e=eB.get("artifactId"),t=eB.get("versionUuid");e&&(e2(),eU({type:"SELECT_ARTIFACT",id:e,versionUuid:t||void 0}))},[]);let tl=(0,y.useRef)(!1);(0,y.useEffect)(()=>{(null==em?void 0:em.length)&&!tl.current&&(tl.current=!0,e2())},[e2,em]);let tr=(0,y.useMemo)(()=>{if(et&&eb&&eb.content)return eb.content[eb.content.length-1]},[et,eb]),to=et&&(!eb||!(null==(t=eb.content)?void 0:t[0])&&0===eb.attachments.length&&0===eb.files.length&&0===eb.files_v2.length),td=tr&&("tool_use"===tr.type||"tool_result"===tr.type),tc=tr&&("tool_use"===tr.type||"tool_result"===tr.type||"thinking"===tr.type),tC=(0,y.useMemo)(()=>{if(eb&&!et)return(0,$.eb)(eb)},[et,eb]),tv=!et&&void 0!==tC,{compassStatus:tj}=(0,K.CH)({organizationUuid:null==ek?void 0:ek.uuid,conversationUuid:Y,taskId:tC,isShared:!1,enabled:tv}),tb=(0,y.useMemo)(()=>{if(!eb||et)return!1;let e=(0,$.nb)(eb);return!!(e&&!e.is_error&&(0,_.i3)(null==tj?void 0:tj.status))&&!(0,$.OC)(eb)},[et,tj,eb]),ty=(0,X.Wo)(),tw=(0,X.hG)(),t_=(0,F.Lr)(),tN=(0,F.KG)("compass"),tM=(0,F.KG)("completion"),tS=(0,w.fS)("claudeai_notifications_settings"),tA=(0,w.fS)("compass_enable_notifications_web")&&!ex,tE=(0,w.fS)("web_completion_notif")&&!ex,tz=(0,y.useCallback)(async()=>{let e=await tw();return e&&await t_(!0,tS?void 0:["compass"]),e},[tS,tw,t_]),tT=(0,y.useCallback)(async()=>{let e=await tw();return e&&await t_(!0,tS?void 0:["completion"]),e},[tS,tw,t_]),tL=(0,y.useMemo)(()=>to?"thinking":td||tb||eg&&et?"shimmer":et?"writing":"static",[to,td,tb,et,eg]);((e,t,s)=>{let a=(0,w.T9)("claude_ai_tabbed_out_notifications","features",tV,tW),n="visible"===(0,tD.f)(),{setThinkingTitle:i,setReceivedTitle:l,resetTitle:r}=((e,t,s)=>{let a=(0,y.useRef)(null),n=(0,y.useCallback)(()=>{a.current&&(clearInterval(a.current),a.current=null),document.title="Working on it..."},[]),i=(0,y.useCallback)(()=>{if(a.current)return;let t=0;a.current=setInterval(()=>{document.title=e[t],t=(t+1)%e.length},s)},[s,e]),l=(0,y.useCallback)(()=>{a.current&&(clearInterval(a.current),a.current=null),document.title=t},[t]);return(0,y.useMemo)(()=>({setThinkingTitle:n,setReceivedTitle:i,resetTitle:l}),[n,i,l])})(["Ready to chat",e],e,a.titleDelayMs||1600),{setWritingFavicon:o,setCompleteFavicon:d,resetFavicon:c}=(e=>{let t=(0,y.useRef)(null),s=(0,y.useCallback)(e=>{let t=document.querySelector("link[rel~='icon']")||document.createElement("link");t.rel="icon",t.href=e,document.head.appendChild(t)},[]),a=(0,y.useCallback)(()=>{t.current&&clearInterval(t.current),t.current=null,s("/favicon.ico")},[s]),n=(0,y.useCallback)(()=>{if(t.current)return;let a=0;t.current=setInterval(()=>{s("".concat(tP,"/").concat(tB[a],".svg")),a=(a+1)%tB.length},e)},[e,s]),i=(0,y.useCallback)(()=>{a(),s(tG)},[s,a]);return(0,y.useMemo)(()=>({setWritingFavicon:n,setCompleteFavicon:i,resetFavicon:a}),[n,i,a])})(a.faviconDelayMs||100),{playSound:u,resetSound:m}=(()=>{let e=(0,y.useRef)(null),t=(0,y.useRef)(!1);(0,y.useEffect)(()=>{try{e.current=new Audio("/click.mp3")}catch(e){}},[]);let s=(0,y.useCallback)(()=>{if(!t.current){t.current=!0;try{e.current||(e.current=new Audio("/click.mp3"))}finally{var s;null==(s=e.current)||s.play()}}},[]),a=(0,y.useCallback)(()=>{t.current=!1},[]);return(0,y.useMemo)(()=>({playSound:s,resetSound:a}),[s,a])})(),p=(0,y.useRef)(!1);(0,y.useEffect)(()=>{let e=t&&s,f=!t&&s,h=!t&&!s;e&&!p.current&&(p.current=!0);let g=h&&p.current;if(g&&(p.current=!1),n){a.changeTitle&&r(),a.changeFavicon&&c();return}a.changeTitle&&(e||f?i():g&&l()),a.changeFavicon&&(f?o():g&&(d(),p.current=!1)),a.playSound&&(e?m():g&&u())},[a,t,s,n,i,l,r,o,d,c,u,m])})(R,to,et);let{getCreateParamsForConvo:tR}=(0,f.I)();(0,y.useEffect)(()=>{if(ea)return;let e=tR(Y);e&&void 0!==e.prompt&&(e.prompt.length>0||e.files.length>0||e.attachments.length>0||e.syncSources.length>0)&&eq(e).catch(()=>{var t;null==(t=eV.current)||t.setContent(e.prompt,e.attachments,e.files)})},[Y,eq,tR,ea]);let{data:tU}=(0,P.fo)(ed),tY=(0,W.K)(),tK=(0,G.ED)(ed),{publishedArtifactsByMessageUuid:tX}=(0,l.rC)({includeDeletedArtifacts:!0}),{mutate:tZ,isPending:tQ}=(0,i.aC)(Y),t$=(0,f.E)(),t1=(0,y.useCallback)((e,t)=>{eU({type:"CLEAR_SELECTED"}),null==z||z(e,t)},[z,eU]),t0=(0,m.Z3)(Y);(0,tp.hq)(Y);let t2=(0,y.useMemo)(()=>!!eb&&!et&&!!eb.content&&eb.content.some(e=>"tool_use"===e.type&&"end_conversation"===e.name),[eb,et]),{activeModelOptions:t3}=(0,p.A9)(),t4=U.z.array(U.z.string()),t8=(0,w.T9)("invite_contest_name","model_prefixes",[],t4),{data:t7}=(0,i.Fn)();(0,y.useEffect)(()=>{if(!et&&2===en.length&&(null==ev?void 0:ev.sender)==="human"&&"assistant"===ej&&t8.some(e=>null==t0?void 0:t0.startsWith(e))&&t7&&t7.count>=2){let e=new CustomEvent("firstClaudeMessage",{detail:{conversationUuid:Y,model:t0}});window.dispatchEvent(e)}},[et,en.length,ev,ej,t0,Y,t8,t7]);let t6=(0,y.useMemo)(()=>{let e=eS.formatMessage({defaultMessage:"Learn about Claudeâ€™s responses â†—",id:"dD0oo8Rjtz"}),t=t3.find(e=>e.model===t0);if(!t||!t.knowledgeCutoff)return e;let s=A.c9.fromFormat(t.knowledgeCutoff,"LLLL yyyy",{locale:"en-US"});if(!s.isValid)return eS.formatMessage({defaultMessage:"Knowledge limited past {cutoff}. Learn more â†—",id:"fozOi7zOey"},{cutoff:t.knowledgeCutoff});{let e=s.toLocaleString({year:"numeric",month:"long"},{locale:eS.locale});return eS.formatMessage({defaultMessage:"Knowledge limited past {cutoff}. Learn more â†—",id:"fozOi7zOey"},{cutoff:e})}},[t0,t3,eS]),ss=(0,y.useMemo)(()=>e$&&eI.selectedItem?eI.selectedItem:void 0,[e$,eI.selectedItem]),sn=(0,y.useCallback)(e=>(0,n.jsx)(t5.A,{...e,conversationUuid:Y,onOpenArtifact:e7?te:void 0,selectedDrawerItem:ss,autoscrollRef:eE,isSessionChat:eg}),[Y,e7,te,ss,eg]),si=(0,y.useMemo)(()=>({id:Y,messagesSoFar:en.length,files:eX,attachmentsSoFar:eZ.length,isSampling:et,isStoppingSampling:tQ,model:t0,projectKnowledgebaseTokens:null!=tK?tK:0,conversationSettings:eM}),[eZ.length,eM,Y,eX,tQ,et,en.length,t0,tK]),sl=(0,y.useMemo)(()=>!!eb&&!et&&"assistant"===eb.sender&&eb.content&&eb.content.some(e=>"tool_result"===e.type&&"web_search"===e.name),[eb,et]),sr=(0,y.useCallback)(()=>{(0,d.OZ)(),tZ(),ep&&ep()},[tZ,ep]),so=(0,y.useCallback)(async e=>{await eq({prompt:e.prompt,attachments:[],files:e.files,syncSources:[]})},[eq]),sd=(0,y.useMemo)(()=>{var e;return(null==si||null==(e=si.conversationSettings)?void 0:e.create_mode)&&0===en.length?null:t2?(0,n.jsx)("div",{ref:eG.chatInput,className:"sticky bottom-0 mx-auto w-full pt-6 z-[5]",children:(0,n.jsx)(tu,{conversationUuid:Y})}):(0,n.jsxs)("div",{ref:eG.chatInput,className:"sticky bottom-0 mx-auto w-full pt-6 z-[5] relative",children:[(0,n.jsx)(tJ,{autoscrollRef:eE,sentinelElement:eT,isStreaming:et,avatarState:tL}),(0,n.jsx)(V.V,{ref:eV,placement:"bottom",disabled:ea||!!(eR.current&&!(0,u.GN)(eR.current)),onRetry:(e,t)=>el(e,void 0,void 0,t),disableDropZone:eC,enableScreenDrop:!0})]})},[null==si||null==(s=si.conversationSettings)?void 0:s.create_mode,en.length,t2,eG.chatInput,eT,et,tL,ea,eC,Y,el]),sc=(0,h.u9)();if(!e_)return null;let su=et&&(eu||2===en.length);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t9,{isStreaming:et,conversationUuid:Y,dispatchChatResource:eU,openControlsSidebar:e2,isDrawerExpanded:e$,maxTrackedFiles:st,selectComputerFile:tt,lastMessageUuid:ew||void 0}),(0,n.jsx)(tg.b,{autoscrollRef:eE,autoScrollInnerClassName:0===en.length?"h-full":"",rightSidebarElement:sc?(0,n.jsx)(ta,{todos:null!=em?em:[],conversationUuid:Y,projectUuid:ed,isStreaming:et,isTemporary:es,messagesLength:en.length}):null,mainElement:(0,n.jsxs)(tm._A,{conversation:si,projectUuid:ed,onSend:eq,onCreate:t$,onStopSampling:sr,setPersonalizedStyleCallback:ec,children:[(0,n.jsx)(tq.Q,{chatId:Y,chatName:ei,onSend:so,hasFirstMessage:!!ev&&!ea}),(0,n.jsxs)("div",{className:"mx-auto flex size-full max-w-3xl flex-col md:px-2",children:[(0,n.jsx)(tk,{conversationUuid:Y}),(0,n.jsx)(S.N,{mode:"wait",children:ea?(0,n.jsx)(sa,{className:"pt-2",children:(0,n.jsx)(H,{})}):0===en.length?(0,n.jsx)(n.Fragment,{children:(null==si||null==(a=si.conversationSettings)?void 0:a.create_mode)?(0,n.jsx)(sa,{className:"pt-1",children:(0,n.jsx)(tI,{})}):(0,n.jsx)(sa,{className:"justify-center items-center",children:(0,n.jsx)(tF,{})})}):(0,n.jsxs)(sa,{className:"pt-1",children:[(null==si||null==(o=si.conversationSettings)?void 0:o.create_mode)&&(0,n.jsx)(tI,{selectedLabel:(null==ev||null==(j=ev.content)||null==(v=j[0])?void 0:v.type)==="text"?null==ev||null==(M=ev.content)||null==(b=M[0])?void 0:b.text:void 0,disabled:en.length>0}),(0,n.jsx)(tx.$,{renderToolUseCell:sn,children:en.map((e,t)=>{var s;let a=Q.oz.getState().messageByUuid[e],i=t===en.length-1,l=t===en.length-2,r=(null==a?void 0:a.sender)==="human"&&(l||i);return(0,n.jsx)(q.c,{lastHumanMessageRef:eG.lastHumanMessage,lastAssistantMessageRef:eG.lastAssistantMessage,previousMessageUuid:t>0?en[t-1]:void 0,messageUuid:e,conversationUuid:Y,conversationSettings:eM,isStreaming:et,isLastMessage:i,isLastHumanMessage:r,isFirstAssistantMessage:1===t&&"assistant"===ej,messageWarningProps:t===en.length-1&&eO||void 0,onOpenArtifact:e7?te:void 0,onOpenWiggleFile:tt,selectAttachment:e5,changeDisplayedConversationPath:t1,editable:!0,publishedArtifacts:null==tX?void 0:tX[e],actionEmitter:eK,onSendContinue:eY,isResearchPending:tb,isTemporary:es,model:t0,extendedThinkingSetting:null!=(s=null==eM?void 0:eM.paprika_mode)?s:null,showArtifacts:e7,chatFeedbackEnabled:e6,isInteractive:!0,shareType:null,showSharedImageMissing:!1,showSharedFileMissing:!1},t)})}),null,(0,n.jsx)(tH,{ref:eL}),(0,n.jsx)(se,{isStreaming:et,hasWebSearchResponse:!!sl,shouldShowWaitingText:!!su,retryCount:eu,conversationUuid:Y,currentAvatarState:tL,scrollRef:eG.extras,isTemporary:es,incognitoString:eA,isResearchPending:tb,enableCompassNotificationsUI:tA,enableCompletionNotificationsUI:tE,isRunningToolOrThinking:tc,tooltipContent:t6,notificationPermission:ty,enableCompassNotifications:tz,enableCompletionNotifications:tT,isCompassNotificationEnabled:tN,isCompletionNotificationEnabled:tM,isSession:eg,sessionStatusMessage:ef}),(0,n.jsx)(tO,{scrollRefs:eG,autoScrollRef:eE,messageCount:en.length})]})}),sd]})]}),drawerElement:(0,n.jsx)(eP,{conversationUuid:Y,isOpen:e$,onClose:e3,isStreaming:et,projectUuid:ed,sendMessage:eq,isTemporary:es}),isDrawerOpen:!!(e$&&eQ),headerProps:{conversationUuid:Y,name:ei,project:tY?tU:void 0,controlsSidebarIsOpen:e$,closeControlsSidebar:e3,openControlsSidebar:e2,isStreaming:et,isLoading:ea}})]})}let sa=v.J.div(t6())},88769:(e,t,s)=>{s.d(t,{Bk:()=>i,Kc:()=>r,LR:()=>l});var a=s(4211),n=s(50848);let i=(0,a.v)()((0,n.eh)((e,t)=>({features:{},setMessageFeatures:(t,s)=>e(e=>({features:{...e.features,[t]:{...e.features[t],...s}}})),clearAllFeatures:()=>e({features:{}}),getMessageFeatures:e=>t().features[e],hasLink:e=>{var s,a;return null!=(a=null==(s=t().features[e])?void 0:s.hasLink)&&a},hasCode:e=>{var s,a;return null!=(a=null==(s=t().features[e])?void 0:s.hasCode)&&a}}))),l=e=>i(t=>{var s,a;return null!=(a=null==(s=t.features[e])?void 0:s.hasLink)&&a}),r=e=>i(t=>{var s,a;return null!=(a=null==(s=t.features[e])?void 0:s.hasCode)&&a})},91786:(e,t,s)=>{s.d(t,{NotificationListener:()=>R,hG:()=>L,Wo:()=>z});var a=s(74813),n=s(64328),i=s(68067),l=s(28044),r=s(5655),o=s(56929),d=s(20861),c=s(847),u=s(7620),m=s(60516),p=s(40297),f=s(48938),h=s(78979);let g=(0,p.w)("CiRhbnRocm9waWMvY2xhdWRlL3B1c2gvZW52ZWxvcGUucHJvdG8SFWFudGhyb3BpYy5jbGF1ZGUucHVzaCJfChVQdXNoT3BlcmF0aW9uRW52ZWxvcGUSDwoHc2VydmljZRgBIAEoCRIOCgZtZXRob2QYAiABKAkSJQoHcmVxdWVzdBgDIAEoCzIULmdvb2dsZS5wcm90b2J1Zi5BbnlC4wEKGWNvbS5hbnRocm9waWMuY2xhdWRlLnB1c2hCDUVudmVsb3BlUHJvdG9QAVpBZ2l0aHViLmNvbS9hbnRocm9waWNzL21vYmlsZS1hcHBzL2dvL3Byb3Rvcy9hbnRocm9waWMvY2xhdWRlL3B1c2iiAgNBQ1CqAhVBbnRocm9waWMuQ2xhdWRlLlB1c2jKAhVBbnRocm9waWNcQ2xhdWRlXFB1c2jiAiFBbnRocm9waWNcQ2xhdWRlXFB1c2hcR1BCTWV0YWRhdGHqAhdBbnRocm9waWM6OkNsYXVkZTo6UHVzaGIGcHJvdG8z",[h.f]),x=(0,f.Z)(g,0);var C=s(34734),v=s(58033);let j=(0,p.w)("CiZhbnRocm9waWMvY2xhdWRlL3B1c2gvb3BlcmF0aW9ucy5wcm90bxIVYW50aHJvcGljLmNsYXVkZS5wdXNoItECCg9PcGVuQ2hhdFJlcXVlc3QSIgoMYWNjb3VudF91dWlkGAEgASgJUgxhY2NvdW50X3V1aWQSLAoRb3JnYW5pemF0aW9uX3V1aWQYAiABKAlSEW9yZ2FuaXphdGlvbl91dWlkEiwKEWNvbnZlcnNhdGlvbl91dWlkGAMgASgJUhFjb252ZXJzYXRpb25fdXVpZBJjChxzYW1wbGluZ19jb21wbGV0ZWRfdGltZXN0YW1wGAQgASgLMhouZ29vZ2xlLnByb3RvYnVmLlRpbWVzdGFtcEgAUhxzYW1wbGluZ19jb21wbGV0ZWRfdGltZXN0YW1wiAEBEicKDG1lc3NhZ2VfdXVpZBgFIAEoCUgBUgxtZXNzYWdlX3V1aWSIAQFCHwodX3NhbXBsaW5nX2NvbXBsZXRlZF90aW1lc3RhbXBCDwoNX21lc3NhZ2VfdXVpZCKKAQoWT3BlbkNvZGVTZXNzaW9uUmVxdWVzdBIiCgxhY2NvdW50X3V1aWQYASABKAlSDGFjY291bnRfdXVpZBIsChFvcmdhbml6YXRpb25fdXVpZBgCIAEoCVIRb3JnYW5pemF0aW9uX3V1aWQSHgoKc2Vzc2lvbl9pZBgDIAEoCVIKc2Vzc2lvbl9pZDLFAQodTG9nZ2VkSW5QdXNoT3BlcmF0aW9uc1NlcnZpY2USSgoIT3BlbkNoYXQSJi5hbnRocm9waWMuY2xhdWRlLnB1c2guT3BlbkNoYXRSZXF1ZXN0GhYuZ29vZ2xlLnByb3RvYnVmLkVtcHR5ElgKD09wZW5Db2RlU2Vzc2lvbhItLmFudGhyb3BpYy5jbGF1ZGUucHVzaC5PcGVuQ29kZVNlc3Npb25SZXF1ZXN0GhYuZ29vZ2xlLnByb3RvYnVmLkVtcHR5QuUBChljb20uYW50aHJvcGljLmNsYXVkZS5wdXNoQg9PcGVyYXRpb25zUHJvdG9QAVpBZ2l0aHViLmNvbS9hbnRocm9waWNzL21vYmlsZS1hcHBzL2dvL3Byb3Rvcy9hbnRocm9waWMvY2xhdWRlL3B1c2iiAgNBQ1CqAhVBbnRocm9waWMuQ2xhdWRlLlB1c2jKAhVBbnRocm9waWNcQ2xhdWRlXFB1c2jiAiFBbnRocm9waWNcQ2xhdWRlXFB1c2hcR1BCTWV0YWRhdGHqAhdBbnRocm9waWM6OkNsYXVkZTo6UHVzaGIGcHJvdG8z",[C.t,v.i]),b=(0,f.Z)(j,0),y=(0,f.Z)(j,1);var w=s(44259),_=s(48615),k=s(24429);let N=(0,w.Iq)(j);function M(e){if(!e)return null;try{let t=(0,_.Rf)(x,JSON.parse(e),{registry:N});if(!t.request||!t.method)return null;switch(t.method){case"OpenChat":{let e=(0,k.rW)(t.request,b);if(null==e?void 0:e.conversationUuid){let t=e.conversationUuid;return{method:"OpenChat",targetUrl:"/chat/".concat(t)}}break}case"OpenCodeSession":{let e=(0,k.rW)(t.request,y);if(null==e?void 0:e.sessionId){let t=e.sessionId;return{method:"OpenCodeSession",targetUrl:"/code/".concat(t)}}}}return null}catch(e){return null}}var S=s(40459);let A={apiKey:"AIzaSyDu88493oN_Xq4PNVr_x8GUZPZhe-byS4U",authDomain:"proj-scandium-production-5zhm.firebaseapp.com",projectId:"proj-scandium-production-5zhm",storageBucket:S.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET||"",messagingSenderId:"365066964946",appId:"1:365066964946:web:920eb01ec340c52cb8420b",measurementId:S.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID||""},E="BBn_zDr7ckBwzQe6Tdc1k6E0tSdrG64L2ddLR36jUkdaleKmAdfgt3ao93t-nib3n3oBaAtbd9KyoxHaUGJLEzU",z=()=>{let[e,t]=(0,u.useState)(()=>"Notification"in window?Notification.permission:"default");return(0,u.useEffect)(()=>{"Notification"in window&&t(Notification.permission)},[]),(0,r.M)("focus",()=>{"Notification"in window&&t(Notification.permission)}),e},T=async e=>{let{isClaudeElectronApp:t,onTokenReceived:s,track:a}=e;if(!("Notification"in window))return!1;try{let e=await Notification.requestPermission();if(a&&a({event_key:"claudeai.notification.permission.result",permission:e}),"granted"!==e)return a&&a({event_key:"claudeai.notification.permission.result",permission:e}),!1;{let e,a;if(t||(e=0===(0,d.Dk)().length?(0,d.Wp)(A):(0,d.Sx)(),!await (0,c.TT)()))return!1;try{a=(0,c.dG)(e)}catch(e){return!1}let n=(await navigator.serviceWorker.getRegistrations()).find(e=>{var t;return null==(t=e.active)?void 0:t.scriptURL.includes("firebase-messaging-sw.js")});if(!n&&1)try{n=await navigator.serviceWorker.register("/firebase-messaging-sw.js"),await navigator.serviceWorker.ready}catch(e){(0,o.Cp)(e,{tags:{action:"registerServiceWorker"}})}try{let e=await (0,c.gf)(a,{vapidKey:E,serviceWorkerRegistration:n});if(e)s(e);else throw(0,o.Cp)(Error("FCM token is null"),{tags:{action:"getToken"}}),Error("FCM token is null")}catch(e){throw(0,o.Cp)(e,{tags:{action:"getToken"}}),e}}return"granted"===e}catch(e){return(0,o.Cp)(e,{tags:{action:"requestPermission"}}),!1}},L=()=>{let{track:e}=(0,a.st)(),{mutate:t}=(0,m.E)(),s=(0,l.V)();return(0,u.useCallback)(async()=>(e({event_key:"claudeai.notification.permission.request_started"}),await T({isClaudeElectronApp:s,onTokenReceived:e=>{t({channel_type:m.zZ.FCM,registration_token:e,client_app_name:"claude-ai-web"})},track:e})),[t,s,e])},R=()=>{let e=(0,u.useRef)(null),{account:t}=(0,n.YL)(),{mutate:s}=(0,m.E)(),r=(0,l.V)(),p=(0,i.fS)("claudeai_skip_foreground_notifications"),{track:f}=(0,a.st)(),h=async()=>{let t;if(t=0===(0,d.Dk)().length?(0,d.Wp)(A):(0,d.Sx)(),!await (0,c.TT)())return{app:null,messaging:null};if(e.current)return{app:t,messaging:e.current};let s=(0,c.dG)(t);return e.current=s,{app:t,messaging:s}},g=async e=>{try{return await (0,c.gf)(e,{vapidKey:E})}catch(e){return(0,o.Cp)(e,{tags:{action:"getFCMToken"}}),null}},x=(0,u.useCallback)(e=>{s({channel_type:m.zZ.FCM,registration_token:e,client_app_name:"claude-ai-web"})},[s]);return(0,u.useEffect)(()=>{var e;let t=!0,s=null;(async()=>{if(!r&&"Notification"in window&&"granted"===Notification.permission)try{let{messaging:e}=await h();if(!e||!t)return;let a=await g(e);a&&t&&x(a),s=(0,c.xD)(e,e=>{var t,s,a;if(p)return;if((null==(t=e.data)?void 0:t.notification_feature_category)==="completion"){let t=M(e.data.payload);if((null==t?void 0:t.targetUrl)&&window.location.pathname.includes(t.targetUrl))return;navigator.serviceWorker.getRegistrations().then(t=>{let s=t.find(e=>{var t;return null==(t=e.active)?void 0:t.scriptURL.includes("firebase-messaging-sw.js")});(null==s?void 0:s.active)&&s.active.postMessage({type:"SHOW_COMPLETION_NOTIFICATION",payload:e.data})});return}let n=(null==(s=e.data)?void 0:s.title)||"Claude",i={body:null==(a=e.data)?void 0:a.body,icon:"/favicon.svg",badge:"/favicon.svg",data:e.data},l=new Notification(n,i);l.onclick=()=>{var t,s;window.focus(),l.close();let a="/";if(null==(t=e.data)?void 0:t.payload){let t=M(e.data.payload);t&&(a=t.targetUrl)}f({event_key:"claudeai.notification.clicked",category:(null==(s=e.data)?void 0:s.notification_feature_category)||"unknown",target_url:a,location:"foreground"}),window.location.href=a}})}catch(e){(0,o.Cp)(e,{tags:{action:"setupNotifications"}})}})();let a=e=>{let t=e.data;(null==t?void 0:t.type)==="TRACK_NOTIFICATION_CLICK"&&f({event_key:"claudeai.notification.clicked",category:t.category||"unknown",target_url:t.targetUrl,location:t.location||"background"}),(null==t?void 0:t.type)==="NOTIFICATION_CLICK_NAVIGATE"&&(null==t?void 0:t.targetUrl)&&(window.location.href=t.targetUrl),(null==t?void 0:t.type)==="GET_CURRENT_URL"&&(null==t?void 0:t.requestId)&&e.source&&e.source.postMessage({type:"CURRENT_URL_RESPONSE",requestId:t.requestId,url:window.location.href})};return null==(e=navigator.serviceWorker)||e.addEventListener("message",a),()=>{var e;t=!1,s&&s(),null==(e=navigator.serviceWorker)||e.removeEventListener("message",a)}},[t,r,p,f,x]),null}},96091:(e,t,s)=>{s.d(t,{n:()=>a});let a=e=>{let t,s=[],a=/\[[^\]]*\]\((computer:\/\/\/[^)]+)\)/g;for(;null!==(t=a.exec(e));)s.push(t[1]);let n=RegExp("(?<!\\]\\()computer:\\/\\/\\/[^\\s)\\].,;!?]+(?![^[]*\\])","g");return s.push(...e.match(n)||[]),[...new Set(s.map(e=>e.replace(/[.,;!?)]+$/,"")))]}},99411:(e,t,s)=>{s.d(t,{NG:()=>f,aX:()=>h,sH:()=>g});var a=s(54568),n=s(89626),i=s(66716),l=s(48252),r=s(67453),o=s(16256),d=s(72902),c=s(61295),u=s(7620),m=s(787),p=s(20804);let f=e=>{let{isExpanded:t,isScrollable:s,snappyTransition:n,children:l,className:r,onTransitionEnd:m,onAnimationComplete:p,collapsesHalfway:f,setIsExpanded:h,footer:g}=e,x=(0,u.useRef)(t),C=!!(f&&!t&&h),v=f&&!t;return(0,a.jsxs)(c.P.div,{className:(0,d.A)("overflow-hidden shrink-0",!t&&C&&"cursor-pointer"),tabIndex:-1,initial:{opacity:0,height:x.current?"auto":0},animate:t?"expanded":"collapsed",variants:{expanded:{opacity:1,height:"auto"},collapsed:{opacity:.6*!!f,height:72*!!f}},whileHover:{opacity:1},transition:n?{ease:o.A.snappyOut,duration:.4}:{ease:"easeInOut",duration:.4},onTransitionEnd:m,onAnimationComplete:p,onClick:C?()=>h(!0):void 0,children:[(0,a.jsx)(i.r,{gradientHeight:16,tabIndex:-1,style:{scrollbarGutter:"stable"},className:(0,d.A)("h-full",s&&"!max-h-[238px]",r,v&&"[mask-image:linear-gradient(to_bottom,_hsl(var(--always-black)/100%)_0%,_hsl(var(--always-black)/0%)_100%)]",!t&&"pointer-events-none"),children:l}),g]})},h=e=>{let{handleClick:t,isDisabled:s,isExpanded:i,isStreaming:o,isError:u,errorMessage:f,icon:h,text:g,secondaryIcon:x,secondaryText:C,isFirstBlockOfMessage:v,isLastBlockOfMessage:j,className:b,wrapperClassName:y,children:w,renderMode:_=m.l.Standard,isFirstItemInGroup:k,isLastItemInGroup:N}=e,M=s||!t,S=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:t,className:(0,d.A)("group/row flex flex-row items-center justify-between gap-4 rounded-lg text-text-300 h-[2.625rem] py-2 px-3",M?"cursor-default":"cursor-pointer transition-colors duration-200 hover:text-text-200 hover:text-text-000",b),disabled:M,children:[(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2 min-w-0",children:[h&&_!==m.l.TimelineGroup&&(0,a.jsx)("div",{className:"w-5 h-5 flex items-center justify-center text-text-100",children:h}),(0,a.jsx)("div",{className:"relative bottom-[0.5px] font-base text-left leading-tight overflow-hidden overflow-ellipsis whitespace-nowrap flex-grow text-text-300",children:o?(0,a.jsx)(l.N,{children:g}):g})]}),(0,a.jsx)("div",{className:"flex flex-row items-center gap-1.5 min-w-0 shrink-0",children:u?(0,a.jsx)(r.Tooltip,{tooltipContent:f,align:"center",children:(0,a.jsx)("span",{className:"inline-flex",children:(0,a.jsx)(n.N5l,{size:16,className:"text-danger-000"})})}):(0,a.jsxs)(a.Fragment,{children:[!!C&&(0,a.jsx)("p",{className:"relative bottom-[0.5px] pl-1 text-text-500 font-small leading-tight shrink-0 whitespace-nowrap",children:C}),x]})})]},o?"streaming":"non-streaming"),w]});return _===m.l.TimelineGroup?(0,a.jsx)(p.i1,{icon:h,isExpanded:i,isFirstItem:!!k,isLastItem:!!N,isActive:o&&j&&N,children:S}):(0,a.jsx)(c.P.div,{initial:{opacity:+!o},animate:{opacity:1},transition:{duration:.5,ease:"easeIn"},className:(0,d.A)("ease-out rounded-lg border-0.5 flex flex-col font-ui leading-normal my-3 border-border-300 min-h-[2.625rem]",!s&&!i&&"hover:bg-bg-200",v?"mt-2":"mt-3",j?"mb-2":"mb-3",i&&"bg-bg-000 shadow-sm",y),children:S})},g=e=>{let{isExpandingDisabled:t,setIsExpanded:s,...i}=e,{isExpanded:l,isError:r,secondaryIcon:o}=i,c=t||r;return(0,a.jsx)(h,{...i,isError:r,isDisabled:c,handleClick:()=>s(!l),secondaryIcon:(0,a.jsxs)(a.Fragment,{children:[o,!c&&(0,a.jsx)("span",{className:(0,d.A)("inline-flex transition-transform duration-400 ease-snappy-out",l?"rotate-180":"rotate-0"),children:(0,a.jsx)(n.biH,{className:(0,d.A)("relative bottom-[0.5px] text-text-300",c&&"opacity-15"),size:16})})]})})}},99427:(e,t,s)=>{s.d(t,{bl:()=>r});var a=s(44894),n=s(3194),i=s(2327);function l(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"quick_entry_image",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=atob(e),l=new Uint8Array(i.length);for(let e=0;e<i.length;e++)l[e]=i.charCodeAt(e);let r=n||a._F[t]||"png";return new File([l],"".concat(s,".").concat(r),{type:t})}async function r(e,t,s,r,o){let d=o?o.split(".")[0]:o,c=o?o.split(".")[1]:o;if(d&&c){let r=l(e,t,d,c),o={orgUuid:s,projectUuid:void 0,conversationUuid:i.T.current,modelConfig:{image_in:!0,pdf_in:!0},featureGates:{janus_claude_ai:!0,ooc_attachments:!0,use_canvas_resize:!0,wiggleEnabled:!0},limits:a.XA};return[await (0,n.gs)(r,o)]}let u=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"quick_entry_image",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=l(e,t,s,a),i=new FormData;return i.append("file",n),i}(e,t,d,c),m=await r("/api/".concat(s,"/upload"),{method:"POST",body:u});if(m.ok)return[await m.json()];throw Error("Failed to upload image: ".concat(m.status," ").concat(m.statusText))}}}]);