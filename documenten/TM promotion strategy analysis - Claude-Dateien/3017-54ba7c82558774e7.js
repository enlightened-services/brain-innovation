"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3017],{16304:(e,t,a)=>{a.d(t,{V:()=>r});var n=a(7620),s=a(88769),i=a(24423);function r(e,t,a){let r=(0,i.Gu)(),{clearAllFeatures:l}=(0,s.Bk)();(0,n.useLayoutEffect)(()=>(a||r(e,t),()=>{l()}),[e,t,a,r,l])}},23017:(e,t,a)=>{a.d(t,{ChatClientPage:()=>Q});var n=a(54568),s=a(19736),i=a(47592),r=a(18849),l=a(58841),u=a(64328),o=a(41473);function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;if(e.length<=t)return e;let a=Math.ceil(t/2);return"".concat(e.substring(0,a),"\n\n  [...]\n\n  ").concat(e.substring(e.length-a))}var c=a(7620),m=a(96614),g=a(68704),f=a(74813),p=a(98944),v=a(27541),h=a(55188),_=a(23812),x=a(3075),y=a(10369),b=a(59666),j=a(1230),S=a(45271),k=a(13750),M=a(17300),C=a(859),w=a(91667),N=a(26334),E=a(72902);function z(e){let{fieldName:t,fieldSchema:a,isRequired:s,initialValue:i,hasSubmitError:r,clearSubmitError:l}=e,u=(0,y.A)(),[o,d]=(0,c.useState)(i),[m,g]=(0,c.useState)(r?L(o,a,s,u):null),f=(0,c.useCallback)(()=>{g(null),null==l||l(t)},[l,t]),p=(0,c.useCallback)(()=>{g(L(o,a,s,u))},[o,a,s,u]),v=a.type,h=a.title||a.description||t.charAt(0).toUpperCase()+t.slice(1),_=a.title&&a.description,x=(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{children:h}),s&&(0,n.jsx)("span",{className:"text-danger-000",children:"*"})]}),b=e=>(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)(C.J,{label:x,className:"font-medium"}),_&&(0,n.jsx)("p",{className:"text-xs text-text-300 mb-1",children:a.description}),e,m&&(0,n.jsx)("p",{className:"text-xs text-danger-000 mt-1",children:m})]});switch(v){case"boolean":return(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)("input",{type:"hidden",name:t,value:o?"true":""}),(0,n.jsx)(M.S,{label:x,checked:!!o,onChange:e=>d(e),onFocus:f,onBlur:p,size:16,className:m?"border-danger-000":""}),_&&(0,n.jsx)("p",{className:"text-xs text-text-300 ml-[28px]",children:a.description}),m&&(0,n.jsx)("p",{className:"text-xs text-danger-000 ml-[28px]",children:m})]});case"number":return b((0,n.jsx)(k.ks,{name:t,type:"number",value:String(null!=o?o:""),onValueChange:e=>{if(!e)return void d("");let t=Number(e);isNaN(t)||d(t)},onFocus:f,onBlur:p,error:!!m,size:"lg",min:a.minimum,max:a.maximum,step:"any"}));case"integer":return b((0,n.jsx)(k.ks,{name:t,type:"number",value:String(null!=o?o:""),onValueChange:e=>{if(!e)return void d("");let t=Number(e);!isNaN(t)&&Number.isInteger(t)&&d(t)},onKeyDown:e=>{("."===e.key||"e"===e.key||"E"===e.key)&&e.preventDefault()},onFocus:f,onBlur:p,error:!!m,size:"lg",min:a.minimum,max:a.maximum,step:1}));case"string":{if(a.enum){let e=a.enum,s=a.enumNames;return b((0,n.jsxs)(w.l,{name:t,value:String(null!=o?o:""),onChange:e=>d(e.target.value),onFocus:f,onBlur:p,variant:m?"danger":"outline",size:"lg",children:[(0,n.jsx)("option",{value:""}),e.map((e,t)=>(0,n.jsx)("option",{value:String(e),children:(null==s?void 0:s[t])||String(e)},t))]}))}let e=a.minLength,s=a.maxLength,i=a.format;if(s&&s>500)return b((0,n.jsx)(k.fs,{name:t,value:String(null!=o?o:""),onChange:e=>d(e.target.value),onFocus:f,onBlur:p,rows:3,className:m?"border-danger-000":"",minLength:e,maxLength:s}));if(!i||"email"===i)return b((0,n.jsx)(k.ks,{name:t,value:String(null!=o?o:""),onValueChange:e=>d(null!=e?e:""),onFocus:f,onBlur:p,error:!!m,size:"lg",type:null!=i?i:"text",minLength:e,maxLength:s}));return b((0,n.jsx)("input",{name:t,type:i,value:String(null!=o?o:""),onChange:e=>d(e.target.value),onFocus:f,onBlur:p,className:(0,E.A)((0,N.j)({size:"lg",error:!!m})),minLength:e,maxLength:s}))}default:return null}}function L(e,t,a,n){if(a){if("boolean"===t.type){if(!0!==e)return n.formatMessage({defaultMessage:"This field must be checked.",id:"J5kfUK4Fet"})}else if(null==e||""===e||"string"==typeof e&&!e.trim())return n.formatMessage({defaultMessage:"This field is required.",id:"6B5JtuWEoY"})}if(null==e||""===e)return null;if("string"===t.type){let a=String(e);if("minLength"in t){let e=t.minLength;if(a.length<e)return n.formatMessage({defaultMessage:"Must be at least {min} characters.",id:"6JNvt/A47+"},{min:e})}if("maxLength"in t){let e=t.maxLength;if(a.length>e)return n.formatMessage({defaultMessage:"Must be at most {max} characters.",id:"oVARYXBJid"},{max:e})}if("pattern"in t&&!new RegExp(t.pattern).test(a))return n.formatMessage({defaultMessage:"Invalid format.",id:"vChcf7nVHS"});if("format"in t){let e=t.format;if("email"===e&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a))return n.formatMessage({defaultMessage:"Invalid email address.",id:"cpZU48Uo5t"});if("uri"===e)try{new URL(a)}catch(e){return n.formatMessage({defaultMessage:"Invalid URL.",id:"ZtqJIdqRiK"})}if("date"===e&&isNaN(new Date(a).getTime()))return n.formatMessage({defaultMessage:"Invalid date.",id:"bnRxzOhnEE"});if("date-time"===e&&isNaN(new Date(a).getTime()))return n.formatMessage({defaultMessage:"Invalid date and time.",id:"HTTZjKGN9a"})}}if("number"===t.type||"integer"===t.type){let a=Number(e);if(isNaN(a))return n.formatMessage({defaultMessage:"Must be a valid number.",id:"Z8e10tpxeL"});if("integer"===t.type&&!Number.isInteger(a))return n.formatMessage({defaultMessage:"Must be a whole number.",id:"5kFFmX4YGx"});if("minimum"in t){let e=t.minimum;if(a<e)return n.formatMessage({defaultMessage:"Must be at least {min}.",id:"85q0hz8G+z"},{min:e})}if("maximum"in t){let e=t.maximum;if(a>e)return n.formatMessage({defaultMessage:"Must be at most {max}.",id:"HrCLJ+XSxg"},{max:e})}}return null}function A(){let e=(0,y.A)(),t=(0,j.c)(e=>e.currentRequest),{acceptElicitation:a,declineElicitation:s,cancelElicitation:i}=(0,j.c)(),[r,l]=(0,c.useState)(new Set),u=(0,c.useMemo)(()=>{if(!t)return{};let e={};return Object.entries(t.request.params.requestedSchema.properties).forEach(t=>{let[a,n]=t;"default"in n&&void 0!==n.default&&(e[a]=n.default)}),e},[t]),o=(0,c.useCallback)(n=>{if(n.preventDefault(),!t)return;let s=n.currentTarget,i=new FormData(s),r={},u=new Set,o=t.request.params.requestedSchema;if(Object.entries(o.properties).forEach(t=>{var a,n;let[s,l]=t,d=i.get(s),c=d;"number"===l.type||"integer"===l.type?c=""===d||null===d?void 0:Number(d):"boolean"===l.type&&(c="true"===d),r[s]=c,L(c,l,null!=(n=null==(a=o.required)?void 0:a.includes(s))&&n,e)&&u.add(s)}),u.size>0){l(u);let e=Array.from(u)[0],t=s.querySelector('[name="'.concat(e,'"]'));null==t||t.scrollIntoView({behavior:"smooth",block:"center"});return}a(r),l(new Set)},[t,a,e]),d=(0,c.useCallback)(()=>{s(),l(new Set)},[s]),m=(0,c.useCallback)(()=>{i(),l(new Set)},[i]),g=(0,c.useCallback)(e=>()=>{l(t=>{let a=new Set(t);return a.delete(e),a})},[]);if(!t)return null;let{request:f,serverName:p,iconType:v,iconSrc:h}=t,k=f.params.requestedSchema,M=(0,n.jsx)(S.z,{size:30,imageSize:20,name:p,type:v,src:h});return(0,n.jsx)(x.aF,{title:"".concat(p," requests your input"),icon:M,isOpen:null!==t,onClose:m,modalSize:"lg",children:(0,n.jsxs)("form",{onSubmit:o,children:[(0,n.jsx)("div",{className:"py-4",children:(0,n.jsxs)("div",{className:"flex flex-col gap-4 max-h-[500px] overflow-y-auto p-2",children:[f.params.message&&(0,n.jsx)("p",{className:"text-sm text-text-300",children:f.params.message}),Object.entries(k.properties).map(e=>{var t,a;let[s,i]=e;return(0,n.jsx)(z,{fieldName:s,fieldSchema:i,isRequired:null!=(a=null==(t=k.required)?void 0:t.includes(s))&&a,initialValue:u[s],hasSubmitError:r.has(s),clearSubmitError:g},s)})]})}),(0,n.jsxs)(x.vW,{children:[(0,n.jsx)(_.$,{type:"button",onClick:d,variant:"secondary",children:(0,n.jsx)(b.A,{defaultMessage:"Decline",id:"pvtgR26QWY"})}),(0,n.jsx)(_.$,{type:"submit",variant:"primary",children:(0,n.jsx)(b.A,{defaultMessage:"Submit",id:"wSZR47Y5kj"})})]})]})})}var I=a(47606),R=a(55442),q=a(24423),F=a(88123),T=a(69351),D=a(1613),U=a(35984),O=a(16178),V=a(80688),B=a(8019),P=a(4869);function Y(e){var t,a,i,r;let{conversation:l,conversationUuid:_,chatInputDefaultMessage:x}=e,y=(0,v.useRouter)(),{incognitoModeEnabled:b}=(0,h.S)(),{track:j}=(0,f.st)(),{data:S,isLoading:k,isRefetching:M,isPlaceholderData:C}=(0,s.Bq)(_,{suppressError:!0}),w=(0,c.useMemo)(()=>{if((null==S?void 0:S.danglingHumanMessages)&&S.danglingHumanMessages.length>0)return S.danglingHumanMessages[S.danglingHumanMessages.length-1]},[S]),N=null==S?void 0:S.project_uuid,E=(0,q.gq)(),z=(0,q.xw)(_),{changeDisplayedConversationPath:L}=(0,g.G)(),Y=(0,m.Z3)(_),G=(0,T.n)(null==S||null==(t=S.settings)?void 0:t.enabled_mcp_tools,null==l?void 0:l.project_uuid),{markFirstTokenReceived:K}=(0,R.B)(),Q=(0,c.useCallback)(()=>{K({model:Y,integrations:function(e){if(!e)return"";let t=[];return Object.entries(e).forEach(e=>{var a,n;let[s,i]=e,r="enabled_mcp_tools"===s&&!("object"!=typeof i||null===i||Array.isArray(i))&&Object.values(i).every(e=>"boolean"==typeof e),l="paprika_mode"===s&&"string"==typeof(a=i)&&"extended"===a,u="compass_mode"===s&&"string"==typeof(n=i)&&"advanced"===n;r?Object.entries(i).forEach(e=>{let[a,n]=e;n&&t.push(a)}):l?t.push("enabled_paprika"):u?t.push("enabled_compass"):"boolean"==typeof i&&i&&t.push(s)}),t.join(",")}(null==S?void 0:S.settings)})},[K,Y,null==S?void 0:S.settings]);(0,c.useEffect)(()=>{if(!b||!(null==S?void 0:S.updated_at))return;let e=()=>{let e=new Date(S.updated_at).getTime();(Date.now()-e)/36e5>=47&&y.push("/new")};return window.addEventListener("focus",e),()=>{window.removeEventListener("focus",e)}},[b,null==S?void 0:S.updated_at,y]);let[H,J]=(0,c.useState)(),Z=(0,c.useCallback)(e=>{J(e)},[J]),[W,X]=(0,c.useState)(0),$=(0,c.useCallback)(e=>{X(e)},[]),ee=(0,m.Gw)(_,N,G,Q,E,$),et=(0,m.SL)(_,N,G,H,Q,E,$),{mutate:ea}=(0,s.lj)(_),en=ee.isStreaming||et.isStreaming,es=(0,c.useCallback)(async e=>(X(0),ee.runStream(e)),[ee]),ei=(0,c.useCallback)(async(e,t,a,n)=>(X(0),et.runStream(e,t,a,n)),[et]);!function(e,t){var a;let[n,i]=(0,c.useState)(!1),{activeOrganization:r}=(0,u.YL)(),l=null==e?void 0:e.name,m=(null==e||null==(a=e.chat_messages)?void 0:a.length)||0,g=(0,c.useMemo)(()=>{var t;let a=null==e||null==(t=e.chat_messages)?void 0:t[0];return a?(0,o.C)(a):""},[null==e?void 0:e.chat_messages]),f=(0,c.useMemo)(()=>{var a;if(g)return g;let n=(null==e||null==(a=e.chat_messages)?void 0:a[1])?(0,o.C)(e.chat_messages[1]):"";return n&&!t?["Message 1:",d(g),"Message 2:",d(n)].join("\n\n"):""},[null==e?void 0:e.chat_messages,t,g]),p=(null==e?void 0:e.uuid)||"",{mutate:v}=(0,s.HI)(p),{mutate:h,error:_}=(0,s.OZ)(p),x=(0,c.useRef)(!1);(0,c.useEffect)(()=>{if(_&&!l&&g){if(x.current)return;let e=g.slice(0,30),t=g.length>30?"...":"";x.current=!0,v({name:"".concat(e).concat(t)})}},[_,l,f,v,g]),(0,c.useEffect)(()=>{r&&!n&&!l&&0!==m&&f&&(i(!0),h({message_content:f,recent_titles:[]}))},[r,l,h,n,m,f])}(S,en);let er=null==(a=(0,q.Q3)(_))?void 0:a.uuid,el=(0,c.useCallback)(async(e,t)=>{var a,n;let s=(0,o.C)(e);s!==t&&(j({event_key:"claudeai.message.edited",is_last_human_message:e.uuid===er,is_identical_content:s===t}),await es({prompt:t,attachments:e.attachments,files:null!=(n=e.files_v2)?n:e.files,syncSources:e.sync_sources,parent_message_uuid:e.parent_message_uuid,personalized_style:H,compass_mode:null==(a=e.metadata)?void 0:a.compass_mode}))},[es,H,j,er]),eu=(0,c.useCallback)((e,t)=>{j({event_key:"claudeai.conversation_tree.navigated",direction:1===t?"next":"previous",is_last_human_message:e.uuid===er}),L(_,e,t,e=>ea({current_leaf_message_uuid:e}))},[L,_,ea,j,er]),{hasPendingUserMessage:eo,isCompletionStatusLoading:ed,stopPendingRecovery:ec}=function(e){let{conversationUuid:t,pendingUserMessage:a,chatConversationTree:n,isLoading:s}=e,i=(0,c.useRef)(!1),r=(0,c.useRef)(null),l=(0,c.useRef)(null),o=(0,c.useRef)(null),d=(0,q.uQ)(),g=(0,q.Gu)(),f=(0,q.RR)(),{activeOrganization:p}=(0,u.YL)(),{addError:v}=(0,U.Y)(),{setFailedStreamRetryData:h}=(0,m.x)(),_=(0,P.useQueryClient)(),[x,y]=(0,c.useState)(!1),[b,j]=(0,c.useState)(!1),{data:S,isLoading:k}=(0,D.Sk)((null==p?void 0:p.uuid)&&t&&a?"/api/organizations/".concat(p.uuid,"/chat_conversations/").concat(t,"/completion_status?poll=false"):"",{enabled:!!(null==p?void 0:p.uuid)&&!!t&&!s&&!!a&&!i.current,staleTime:0,refetchOnWindowFocus:!1}),M=(0,c.useCallback)(()=>{var e;a&&h({prompt:(null!=(e=a.content)?e:[]).filter(e=>"text"===e.type).map(e=>e.text).join(""),attachments:a.attachments||[],files:a.files_v2||[]})},[a,h]),C=(0,c.useCallback)(()=>{l.current&&(l.current.abort(),l.current=null),o.current&&(clearTimeout(o.current),o.current=null)},[]),w=(0,c.useCallback)(()=>{let e=f(t),n=e.filter(e=>e.uuid!==(null==a?void 0:a.uuid)&&e.uuid!==r.current);n.length!==e.length&&g(t,n)},[t,f,null==a?void 0:a.uuid,g]),N=(0,c.useCallback)((e,t)=>{w(),M();let a=e||"Message failed. Please try again.";v(a,{error:new O.LG(a,t||"completion_error",500,{}),errorContext:{tags:{source:"pending_message_recovery"}}})},[w,M,v]),E=(0,c.useCallback)(()=>{if(!(null==p?void 0:p.uuid)||!t||!a)return;j(!0),l.current=new AbortController;let e=0,n=async()=>{var a,s,i;if(e>=10||(null==(a=l.current)?void 0:a.signal.aborted))return void j(!1);e++;try{let e=await fetch("/api/organizations/".concat(p.uuid,"/chat_conversations/").concat(t,"/completion_status?poll=true"),{method:"GET",credentials:"include",signal:null==(s=l.current)?void 0:s.signal});if(!e.ok)return void j(!1);let a=await e.json();a.is_pending?(null==(i=l.current)?void 0:i.signal.aborted)||(o.current=setTimeout(()=>void n(),2e3)):(y(!1),j(!1),w(),a.is_error&&N(a.error_detail,a.error_code),await _.invalidateQueries({queryKey:[V.fC,{orgUuid:p.uuid},{uuid:t}]}))}catch(e){j(!1)}};n()},[null==p?void 0:p.uuid,t,a,_,N,w]);return(0,c.useEffect)(()=>{if(!s&&!i.current&&a&&n&&void 0!==S){if(i.current=!0,S.is_error)N(S.error_detail,S.error_code);else if(S.is_pending){y(!0);let e=(0,B.b)();r.current=e;let n={uuid:e,sender:"assistant",content:[{type:"text",text:""}],created_at:new Date().toISOString(),updated_at:new Date().toISOString(),parent_message_uuid:a.uuid,attachments:[],files:[],files_v2:[],sync_sources:[],index:1,metadata:{is_resume_completion_placeholder_message:!0}};d(t,[a,n]),E()}}},[s,a,n,S,N,d,t,E]),(0,c.useEffect)(()=>()=>{C()},[C]),{hasPendingUserMessage:x,isCompletionStatusLoading:!!a&&k&&!b,stopPendingRecovery:()=>j(!1)}}({conversationUuid:_,chatConversationTree:S,pendingUserMessage:w,isLoading:k});S||k||C||(0,v.notFound)();let em=(0,c.useMemo)(()=>(null==S?void 0:S.settings)||{},[null==S?void 0:S.settings]);return(0,n.jsxs)(p.N,{settings:em,children:[(0,n.jsx)(F.v,{isStreaming:en||eo,isTemporary:!!(null==l?void 0:l.is_temporary),chatInputDefaultMessage:x,conversationTitle:l?"".concat(l.name," - Claude"):"Claude",conversationUuid:_,isLoading:k||!S&&M||ed,messageUuids:z,name:null!=(r=null!=(i=null==S?void 0:S.name)?i:null==l?void 0:l.name)?r:"Untitled Chat",onSend:es,onRetry:ei,projectUuid:N,changeDisplayedConversationPath:eu,editMessage:el,setPersonalizedStyleCallback:Z,retryCount:W,onStopSampling:eo?ec:void 0}),(0,I.F)()&&(0,n.jsx)(A,{})]})}var G=a(71302),K=a(16304);function Q(e){var t;let{uuid:a,q:u}=e,{data:o,currentPath:d,isLoading:c}=(0,s.Bq)(a);return(0,i.K7)(null!=(t=null==o?void 0:o.name)?t:""),(0,K.V)(a,d||[],c),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.u,{conversationUuid:a,children:(0,n.jsx)(r._,{conversationUuid:a,children:(0,n.jsx)(Y,{conversation:o,conversationUuid:a,chatInputDefaultMessage:u})})}),(0,n.jsx)(G.PaymentVerificationModal,{})]})}},71302:(e,t,a)=>{a.r(t),a.d(t,{PaymentVerificationModal:()=>v});var n=a(54568),s=a(74813),i=a(44995),r=a(64328),l=a(35984),u=a(77223),o=a(26819),d=a(3075),c=a(4869),m=a(7620),g=a(59666),f=a(48579),p=a(89060);function v(){let[e,t]=(0,m.useState)(!1),a=(0,s.st)(),{activeOrganization:v}=(0,r.YL)(),{addError:h,addSuccess:_}=(0,l.Y)(),x=(0,i._r)(),y=(0,c.useQueryClient)(),{shouldShowModal:b,dismissReminder:j}=(0,p.F)(),S=(0,f.Si)({onSuccess:async e=>{try{var s,i;let t=await (0,u.nW)(e.entity,x);if(!t)throw Error("Stripe failed to initialize");let r=await t.retrieveSetupIntent(e.clientSecret);if(r.error)throw Error(r.error.message);if((null==(s=r.setupIntent)?void 0:s.status)==="requires_action"){let a=await t.handleNextAction({clientSecret:e.clientSecret});if(a.error)throw Error(a.error.message)}else(null==(i=r.setupIntent)?void 0:i.status)==="succeeded"&&a.track({event_key:"payment_modal_open",organization_id:null==v?void 0:v.uuid,action:"verify_3ds_success_frictionless"});await y.invalidateQueries({queryKey:["check-3ds-required",null==v?void 0:v.uuid]}),a.track({event_key:"payment_modal_open",organization_id:null==v?void 0:v.uuid,action:"verify_3ds_success"}),_((0,n.jsx)(g.A,{defaultMessage:"Payment method verified successfully",id:"vRXoCh/o7W"})),a.track({event_key:"payment_modal_open",organization_id:null==v?void 0:v.uuid,action:"verify_3ds_success"})}catch(e){h(e instanceof Error?"PAYMENT_VERIFICATION_FAILED"===e.message?(0,n.jsx)(g.A,{defaultMessage:"Payment verification failed",id:"9RpX03Q2ky"}):e.message.includes("Failed to redirect to https://hooks.stripe.com")||e.message.includes("3d_secure")||e.message.includes("hooks.stripe.com")?(0,n.jsx)(g.A,{defaultMessage:"Unable to complete payment verification. Check if pop-ups are blocked or try a different browser.",id:"sDFdJ5I8X1"}):e.message:(0,n.jsx)(g.A,{defaultMessage:"Payment verification failed. Please try again.",id:"0kXa3Rf5bZ"}),{error:e,errorContext:{tags:{source:"payment_verification"}}}),a.track({event_key:"payment_modal_open",organization_id:null==v?void 0:v.uuid,action:"verify_3ds_error",error_message:e instanceof Error?e.message:"Unknown error"})}finally{t(!1)}},onError:e=>{t(!1),h((0,n.jsx)(g.A,{defaultMessage:"Failed to start verification process. Please try again.",id:"3dT/r8rV5S"}),{error:e}),a.track({event_key:"payment_modal_open",organization_id:null==v?void 0:v.uuid,action:"verify_3ds_api_error",error_message:e.message})}}),k=()=>{j()};return b?(0,n.jsx)(d.aF,{isOpen:b,onClose:k,modalSize:"md",hasCloseButton:!0,title:(0,n.jsx)("div",{className:"flex items-center gap-2",children:(0,n.jsx)(o.E,{color:"secondary",size:"lg",children:(0,n.jsx)(g.A,{defaultMessage:"Action Required",id:"jWgFDt2Ifa"})})}),children:(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("h2",{className:"text-3xl font-medium text-text-100 mb-3",children:(0,n.jsx)(g.A,{defaultMessage:"Verify your payment method",id:"epYApo9bIj"})}),(0,n.jsx)("p",{className:"text-text-200 mb-6",children:(0,n.jsx)(g.A,{defaultMessage:"To comply with European security regulations, we need to verify your payment method using a quick one-time security process. This ensures your subscription remains active and secure.",id:"K0hDpiUx0B"})}),(0,n.jsxs)("div",{className:"flex flex-col gap-2 mt-6",children:[(0,n.jsx)(d.yl,{onClick:()=>{t(!0),a.track({event_key:"payment_modal_open",organization_id:null==v?void 0:v.uuid,action:"verify_3ds_start"});let e=window.location.href;S.mutate({return_url:e})},loading:e,className:"w-full",children:(0,n.jsx)(g.A,{defaultMessage:"Verify now",id:"t28SE7zKVA"})}),(0,n.jsx)(d.yl,{variant:"secondary",onClick:k,className:"w-full",children:(0,n.jsx)(g.A,{defaultMessage:"Remind me later",id:"c4hRLOnYpQ"})})]})]})}):null}},89060:(e,t,a)=>{a.d(t,{F:()=>o});var n=a(74813),s=a(64328),i=a(68067),r=a(7620),l=a(48579);let u="payment-verification-reminder-dismissed";function o(){let{activeOrganization:e}=(0,s.YL)(),t=(0,n.st)(),[a,o]=(0,r.useState)(!1),d=(0,i.fS)("show_3ds_modal"),{data:c}=(0,l.PI)(d);return(0,r.useEffect)(()=>{var a;let n=localStorage.getItem(u);if(n){let e=new Date(n).getTime();if(new Date().getTime()-e<864e5)return void o(!1)}let s=d&&null!=(a=null==c?void 0:c.requires_3ds_verification)&&a;o(s),s&&t.track({event_key:"payment_modal_open",organization_id:null==e?void 0:e.uuid,modal_type:"3ds_verification_required"})},[d,c,t,e]),{shouldShowModal:a,dismissReminder:(0,r.useCallback)(()=>{let a=new Date().toISOString();localStorage.setItem(u,a),o(!1),t.track({event_key:"payment_modal_open",organization_id:null==e?void 0:e.uuid,action:"3ds_verification_dismissed",dismissed_at:a})},[t,e])}}}}]);