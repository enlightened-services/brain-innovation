"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8579],{19723:(e,i,n)=>{n.d(i,{b:()=>u});var t=n(28),a=n(7620),r=n(64328);function u(e){let{account:i,activeOrganization:n}=(0,r.YL)();return(0,a.useMemo)(()=>(0,t.yI)(i,n,e),[i,n,e])}},28122:(e,i,n)=>{n.d(i,{NW:()=>t,un:()=>a});var t=function(e){return e.MONTHLY="monthly",e.YEARLY="yearly",e}({}),a=function(e){return e.FIVE_X="max_5x",e.TWENTY_X="max_20x",e}({})},48579:(e,i,n)=>{n.d(i,{$0:()=>w,C:()=>F,Cm:()=>el,Ew:()=>Y,Gs:()=>H,If:()=>ev,Jh:()=>S,L3:()=>D,Le:()=>h,N_:()=>eu,Nb:()=>q,PI:()=>ea,PQ:()=>Q,Pz:()=>b,Qn:()=>k,SR:()=>R,Si:()=>er,UK:()=>ee,Uu:()=>I,V9:()=>B,VK:()=>Z,Xi:()=>O,Xt:()=>K,ZA:()=>j,_D:()=>ei,a1:()=>A,bE:()=>W,bF:()=>E,bt:()=>P,c:()=>G,cR:()=>$,cg:()=>U,e0:()=>z,fS:()=>et,h:()=>em,ib:()=>ec,jH:()=>es,jN:()=>T,kg:()=>X,lG:()=>M,ls:()=>ey,mU:()=>e_,mv:()=>ep,nc:()=>L,p$:()=>ed,rB:()=>en,sd:()=>J,uS:()=>V,wu:()=>N,xy:()=>eo,yS:()=>x});var t=n(1613),a=n(44995),r=n(64328),u=n(35984),l=n(77223),s=n(19723),o=n(16178),d=n(80688),c=n(28),y=n(4869),_=n(7620),v=n(28122),p=n(91870),m=n(70803),g=n(13644),f=n(40459);function b(e){let{onSuccess:i,onError:n}=e,{activeOrganization:a}=(0,r.YL)(),{data:u,variables:l,...s}=(0,t.L2)("/api/billing/".concat(null==a?void 0:a.uuid,"/consumer_pricing"),"POST",{enabled:!!a,meta:{noToast:!0},onError:n,onSuccess:i}),[o,d]=(0,_.useState)(),[c,y]=(0,_.useState)();return(0,_.useEffect)(()=>{u&&(d(u),y(l))},[u,l]),{data:o,variables:c,...s}}function S(e){let{onError:i}=e,{activeOrganization:n}=(0,r.YL)(),{data:a,variables:u,...l}=(0,t.L2)("/api/billing/".concat(null==n?void 0:n.uuid,"/cw_pricing"),"POST",{enabled:!!n,meta:{noToast:!0},onError:i}),[s,o]=(0,_.useState)(),[d,c]=(0,_.useState)();return(0,_.useEffect)(()=>{a&&(o(a),c(u))},[a,u]),{data:s,variables:d,...l}}function h(){var e,i,n,a;let{onSuccess:u,onError:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:s}=(0,r.YL)(),[o,d]=(0,_.useState)(null),[c,y]=(0,_.useState)(),{data:p,isPending:m,error:g,mutate:f}=(0,t.L2)("/api/billing/".concat(null==s?void 0:s.uuid,"/individual_plan_pricing/v2"),"POST",{enabled:!!s,meta:{noToast:!0},onError:l,onSuccess:u});(0,_.useEffect)(()=>{p&&y(p)},[p]);let b=c||p,S=b&&{country:b.country,currency:b.currency,price:null==(e=b.product_prices_per_billing_period)?void 0:e.max_5x_monthly,planType:v.un.FIVE_X},h=b&&{country:b.country,currency:b.currency,price:null==(i=b.product_prices_per_billing_period)?void 0:i.max_20x_monthly,planType:v.un.TWENTY_X},Q=b&&{country:b.country,currency:b.currency,price:null==(n=b.product_prices_due_today)?void 0:n.max_5x_monthly,planType:v.un.FIVE_X};return{fiveXPricing:S,twentyXPricing:h,fiveXPricingProrated:Q,twentyXPricingProrated:b&&{country:b.country,currency:b.currency,price:null==(a=b.product_prices_due_today)?void 0:a.max_20x_monthly,planType:v.un.TWENTY_X},isPending:m,error:g,fetchAllPricing:(0,_.useCallback)(e=>{d(e),e.noCache&&y(void 0),f(e)},[f]),addressParams:o}}let Q=()=>{let{activeOrganization:e}=(0,r.YL)();return(0,t.L2)("/api/organizations/".concat(null==e?void 0:e.uuid,"/subscription"),"PUT",{enabled:!!e})},q=()=>{let{activeOrganization:e}=(0,r.YL)();return(0,t.L2)("/api/organizations/".concat(null==e?void 0:e.uuid,"/subscription/verify-payment"),"POST",{enabled:!!e})},K=()=>{let{activeOrganization:e}=(0,r.YL)();return(0,t.L2)("/api/organizations/".concat(null==e?void 0:e.uuid,"/subscription/cw"),"PUT",{enabled:!!e})};function L(){let{activeOrganization:e}=(0,r.YL)();return(0,t.Sk)("/api/organizations/".concat(null==e?void 0:e.uuid,"/payment_method"),{enabled:!!e,queryKey:["payment-method",null==e?void 0:e.uuid],staleTime:9e5})}function T(e){var i;let{activeOrganization:n}=(0,r.YL)(),a=(0,r.h0)();return(0,t.Sk)("/api/organizations/".concat(null==n?void 0:n.uuid,"/subscription_details"),{queryKey:[d.Gn,null==n?void 0:n.uuid],staleTime:0,initialData:null==e?void 0:e.initialData,refetchOnMount:null==e||!e.forceRefetch||"always",enabled:!!n&&a&&(null==(i=null==e?void 0:e.enabled)||i),meta:{noToast:e=>e instanceof o.LG&&404===e.statusCode}})}function w(e){var i;let{activeOrganization:n}=(0,r.YL)();return(0,t.Sk)("/api/organizations/".concat(null==n?void 0:n.uuid,"/paused_subscription_details"),{queryKey:[d.dZ,null==n?void 0:n.uuid],enabled:!!n&&(null==(i=null==e?void 0:e.enabled)||i),meta:{noToast:e=>e instanceof o.LG&&404===e.statusCode}})}function Y(e){var i;let{activeOrganization:n}=(0,r.YL)();return(0,t.Sk)("/api/organizations/".concat(null==n?void 0:n.uuid,"/trial_status"),{queryKey:[d.nb,null==n?void 0:n.uuid],enabled:!!n&&(null==(i=null==e?void 0:e.enabled)||i),meta:{noToast:e=>e instanceof o.LG&&404===e.statusCode}})}function P(){let{activeOrganization:e}=(0,r.YL)(),i=(0,y.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(null==e?void 0:e.uuid,"/acknowledge_trial_end"),"POST",{enabled:!!e,meta:{noToast:!0},onSuccess:()=>{i.setQueryData([d.nb,null==e?void 0:e.uuid],e=>{if(e)return{...e,trial_end_requires_action:!1}})}})}let z=function(e,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{addError:t}=(0,u.Y)(),a=(0,y.useQueryClient)(),r=(0,p.UV)(e,{...n,async onSuccess(u,l,s){var o;if("payment_intent_client_secret"in u){let e=await i;if(!e)return void t("Stripe failed to initialize. You can try again.");let n=await e.confirmPayment({clientSecret:u.payment_intent_client_secret,redirect:"if_required"});return n.error?void t("Payment confirmation failed. You can try again.",{error:n.error}):void r.mutate(l)}a.invalidateQueries({queryKey:[d.MJ,e]}),a.invalidateQueries({queryKey:[d._S,e]}),await (null==(o=n.onSuccess)?void 0:o.call(n,u,l,s))}});return r},M=function(e,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{addError:t}=(0,u.Y)(),a=(0,y.useQueryClient)(),r=(0,p.tH)(e,{...n,async onSuccess(u,l,s){var o;if("payment_intent_client_secret"in u){let e=await i;if(!e)return void t("Stripe failed to initialize. You can try again.");let n=await e.confirmPayment({clientSecret:u.payment_intent_client_secret,redirect:"if_required"});return n.error?void t("Payment confirmation failed. You can try again.",{error:n.error}):void r.mutate(l)}a.invalidateQueries({queryKey:[d.MJ,e]}),a.invalidateQueries({queryKey:[d._S,e]}),await (null==(o=n.onSuccess)?void 0:o.call(n,u,l,s))}});return r};function C(){let{activeOrganization:e}=(0,r.YL)(),i=(0,r.mV)();return f.env.NEXT_PUBLIC_DISABLE_PAYMENTS?{data:{status:"active",cancel_at_ts:null},isLoading:!1}:(0,t.Sk)("/api/organizations/".concat(null==e?void 0:e.uuid,"/subscription_status"),{queryKey:[d._S,null==e?void 0:e.uuid],staleTime:0,enabled:!!e&&i,meta:{noToast:e=>e instanceof o.LG&&404===e.statusCode}})}function U(){let{data:e,isLoading:i}=C();return{isRavenTrialing:(null==e?void 0:e.status)==="trialing",isLoading:i}}function E(){let{data:e,isLoading:i}=C();return{isRavenCanceled:(null==e?void 0:e.status)==="canceled"||(null==e?void 0:e.status)==="unpaid",isLoading:i}}function k(){let{data:e,isLoading:i}=C();return{isRavenPastDue:(null==e?void 0:e.status)==="past_due",isLoading:i}}function G(){let{data:e,isLoading:i}=C();return{isRavenPendingCancellation:!!(null==e?void 0:e.cancel_at_ts),isLoading:i}}function x(){let{activeOrganization:e}=(0,r.YL)(),{isRavenCanceled:i,isLoading:n}=E(),{isRavenPastDue:t,isLoading:a}=k(),u=n||a,l=(null==e?void 0:e.billing_type)==="stripe_subscription_contracted";return{isLoading:u,canManageMembers:!u&&!i&&(l||!t)}}function O(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/end_subscription"),"PUT",{...e,onSuccess(i,t,r){var u;n.setQueryData([d.Gn,a],e=>{if(e)return{...e,plan_ending_before:"".concat(i.plan_ends_at,"T00:00:00+00:00")}}),n.invalidateQueries({queryKey:[d._S,a]}),n.invalidateQueries({queryKey:[d.MJ,a]}),n.invalidateQueries({queryKey:[d.dZ,a]}),n.invalidateQueries({queryKey:[d.Gn,a]}),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})}function D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(n,"/cancellation_survey"),"POST",{...e,enabled:!!i})}function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/resume_subscription"),"PUT",{...e,onSuccess(i,t,r){var u;n.setQueryData([d.Gn,a],e=>{if(e)return{...e,plan_ending_before:null}}),n.invalidateQueries({queryKey:[d._S,a]}),n.invalidateQueries({queryKey:[d.MJ,a]}),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})}function N(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(null==i?void 0:i.uuid,"/renew_subscription/cw"),"PUT",{...e,onSuccess(t,a,r){var u;t.clientSecret||(n.invalidateQueries({queryKey:[d.Gn,null==i?void 0:i.uuid]}),n.invalidateQueries({queryKey:[d._S,null==i?void 0:i.uuid]}),n.invalidateQueries({queryKey:[d.cc,null==i?void 0:i.uuid]}),n.invalidateQueries({queryKey:[d.MJ,null==i?void 0:i.uuid]})),null==(u=e.onSuccess)||u.call(e,t,a,r)},enabled:!!i})}function J(e){let{limit:i,createdSince:n,organizationUuid:a,meta:u}=e,{activeOrganization:l}=(0,r.YL)(),s=Math.round(n.toSeconds()),o=a||(null==l?void 0:l.uuid);return(0,t.Sk)("/api/stripe/".concat(o,"/invoices?limit=").concat(i,"&created_since_ts=").concat(s),{queryKey:[d.cc,o,{limit:i,created_since_ts:s}],staleTime:0,enabled:!!o,meta:u})}function Z(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,r.mV)();return(0,t.Sk)("/api/stripe/".concat(null==i?void 0:i.uuid,"/upcoming_invoice"),{queryKey:[d.MJ,null==i?void 0:i.uuid],staleTime:0,enabled:!!i&&n,meta:{noToast:e=>e instanceof o.LG&&500===e.statusCode},...e})}function j(){let{activeOrganization:e}=(0,r.YL)(),i=(0,y.useQueryClient)(),n=null==e?void 0:e.uuid;return(0,t.L2)("/api/organizations/".concat(n,"/payment_method/update_latest"),"POST",{onSuccess:async e=>{let t=i.getQueryData([d.Gn,n]);t&&e?i.setQueryData([d.Gn,n],{...t,payment_method:{...e}}):await i.invalidateQueries({queryKey:[d.Gn,n]}),i.invalidateQueries({queryKey:[d._S,n]}),i.invalidateQueries({queryKey:[d.cc,n]})},meta:{noToast:!0}})}let R=5,B=150;function I(){let{data:e,isLoading:i}=(0,m.Nk)(),{data:n,isLoading:t}=(0,p.of)(),a=(0,s.b)(c.Nt.MembersManage),u=(0,s.b)(c.Nt.BillingView),{data:l}=(0,g.U6)(),{data:o}=T({enabled:u}),d=(0,r.zm)(),y=es(),v=i||t||!e||!n||!l,f=v?0:e.length,b=v?0:n.filter(e=>"pending"===e.status).length,S=f+b,h=Math.max(f+b,R),Q=v?0:d?l.members_limit-S:Math.max(R-S,0),q=(0,_.useMemo)(()=>v||!l?null:(null==o?void 0:o.seat_tier_quantities)||l.seat_tier_quantities,[v,l,o]),K=(0,_.useMemo)(()=>{if(v||!e||!n)return{};let i={};return e.forEach(e=>{let n=e.seat_tier;i[n]=(i[n]||0)+1}),n.forEach(e=>{if("pending"===e.status){let n=e.seat_tier;i[n]=(i[n]||0)+1}}),i},[v,e,n]),L=(0,_.useMemo)(()=>!v&&e&&n?Object.fromEntries((y||[]).map(e=>{var i;let n=null!=(i=null==q?void 0:q[e])?i:0,t=K[e]||0;return[e,n-t]})):Object.fromEntries((y||[]).map(e=>[e,0])),[v,e,n,y,q,K]);if(v)return{isLoading:v,hasManageMembersPermission:a,totalMembersWithoutMinimumApplied:0,totalMembersWithMinimumApplied:0,activeMembers:0,invitedMembers:0,unclaimedMembers:0,minimumApplied:!1,memberLimit:0,isUnlimited:!1,unclaimedSeatsByTier:L,standardMembers:0,enterpriseLiteMembers:0,premiumMembers:0,usageBasedMembers:0,unassignedMembers:0,totalAssignedMembers:0};let w=(K.team_standard||0)+(K.enterprise_standard||0),Y=K.enterprise_lite||0,P=(K.team_tier_1||0)+(K.enterprise_tier_1||0)+(K.enterprise_tier_2||0),z=K.enterprise_usage_based||0,M=K.unassigned||0;return{isLoading:v,hasManageMembersPermission:a,totalMembersWithoutMinimumApplied:S,totalMembersWithMinimumApplied:h,activeMembers:f,invitedMembers:b,unclaimedMembers:Q,minimumApplied:S<R,memberLimit:l.members_limit,isUnlimited:l.unlimited_members||!1,unclaimedSeatsByTier:L,standardMembers:w,enterpriseLiteMembers:Y,premiumMembers:P,usageBasedMembers:z,unassignedMembers:M,totalAssignedMembers:w+Y+P+z}}function V(){var e;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:n}=(0,r.YL)(),a="/api/organizations/".concat(null!=(e=null==n?void 0:n.uuid)?e:"","/profile"),u=(0,y.useQueryClient)();return(0,t.L2)(a,"PUT",{...i,async onSuccess(){for(var e,n=arguments.length,t=Array(n),a=0;a<n;a++)t[a]=arguments[a];await u.invalidateQueries({queryKey:[d.Oi]}),await (null==(e=i.onSuccess)?void 0:e.call(i,...t))}})}let W=()=>{let{activeOrganization:e}=(0,r.YL)(),i=(0,s.b)(c.Nt.BillingView);return(0,t.Sk)("/api/organizations/".concat(null==e?void 0:e.uuid,"/subscription/scheduled_seat_tier_changes"),{enabled:!!e&&i,queryKey:[d.pT,null==e?void 0:e.uuid]})},X=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(null==i?void 0:i.uuid,"/subscription/cancel_scheduled_seat_tier_changes"),"PUT",{...e,onSuccess:function(){for(var t,a=arguments.length,r=Array(a),u=0;u<a;u++)r[u]=arguments[u];n.invalidateQueries({queryKey:[d.pT,null==i?void 0:i.uuid]}),n.invalidateQueries({queryKey:[d.Gn,null==i?void 0:i.uuid]}),null==(t=e.onSuccess)||t.call(e,...r)}})};function F(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/pro/upgrade_to_yearly"),"PUT",{...e,onSuccess(i,t,r){var u;n.invalidateQueries({queryKey:[d.Gn,a]}),n.invalidateQueries({queryKey:[d.dZ,a]}),n.invalidateQueries({queryKey:[d._S,a]}),n.invalidateQueries({queryKey:[d.MJ,a]}),n.invalidateQueries({queryKey:[d.cc,a]}),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})}function H(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/team/upgrade_to_annual"),"PUT",{...e,onSuccess(i,t,r){var u;n.invalidateQueries({queryKey:[d.Gn,a]}),n.invalidateQueries({queryKey:[d.dZ,a]}),n.invalidateQueries({queryKey:[d._S,a]}),n.invalidateQueries({queryKey:[d.MJ,a]}),n.invalidateQueries({queryKey:[d.cc,a]}),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})}function $(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/pro/switch_billing_interval"),"PUT",{...e,onSuccess(i,t,r){var u;n.invalidateQueries({queryKey:[d.Gn,a]}),n.invalidateQueries({queryKey:[d.dZ,a]}),n.invalidateQueries({queryKey:[d._S,a]}),n.invalidateQueries({queryKey:[d.MJ,a]}),n.invalidateQueries({queryKey:[d.Oi,a]}),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})}function ee(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/upgrade_to_max"),"PUT",{...e,transformVariables:e=>({max_tier:e.maxTier,promo_code:e.promoCode}),onSuccess(i,t,r){var u;n.invalidateQueries({queryKey:[d.Gn,a]}),n.invalidateQueries({queryKey:[d.dZ,a]}),n.invalidateQueries({queryKey:[d._S,a]}),n.invalidateQueries({queryKey:[d.MJ,a]}),n.invalidateQueries({queryKey:[d.cc,a]}),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})}function ei(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/downgrade_individual_claude_subscription"),"PUT",{...e,onSuccess(i,t,r){var u;if(i.downgrade_timestamp){let e=new Date(1e3*i.downgrade_timestamp).toISOString();n.setQueryData([d.Gn,a],i=>{if(i)return{...i,scheduled_downgrade:{base_price_in_minor_units:0,billing_interval:t.target_plan_type.includes("annual")?"yearly":"monthly",currency:"USD",date:e,plan_type:t.target_plan_type},has_schedule:!0}})}n.invalidateQueries({queryKey:[d.Gn,a]}),n.invalidateQueries({queryKey:[d._S,a]}),n.invalidateQueries({queryKey:[d.dZ,a]}),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})}function en(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/cancel_subscription_downgrade"),"PUT",{...e,onSuccess(i,t,r){var u;n.setQueryData([d.Gn,a],e=>{if(e)return{...e,scheduled_downgrade:void 0,has_schedule:!1}}),n.invalidateQueries({queryKey:[d.Gn,a]}),n.invalidateQueries({queryKey:[d._S,a]}),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})}function et(e){let{activeOrganization:i}=(0,r.YL)();return(0,t.Sk)("/api/stripe/".concat(null==i?void 0:i.uuid,"/balance"),{queryKey:["stripe-balance",null==i?void 0:i.uuid],staleTime:18e5,enabled:!!i,...e})}function ea(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],{activeOrganization:i}=(0,r.YL)(),n=null==i?void 0:i.uuid;return(0,t.Sk)("/api/organizations/".concat(n,"/check_3ds_required"),{enabled:e&&!!i,queryKey:["check-3ds-required",n],meta:{noToast:!0},staleTime:864e5,refetchOnWindowFocus:!1,refetchOnMount:!1})}function er(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/verify_payment_method_3ds"),"POST",{...e,onSuccess(i,t,r){var u;n.invalidateQueries({queryKey:["check-3ds-required",a]}),n.invalidateQueries({queryKey:[d.Gn,a]}),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})}function eu(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{activeOrganization:i}=(0,r.YL)(),n=null==i?void 0:i.uuid;return(0,t.Sk)("/api/organizations/".concat(n,"/retention_coupon_eligibility"),{enabled:e&&!!i,queryKey:["retention-coupon-eligibility",n],meta:{noToast:!0},staleTime:3e5,refetchOnWindowFocus:!1,refetchOnMount:!0})}function el(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/redeem_retention_coupon"),"POST",{...e,onSuccess(i,t,r){var u;i.success&&(n.invalidateQueries({queryKey:[d.Gn,a]}),n.invalidateQueries({queryKey:[d.MJ,a]})),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})}let es=()=>{let e=(0,s.b)(c.Nt.BillingManage),i=(0,s.b)(c.Nt.BillingView),{data:n}=(0,g.U6)(),{data:t}=T({enabled:e&&i}),a=(null==n?void 0:n.seat_tier_quantities)||(null==t?void 0:t.seat_tier_quantities);if(!a)return[];let r=Object.keys(a);return(r.includes("unassigned")?r:[...r,"unassigned"]).filter(e=>"enterprise_tier_2"!==e)},eo=()=>{let e=es();return c.uK.filter(e=>"enterprise_tier_2"!==e).some(i=>e.includes(i))};function ed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/pause_subscription"),"PUT",{...e,onSuccess(i,t,r){var u;n.invalidateQueries({queryKey:[d.Gn,a]}),n.invalidateQueries({queryKey:[d._S,a]}),n.invalidateQueries({queryKey:[d.MJ,a]}),n.invalidateQueries({queryKey:[d.dZ,a]}),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})}function ec(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/unpause_subscription"),"PUT",{...e,onSuccess(i,t,r){var u;n.invalidateQueries({queryKey:[d.Gn,a]}),n.invalidateQueries({queryKey:[d._S,a]}),n.invalidateQueries({queryKey:[d.MJ,a]}),n.invalidateQueries({queryKey:[d.dZ,a]}),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})}function ey(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(n,"/subscription/preview_seat_purchase"),"POST",{...e,enabled:!!i})}let e_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{addError:i}=(0,u.Y)(),{activeOrganization:n}=(0,r.YL)(),s=(0,a._r)(),o=(0,y.useQueryClient)(),c=null==n?void 0:n.uuid;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/subscription/purchase_seats"),"POST",{...e,onSuccess(i,t,r){var u;n.invalidateQueries({queryKey:[d.Gn,a]}),n.invalidateQueries({queryKey:[d.MJ,a]}),n.invalidateQueries({queryKey:[d._S,a]}),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})}({...e,async onSuccess(n,t,a){var r,u,y,_;if(n.client_secret){let r=await (0,l.nW)(n.entity,s);if(!r){i("Stripe failed to initialize. You can try again."),null==(y=e.onError)||y.call(e,Error("Stripe failed to initialize. You can try again."),t,a);return}let v=await r.confirmPayment({clientSecret:n.client_secret,redirect:"if_required"});if(v.error){i("Payment confirmation failed. You can try again.",{error:v.error}),null==(_=e.onError)||_.call(e,Error("Payment confirmation failed. You can try again."),t,a);return}o.invalidateQueries({queryKey:[d.Gn,c]}),o.invalidateQueries({queryKey:[d.MJ,c]}),o.invalidateQueries({queryKey:[d._S,c]}),await (null==(u=e.onSuccess)?void 0:u.call(e,n,t,a));return}o.invalidateQueries({queryKey:[d.Gn,c]}),o.invalidateQueries({queryKey:[d.MJ,c]}),o.invalidateQueries({queryKey:[d._S,c]}),await (null==(r=e.onSuccess)?void 0:r.call(e,n,t,a))}})},ev=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/address"),"PUT",{...e,onSuccess:(i,t,r)=>{var u;n.invalidateQueries({queryKey:["organization-addresses",a]}),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})},ep=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,r.YL)(),n=(0,y.useQueryClient)(),a=null==i?void 0:i.uuid;return(0,t.L2)("/api/organizations/".concat(a,"/address"),"PUT",{...e,onSuccess:(i,t,r)=>{var u;n.invalidateQueries({queryKey:["organization-addresses",a]}),null==(u=e.onSuccess)||u.call(e,i,t,r)},enabled:!!i})};function em(){let{activeOrganization:e}=(0,r.YL)();return(0,t.Sk)("/api/organizations/".concat(null==e?void 0:e.uuid,"/address"),{queryKey:["organization-addresses",null==e?void 0:e.uuid],enabled:!!(null==e?void 0:e.uuid)})}},70803:(e,i,n)=>{n.d(i,{Nk:()=>y,bf:()=>p,fp:()=>m,y0:()=>_});var t=n(1613),a=n(64328),r=n(35984),u=n(16178),l=n(80688),s=n(4869),o=n(7620),d=n(77528);let c=function(){var e;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",{activeOrganization:n}=(0,a.YL)(),r=new URLSearchParams;"owners_admins"===i&&(r.append("roles[]","owner"),r.append("roles[]","primary_owner"),r.append("roles[]","membership_admin"));let u=r.toString(),s="/api/organizations/".concat(null!=(e=null==n?void 0:n.uuid)?e:"","/members").concat(u?"?".concat(u):"");return(0,t.Sk)(s,{enabled:!!(null==n?void 0:n.uuid)&&(n.capabilities.includes("api")||n.capabilities.includes("raven")),queryKey:[l.si,{orgUuid:null==n?void 0:n.uuid,roleFilter:i}],staleTime:0})},y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",i=c(e),n=(0,d.dd)(),t=(0,a.zm)(),r=(0,o.useMemo)(()=>{if(!n||!i.data)return i.data;let e=t?"enterprise_standard":"team_standard";return i.data.map(i=>({...i,seat_tier:i.seat_tier||e}))},[n,i.data,t]);return{...i,data:r}},_=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:n}=(0,a.YL)(),r=(0,s.useQueryClient)();return(0,t.L2)(i=>{var t;return"/api/organizations/".concat(null!=(t=null==n?void 0:n.uuid)?t:"","/members/").concat(e||i.memberUuid)},"PUT",{...i,meta:{errorMessage:"There was an error updating the user.",...i.meta},async onSuccess(){for(var e,t=arguments.length,a=Array(t),u=0;u<t;u++)a[u]=arguments[u];await Promise.all([r.invalidateQueries({queryKey:[l.si,{orgUuid:null==n?void 0:n.uuid}]}),r.invalidateQueries({queryKey:[l.ZD,{orgUuid:null==n?void 0:n.uuid}]}),r.invalidateQueries({queryKey:[l.rx]}),r.invalidateQueries({queryKey:[l.cz]})]),await (null==(e=i.onSuccess)?void 0:e.call(i,...a))}})},v=function(){var e;let{offset:i=0,limit:n=30,search:r="",roleFilter:u="all",enabled:s=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:o}=(0,a.YL)(),d=new URLSearchParams({offset:i.toString(),limit:n.toString()});return r&&d.append("search",r),"owners_admins"===u&&(d.append("roles[]","owner"),d.append("roles[]","primary_owner"),d.append("roles[]","membership_admin")),(0,t.Sk)("/api/organizations/".concat(null!=(e=null==o?void 0:o.uuid)?e:"","/members_v2?").concat(d),{enabled:s&&!!(null==o?void 0:o.uuid)&&(o.capabilities.includes("api")||o.capabilities.includes("raven")),queryKey:[l.rx,{orgUuid:null==o?void 0:o.uuid,offset:i,limit:n,search:r,roleFilter:u}],staleTime:0})},p=function(){let{offset:e=0,limit:i=30,search:n="",roleFilter:t="all",enabled:r=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=v({offset:e,limit:i,search:n,roleFilter:t,enabled:r}),l=(0,d.dd)(),s=(0,a.zm)(),c=(0,o.useMemo)(()=>{if(!l||!u.data)return u.data;let e=s?"enterprise_standard":"team_standard";return{...u.data,data:u.data.data.map(i=>"member"===i.type?{...i,member:{...i.member,seat_tier:i.member.seat_tier||e}}:"invite"===i.type?{...i,invite:{...i.invite,seat_tier:i.invite.seat_tier||e}}:i)}},[l,u.data,s]);return{...u,data:c}},m=function(e,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=(0,s.useQueryClient)(),{addError:o}=(0,r.Y)(),d="uuid"in i?i.uuid:i.account.uuid,c="email_address"in i?i.email_address:i.account.email_address;return(0,t.L2)("/api/organizations/".concat(e,"/members/").concat(d),"DELETE",{...n,meta:{noToast:!0},async onSuccess(){for(var i,t=arguments.length,r=Array(t),u=0;u<t;u++)r[u]=arguments[u];await a.invalidateQueries({queryKey:[l.si,{orgUuid:e}]}),await a.invalidateQueries({queryKey:[l.rx]}),a.invalidateQueries({queryKey:[l.MJ,e]}),a.invalidateQueries({queryKey:[l._S,e]}),await (null==(i=n.onSuccess)?void 0:i.call(n,...r))},onError(e){var i,n;e instanceof u.LG&&(null==(n=e.extra)||null==(i=n.details)?void 0:i.type)==="seat_minimum_reached"?o("You cannot go below 5 members."):o("There was an error removing ".concat(c," from the organization."),{error:e})}})}},77223:(e,i,n)=>{n.d(i,{nW:()=>v,bN:()=>p,Ri:()=>c,ib:()=>_});var t=n(80688),a=n(7620),r=n(1613),u=n(44995),l=n(64328),s=n(40459);let o=async e=>{if(s.env.NEXT_PUBLIC_DISABLE_PAYMENTS)return Promise.resolve(null);let{loadStripe:i}=await n.e(3508).then(n.bind(n,13508));return i(e)},d=["ar","bg","cs","da","de","el","en","en-AU","en-CA","en-NZ","en-GB","es","es-ES","es-419","et","fi","fil","fr","fr-CA","fr-FR","he","hu","hr","id","it","it-IT","ja","ko","lt","lv","ms","mt","nb","nl","no","pl","pt","pt-BR","ro","ru","sk","sl","sv","th","tr","vi","zh","zh-HK","zh-TW"],c=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],{activeOrganization:i}=(0,l.YL)(),{data:n,mutate:u,isIdle:s}=(0,r.L2)("/api/stripe/".concat(null==i?void 0:i.uuid,"/intent"),"POST",{enabled:!!(null==i?void 0:i.uuid),retry:2,retryDelay:2e3,mutationKey:[t.$k,null==i?void 0:i.uuid]});return(0,a.useEffect)(()=>{s&&e&&u()},[u,s,e]),n},y={};function _(e){return v(e,(0,u._r)())}function v(e,i){let n="ie"===e?i.stripePublishableKeyIreland:"us_sandbox"===e&&i.stripePublishableKeySandbox?i.stripePublishableKeySandbox:i.stripePublishableKey;return y[n]||(y[n]=o(n)),y[n]}let p=e=>{if(d.includes(e))return e;let i=e.split("-")[0];return d.includes(i)?i:"en"}},77528:(e,i,n)=>{n.d(i,{G6:()=>o,dD:()=>s,dd:()=>u,mk:()=>y,uv:()=>d,vm:()=>l});var t=n(64328),a=n(68067),r=n(7620);let u=()=>{let e=(0,a.fS)("c4w_contracted_shebang"),i=(0,a.fS)("c4w_self_serve_shebang"),n=(0,a.fS)("aws_marketplace_seat_limit_enforcement"),{activeOrganization:u}=(0,t.YL)(),l=null==u?void 0:u.billing_type;return(0,r.useMemo)(()=>(!!e||!!i)&&("stripe_subscription_contracted"===l?e:"aws_marketplace"===l?n:(!l||"none"===l||"stripe_subscription"===l)&&i),[e,i,l,n])},l=(e,i)=>{if(i){if("enterprise_standard"===e||"c4e_standard_seat"===e||"standard"===e)return"c4e_standard_seat";if("enterprise_tier_1"===e||"c4e_tier_1_seat"===e||"tier_1"===e)return"c4e_tier_1_seat";if("enterprise_tier_2"===e||"c4e_tier_2_seat"===e||"tier_2"===e)return"c4e_tier_2_seat";if("enterprise_usage_based"===e||"c4e_usage_based_seat"===e||"usage_based"===e)return"c4e_usage_based_seat"}else{if("team_standard"===e||"team_plan_standard_seat"===e||"standard"===e)return"team_plan_standard_seat";if("team_tier_1"===e||"team_plan_tier_1_seat"===e||"tier_1"===e)return"team_plan_tier_1_seat"}return null},s=function(e,i){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!(null==e?void 0:e.seat_tier_quantities))return[];let t=[],a=new Set;Object.entries(e.seat_tier_quantities).forEach(e=>{let[n,r]=e,u=l(n,i);"c4e_tier_2_seat"!==u&&"unassigned"!==n&&u&&"number"==typeof r&&(t.push({itemType:u,currentSeats:r,adjustedSeats:r}),a.add(u))});let r=i?"c4e_standard_seat":"team_plan_standard_seat",u=i?"c4e_tier_1_seat":"team_plan_tier_1_seat";if(a.has(r)||t.push({itemType:r,currentSeats:0,adjustedSeats:0}),a.has(u)||t.push({itemType:u,currentSeats:0,adjustedSeats:0}),i&&n){let e="c4e_usage_based_seat";a.has(e)||t.push({itemType:e,currentSeats:0,adjustedSeats:0})}return t},o=(e,i,n,t)=>{let a=[...e];if("unassigned"!==i&&"unassigned"!==n&&(!t||c(i,n))){let e=l(i,t);if(e){let i=a.find(i=>i.itemType===e);i&&i.adjustedSeats>0&&(i.adjustedSeats-=1)}}if("unassigned"!==n){let e=l(n,t);if(e){let i=a.find(i=>i.itemType===e);i?i.adjustedSeats+=1:a.push({itemType:e,currentSeats:0,adjustedSeats:1})}}return a},d=e=>{if(!(null==e?void 0:e.seat_tier_quantities))return 0;let i=Object.entries(e.seat_tier_quantities).filter(e=>{let[i]=e;return"enterprise_tier_2"===i||"c4e_tier_2_seat"===i||"tier_2"===i});if(i.length>0){let e=i[0][1];return"number"==typeof e?e:0}return 0},c=(e,i)=>"unassigned"===e&&"unassigned"!==i||("team_standard"===e||"enterprise_standard"===e)&&("team_tier_1"===i||"enterprise_tier_1"===i),y=(e,i)=>{if("unassigned"===i&&"unassigned"!==e)return!0;if("unassigned"===e)return!1;let n=e.includes("tier_1")||e.includes("premium")||"enterprise_usage_based"===e,t=i.includes("standard")&&!i.includes("tier_1")&&!i.includes("premium")&&"enterprise_usage_based"!==i;return!!n&&!!t}},91870:(e,i,n)=>{n.d(i,{BF:()=>p,UV:()=>y,oF:()=>v,of:()=>c,tH:()=>_});var t=n(1613),a=n(64328),r=n(35984),u=n(16178),l=n(80688),s=n(4869),o=n(7620),d=n(77528);let c=e=>{let i=(e=>{var i;let{activeOrganization:n}=(0,a.YL)(),r=new URLSearchParams;e&&e.length>0&&e.forEach(e=>r.append("roles[]",e));let u=r.toString(),s="/api/organizations/".concat(null!=(i=null==n?void 0:n.uuid)?i:"","/invites").concat(u?"?".concat(u):"");return(0,t.Sk)(s,{enabled:!!(null==n?void 0:n.uuid)&&(n.capabilities.includes("api")||n.capabilities.includes("raven")),queryKey:[l.ZD,{orgUuid:null==n?void 0:n.uuid,roles:e}],staleTime:0})})(e),n=(0,d.dd)(),{activeOrganization:r}=(0,a.YL)(),u=(0,o.useMemo)(()=>{if(!n||!i.data)return i.data;let e=(null==r?void 0:r.capabilities.includes("commercial_use"))?"enterprise_standard":"team_standard";return i.data.map(i=>({...i,seat_tier:i.seat_tier||e}))},[n,i.data,null==r?void 0:r.capabilities]);return{...i,data:u}},y=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,s.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(e,"/invites"),"POST",{...i,async onSuccess(){for(var t,a=arguments.length,r=Array(a),u=0;u<a;u++)r[u]=arguments[u];await n.invalidateQueries({queryKey:[l.ZD,{orgUuid:e}]}),await n.invalidateQueries({queryKey:[l.rx]}),n.invalidateQueries({queryKey:[l.MJ,e]}),n.invalidateQueries({queryKey:[l._S,e]}),await (null==(t=i.onSuccess)?void 0:t.call(i,...r))}})},_=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,s.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(e,"/invites/bulk"),"POST",{...i,async onSuccess(){for(var t,a=arguments.length,r=Array(a),u=0;u<a;u++)r[u]=arguments[u];await n.invalidateQueries({queryKey:[l.ZD,{orgUuid:e}]}),await n.invalidateQueries({queryKey:[l.rx]}),n.invalidateQueries({queryKey:[l.MJ,e]}),n.invalidateQueries({queryKey:[l._S,e]}),await (null==(t=i.onSuccess)?void 0:t.call(i,...r))}})},v=function(e,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=(0,s.useQueryClient)(),{addError:o}=(0,r.Y)();return(0,t.L2)("/api/organizations/".concat(e,"/invites/").concat(i),"DELETE",{...n,meta:{noToast:!0},async onSuccess(){for(var i,t=arguments.length,r=Array(t),u=0;u<t;u++)r[u]=arguments[u];await a.invalidateQueries({queryKey:[l.ZD,{orgUuid:e}]}),await a.invalidateQueries({queryKey:[l.rx]}),a.invalidateQueries({queryKey:[l.MJ,e]}),a.invalidateQueries({queryKey:[l._S,e]}),await (null==(i=n.onSuccess)?void 0:i.call(n,...r))},onError(e){var i,n;e instanceof u.LG&&(null==(n=e.extra)||null==(i=n.details)?void 0:i.type)==="seat_minimum_reached"?o("You cannot go below 5 members."):o("There was an error revoking the invite.",{error:e})}})},p=function(e,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=(0,s.useQueryClient)();return(0,t.L2)("/api/organizations/".concat(e,"/invites/").concat(i),"PUT",{...n,async onSuccess(){for(var i,t=arguments.length,r=Array(t),u=0;u<t;u++)r[u]=arguments[u];await a.invalidateQueries({queryKey:[l.ZD,{orgUuid:e}]}),await a.invalidateQueries({queryKey:[l.rx]}),await (null==(i=n.onSuccess)?void 0:i.call(n,...r))}})}}}]);